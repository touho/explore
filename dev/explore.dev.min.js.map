{"version":3,"file":null,"sources":["../src/assert.js","../src/core/serializableManager.js","../src/core/serializable.js","../src/core/propertyType.js","../node_modules/redom/dist/redom.es.js","../src/core/entity.js","../src/core/propertyModel.js","../src/core/test.js","../src/core/property.js","../src/core/component.js","../src/core/componentExample.js","../src/components/Position.js","../src/components/Test.js","../src/editor/events.js","../src/editor/layout/moduleContainer.js","../src/editor/layout/layout.js","../src/editor/module/module.js","../src/editor/module/topBar.js","../src/editor/module/property.js","../src/editor/module/scene.js","../src/editor/module/test.js","../src/editor/module/test2.js","../src/editor/module/test3.js","../src/editor/editor.js","../src/mainDev.js"],"sourcesContent":["export default function assert(condition, message) {\n\tif (!condition)\n\t\tthrow new Error(message);\n}\n","let serializables = new Map();\n\nexport function addSerializable(serializable) {\n\tif (serializables.has(serializable.id)) throw new Error('Serializable id clash!');\n\tserializables.set(serializable.id, serializable);\n}\n\nexport function getSerializable(id) {\n\treturn serializables.get(id);\n}\n\nexport function hasSerializable(id) {\n\treturn serializables.has(id);\n}\n\nexport function removeSerializable(id) {\n\tif (!serializables.delete(id))\n\t\tthrow new Error('Serializable not found!');\n}\n","import assert from '../assert';\nimport * as serializableManager from './serializableManager';\n\nconst BASE_64_CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\nconst CHAR_COUNT = BASE_64_CHARACTERS.length;\nfunction char() {\n\treturn BASE_64_CHARACTERS[Math.random() * CHAR_COUNT | 0];\n}\nfunction createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i !== 0; --i)\n\t\tid += char();\n\treturn id;\n}\n\nexport default class Serializable {\n\tconstructor(threeLetterType, predefinedId = false) {\n\t\tif (predefinedId)\n\t\t\tthis.id = predefinedId;\n\t\telse\n\t\t\tthis.id = createStringId(threeLetterType);\n\n\t\tserializableManager.addSerializable(this);\n\t}\n\tdelete() {\n\t\tserializableManager.removeSerializable(this.id);\n\t}\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this.id\n\t\t};\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string');\n\t\treturn new Serializable(null, json.id);\n\t}\n}\n","import assert from '../assert';\nimport PropertyModel from './propertyModel';\n\nexport default function PropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\toptionalParameters.forEach(p => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p);\n\t});\n\treturn new PropertyModel(propertyName, type, validator, defaultValue);\n};\n\nexport function addType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist\n\ttoJSON = x => x,\n\tfromJSON = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON\n\t};\n\tlet createType = () => type;\n\t\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\tPropertyType[name] = createType;\n}\n\nexport function createValidator(name, validatorFunction) {\n\tlet validator = function() {\n\t\tlet parameters = [...arguments];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidatorParameters: parameters,\n\t\t\tvalidate: x => validatorFunction(x, ...parameters)\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n\naddType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\naddType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => String(x)\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nfunction createElement (query, ns) {\n  var tag;\n  var id;\n  var className;\n\n  var mode = 0;\n  var start = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n\n    if (char === HASH || char === DOT || !char) {\n      if (mode === 0) {\n        if (i === 0) {\n          tag = 'div';\n        } else if (!char) {\n          tag = query;\n        } else {\n          tag = query.substring(start, i);\n        }\n      } else {\n        var slice = query.substring(start, i);\n\n        if (mode === 1) {\n          id = slice;\n        } else if (className) {\n          className += ' ' + slice;\n        } else {\n          className = slice;\n        }\n      }\n\n      start = i + 1;\n\n      if (char === HASH) {\n        mode = 1;\n      } else {\n        mode = 2;\n      }\n    }\n  }\n\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    element.className = className;\n  }\n\n  return element;\n}\n\nfunction text (content) {\n  return document.createTextNode(content);\n}\n\nfunction mount (parent, child, before) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (childEl.__redom_list) {\n    childEl = childEl.el;\n  }\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n  if (child.isMounted) {\n    child.remount && child.remount();\n  } else {\n    child.mount && child.mount();\n  }\n  if (before) {\n    parentEl.insertBefore(childEl, before.el || before);\n  } else {\n    parentEl.appendChild(childEl);\n  }\n  if (child.isMounted) {\n    child.remounted && child.remounted();\n  } else {\n    child.isMounted = true;\n    child.mounted && child.mounted();\n  }\n}\n\nfunction unmount (parent, child) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  child.unmount && child.unmount();\n\n  parentEl.removeChild(childEl);\n\n  child.isMounted = false;\n  child.unmounted && child.unmounted();\n}\n\nvar elcache = {};\n\nfunction el (query) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (elcache[query] || (elcache[query] = createElement(query))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (arg.length) {\n      empty = false;\n      for (var j = 0; j < arg.length; j++) {\n        mount(element, arg[j]);\n      }\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style') {\n          if (typeof value === 'string') {\n            element.setAttribute(key, value);\n          } else {\n            for (var cssKey in value) {\n              element.style[cssKey] = value[cssKey];\n            }\n          }\n        } else if (key in element || typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nel.extend = function (query) {\n  var clone = (elcache[query] || (elcache[query] = createElement(query)));\n\n  return el.bind(this, clone);\n};\n\nfunction setChildren (parent, children) {\n  var parentEl = parent.el || parent;\n  var traverse = parentEl.firstChild;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = child.el || child;\n\n    if (childEl === traverse) {\n      traverse = traverse.nextSibling;\n      continue;\n    }\n\n    mount(parent, child, traverse);\n  }\n\n  while (traverse) {\n    var next = traverse.nextSibling;\n\n    unmount(parent, traverse);\n\n    traverse = next;\n  }\n}\n\nfunction list (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\nfunction List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.key = key;\n  this.initData = initData;\n  this.views = [];\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n\n  if (key) {\n    this.lookup = {};\n  }\n}\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\nList.prototype.update = function (data) {\n  if ( data === void 0 ) data = [];\n\n  var View = this.View;\n  var key = this.key;\n  var functionKey = typeof key === 'function';\n  var initData = this.initData;\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n  var newLookup = key && {};\n  var oldLookup = key && this.lookup;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (key) {\n      var id = functionKey ? key(item) : item[key];\n      view = newViews[i] = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__id = id;\n    } else {\n      view = newViews[i] = oldViews[i] || new View(initData, item, i, data);\n    }\n    var el$$1 = view.el;\n    if (el$$1.__redom_list) {\n      el$$1 = el$$1.el;\n    }\n    el$$1.__redom_view = view;\n    view.update && view.update(item, i, data);\n  }\n\n  setChildren(this, newViews);\n\n  if (key) {\n    this.lookup = newLookup;\n  }\n  this.views = newViews;\n};\n\nfunction router (parent, Views) {\n  return new Router(parent, Views);\n}\n\nvar Router = function Router (parent, Views) {\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n  this.Views = Views;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.view = View && new View();\n    this.route = route;\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data);\n};\n\nvar SVG = 'http://www.w3.org/2000/svg';\n\nvar svgcache = {};\n\nfunction svg (query, a) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (svgcache[query] || (svgcache[query] = createElement(query, SVG))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    } else if (typeof arg === 'function') {\n      arg = arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style' && typeof value !== 'string') {\n          for (var cssKey in value) {\n            element.style[cssKey] = value[cssKey];\n          }\n        } else if (typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nsvg.extend = function (query) {\n  var clone = (svgcache[query] || (svgcache[query] = createElement(query, SVG)));\n\n  return svg.bind(this, clone);\n};\n\nexport { el, list, List, mount, unmount, router, Router, setChildren, svg, text };\n","import Serializable from './serializable';\nimport assert from '../assert';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor() {\n\t\tsuper('ent');\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.alive = true;\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null;\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tUses addComponent internally.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet componentList = this.components.get(components[i].name) || this.components.set(components[i].name, []).get(components[i].name);\n\t\t\tcomponentList.push(components[i]);\n\t\t}\n\t\t\n\t\tif (!this.sleeping)\n\t\t\tEntity.initComponents(components);\n\t\treturn this;\n\t}\n\tstatic initComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\tsleep() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\t\t\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.makeComponentsSleep(componentArray);\n\t\t\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\twakeUp() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.initComponents(componentArray);\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\tdelete() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tsuper.delete();\n\t\tthis.alive = false;\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.deleteComponents(componentArray);\n\t\tthis.components.clear();\n\t}\n\ttoJSON() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcomponents: []\n\t\t});\n\t}\n}\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// info about type, validator, validatorParameters, initialValue\n\nexport default class PropertyModel extends Serializable {\n\tconstructor(name, type, validator, initialValue) {\n\t\tassert(typeof name === 'string');\n\t\tassert(typeof type.name === 'string');\n\t\tassert(typeof validator.validate === 'function');\n\t\t\n\t\tsuper('pmo');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tname: this.name,\n\t\t\ttype: this.type.name,\n\t\t\tvalidatorName: this.validator.validatorName,\n\t\t\tvalidatorParameters: this.validator.validatorParameters,\n\t\t\tinitialValue: this.type.toJSON(this.initialValue)\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.type = null;\n\t\tthis.validator = null;\n\t}\n}\n","import assert from '../assert';\n\nimport Serializable from './serializable';\n(() => {\n\tlet s = new Serializable('tes');\n\tlet id = s.id;\n\tassert(typeof id === 'string' && id.length > 10);\n\tlet json = s.toJSON();\n\tassert(json && typeof json === 'object' && typeof json.id === 'string');\n\ts.delete();\n\ts = Serializable.fromJSON(json);\n\tassert(typeof s.id === 'string' && s.id.length > 10 && s.id === id);\n\tconsole.log('Serializable tests OK');\n})();\n\nimport Entity from './entity';\n(() => {\n\tlet i = new Entity();\n\tassert(i.components.size === 0);\n\tassert(i.getComponent('moi') === null);\n\tassert(i.getComponents('moi').length === 0);\n\tconsole.log('Entity tests OK');\n})();\n\nimport PropertyType from './propertyType';\n(() => {\n\tassert(PropertyType.float.default().validate('4') === 4);\n\tassert(PropertyType.float.range(0, 1).validate(3) === 1);\n\tconsole.log('PropertyType tests OK');\n})();\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// Entity of a property\nexport default class Property extends Serializable {\n\tconstructor(propertyModel) {\n\t\tsuper('pro');\n\t\tthis.model = propertyModel;\n\t\tthis.value = propertyModel.initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tvalue: this.type.toJSON(this.value),\n\t\t\tmodelId: this.model.id\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.model = null;\n\t}\n}\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.model.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.model.validator.validate(newValue);\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\nObject.defineProperty(Property.prototype, 'initialValue', {\n\tget() {\n\t\treturn this.model.initialValue;\n\t}\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport Property from './property';\nexport { default as Prop } from './propertyType';\n\nexport let componentClasses = new Map();\n\n// Instance of a component, see componentExample.js\nexport class Component extends Serializable {\n\tconstructor(componentModel, entity, env) {\n\t\tsuper('com');\n\t\tthis.entity = entity;\n\t\tthis.env = env;\n\t\tthis.children = {}; // TODO: create children\n\t\tthis._properties = {};\n\t\tthis._componentModel = componentModel;\n\t\tthis.constructor.propertyModels.forEach(p => {\n\t\t\tthis._properties[p.name] = new Property(p);\n\t\t});\n\t}\n\tdelete() {\n\t\tassert(!this.env.entity.alive, 'Do not call Component.delete!');\n\t\tsuper.delete();\n\t}\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], 'required component not found');\n\t\t});\n\n\t\tthis._forEachChildComponent(c => c._preInit());\n\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'preInit', e);\n\t\t}\n\t}\n\t_init() {\n\t\tthis._forEachChildComponent(c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'sleep', e);\n\t\t}\n\t\tthis._forEachChildComponent(c => c._sleep());\n\t}\n\t_forEachChildComponent(func) {\n\t\tObject.keys(this.children).forEach(key => {\n\t\t\tlet child = this.children[key];\n\t\t\tif (Array.isArray(child)) {\n\t\t\t\tchild.forEach(func);\n\t\t\t} else {\n\t\t\t\tfunc(child);\n\t\t\t}\n\t\t});\n\t}\n}\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentModel']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentModel']);\nComponent.register = function({\n\tname = '',\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-bars',\n\tproperties = [],\n\trequirements = [],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {}\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Class extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction();\n\t\t}\n\t\tdelete() {\n\t\t\tsuper.delete(...arguments);\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction();\n\t\t}\n\t}\n\tObject.defineProperty(Class, 'name', { get: () => name });\n\tClass.propertyModels = properties;\n\tClass.category = category;\n\tClass.requirements = requirements;\n\tClass.children = children;\n\tObject.assign(Class.prototype, prototype);\n\n\tClass.propertyModels.forEach(p => {\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t\tassert(Class.prototype[p.name] === undefined, 'Name ' + p.name + ' clashes ');\n\t\tObject.defineProperty(Class.prototype, p.name, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[p.name].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[p.name].value = value;\n\t\t\t}\n\t\t});\n\t});\n\tcomponentClasses.set(Class.name, Class);\n\treturn Class;\n};\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Example',\n\tdescription: 'Description of what this component does',\n\tcategory: 'Core', // You can also make up new categories.\n\ticon: 'fa-circle', // Font Awesome id\n\trequirements: ['Position'], // These shared components are autofilled. Error if component is not found.\n\tchildren: ['Image', 'Image', 'Sound'], // These private components are also autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('variable', 0.5, Prop.float, Prop.float.range(0, 1), 'Description of the property'),\n\t\tProp('otherVariaerfperfjoierjfoeifjble', 'Hello', Prop.string, 'Description of the property')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tstaticVariable: 'Example class info',\n\t\tconstructor() {\n\t\t\t// This will be called once, when creating the component\n\t\t\tthis.hiddenVariable = 3;\n\t\t},\n\t\tpreInit() {\n\t\t\t// preInit is called for every component before any component is inited with init(). Children are already preInited here.\n\t\t\tthis.data = {\n\t\t\t\tlotsOfData: 123 + this.variable + this.hiddenVariable\n\t\t\t};\n\t\t},\n\t\tinit() {\n\t\t\t// All the components of this entity has been preInited. You can use them. Children are already inited here.\n\t\t\tthis.Position.x = this.Position.y + 1;\n\n\t\t\tthis.howToAccessChildren = [\n\t\t\t\tthis.children.Image[0].property,\n\t\t\t\tthis.children.Sound.property\n\t\t\t];\n\n\t\t\tthis.SomeComponent = this.entity.getComponent('SomeComponent');\n\t\t},\n\t\tsleep() {\n\t\t\t// Release all the data created in preInit and init\n\t\t\tthis.data = null;\n\t\t\tthis.SomeComponent = null;\n\t\t\tthis.howToAccessChildren = null;\n\t\t\t// Position component is automatically released because it is a requirement.\n\t\t},\n\t\tdelete() {\n\t\t\t// This will be called once, when component stops existing\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\n\nComponent.register({\n\tname: 'Position',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('x', 0.1, Prop.float),\n\t\tProp('y', 0.2, Prop.float)\n\t]\n});\n","import { Component, Prop } from '../core/component';\n\nComponent.register({\n\tname: 'Test',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('name', 'Oh right', Prop.string),\n\t\tProp('number', 666, Prop.float)\n\t]\n});\n","/*\n Global event system\n\n let unlisten = events.listen('event name', function(params, ...) {});\n eventManager.dispatch('event name', paramOrParamArray);\n unlisten();\n */\n\nlet listeners = {};\n\nexport default {\n\tlisten(event, callback) {\n\t\tif (!listeners.hasOwnProperty(event)) {\n\t\t\tlisteners[event] = [];\n\t\t}\n\t\tlisteners[event].push(callback);\n\t\treturn () => {\n\t\t\tvar index = listeners[event].indexOf(callback);\n\t\t\tlisteners[event].splice(index, 1);\n\t\t};\n\t},\n\tdispatch(event, args) {\n\t\tif (listeners.hasOwnProperty(event)) {\n\t\t\tif (!Array.isArray(args)) args = [args];\n\n\t\t\tfor (var i = 0; i < listeners[event].length; ++i) {\n\t\t\t\ttry {\n\t\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (console && console.error) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class ModuleContainer {\n\tconstructor(moduleContainerName = 'unknownClass.anotherClass', packButtonIcon = 'fa-chevron-left') {\n\t\t\n\t\tthis.modules = [];\n\t\tthis.packButtonEnabled = !!packButtonIcon;\n\t\tthis.el = el(`div.moduleContainer.packable.${moduleContainerName}`,\n\t\t\tthis.packButton = packButtonIcon && el(`i.packButton.button.iconButton.fa.${packButtonIcon}`),\n\t\t\tthis.tabs = list('div.tabs', ModuleTab),\n\t\t\tthis.moduleElements = el('div.moduleElements')\n\t\t);\n\t\tif (packButtonIcon) {\n\t\t\tthis.el.onclick = () => this.el.classList.contains('packed') && this.el.classList.remove('packed');\n\t\t\tthis.packButton.onclick = e => {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\n\t\tevents.listen('registerModule_' + moduleContainerName.split('.')[0], moduleClass => {\n\t\t\tlet module = new moduleClass();\n\t\t\tmodule.el.classList.add('module-' + module.name);\n\t\t\tthis.modules.push(module);\n\t\t\tif (this.modules.length !== 1) {\n\t\t\t\tmodule._hide();\n\t\t\t}\n\t\t\tmount(this.moduleElements, module.el);\n\t\t\tthis._updateTabs();\n\t\t\t\n\t\t\tevents.listen('activateModule_' + module.name, () => {\n\t\t\t\tthis.el.classList.remove('packed');\n\t\t\t\tthis._activateModule(module, arguments);\n\t\t\t});\n\t\t});\n\t\tthis._updateTabs();\n\t}\n\tupdate(state) {\n\t\tstate = state || {};\n\t\tthis.modules.forEach(m => m.update(state));\n\t}\n\t_updateTabs() {\n\t\tif (!this.tabs) return;\n\t\t\n\t\tthis.tabs.update(this.modules);\n\t\t\n\t\tif (!this.packButtonEnabled && this.modules.length <= 1)\n\t\t\tthis.tabs.el.style.display = 'none';\n\t\telse\n\t\t\tthis.tabs.el.style.display = 'block';\n\t}\n\t_activateModule(module, args) {\n\t\tlet idx = this.modules.indexOf(module);\n\t\tthis.modules.forEach(m => {\n\t\t\tif (m !== module) {\n\t\t\t\tm._hide();\n\t\t\t}\n\t\t});\n\t\tmodule.activate(...args);\n\t\tmodule._show();\n\t\tthis._updateTabs();\n\t\t\n\t\t/*\n\t\tthis.modules.splice(idx, 1);\n\t\tthis.modules.unshift(module);\n\t\tthis._updateTabs();\n\t\tfor (let i = 1; i < this.modules.length; i++) {\n\t\t\tthis.modules[i].el.style.display = 'none';\n\t\t}\n\t\tmodule.activate(...args);\n\t\tmodule.el.style.display = 'block';\n\t\t*/\n\t}\n}\n\nclass ModuleTab {\n\tconstructor() {\n\t\tthis.el = el('span.moduleTab.button');\n\t\tthis.module = null;\n\t\tthis.el.onclick = () => {\n\t\t\tevents.dispatch('activateModule_' + this.module.name);\n\t\t};\n\t}\n\tupdate(module) {\n\t\tthis.module = module;\n\t\tthis.el.textContent = module.name;\n\t\tthis.el.classList.toggle('active', module._visible);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport ModuleContainer from './moduleContainer';\n\nexport default class Layout {\n\tconstructor() {\n\t\tthis.moduleContainers = [];\n\t\tlet addContainer = (...args) => {\n\t\t\tlet container = new ModuleContainer(...args);\n\t\t\tthis.moduleContainers.push(container);\n\t\t\treturn container;\n\t\t}\n\t\tthis.el = el('div.editorLayout',\n\t\t\tel('div.nonRight',\n\t\t\t\taddContainer('top', null),\n\t\t\t\tel('div.middle',\n\t\t\t\t\taddContainer('left', 'fa-chevron-left'),\n\t\t\t\t\taddContainer('center', null)\n\t\t\t\t),\n\t\t\t\taddContainer('bottom', 'fa-chevron-down')\n\t\t\t),\n\t\t\taddContainer('right', 'fa-chevron-right')\n\t\t);\n\t}\n\tupdate(state) {\n\t\tthis.moduleContainers.forEach(mc => mc.update(state));\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class Module {\n\tconstructor() {\n\t\tthis.name = this.name || 'Module';\n\t\tthis.el = el('div.module', ...arguments);\n\t\tthis._visible = true;\n\t}\n\t// Called when this module is opened. Other modules can call Module.activateModule('Module', ...args);\n\tactivate() {\n\t}\n\t// Called when state of editor changes\n\tupdate(state) {\n\t}\n\t_show() {\n\t\tthis.el.classList.remove('hidden');\n\t\tthis._visible = true;\n\t}\n\t_hide() {\n\t\tthis.el.classList.add('hidden');\n\t\tthis._visible = false;\n\t}\n}\nModule.activateModule = function(moduleName, ...args) {\n\tevents.dispatch('activateModule_' + moduleName, args);\n};\nModule.packModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.add('packed');\n};\nModule.unpackModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.remove('packed');\n};\n\n// moduleContainerName = left | middle | right | bottom\nModule.register = function(moduleClass, moduleContainerName) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerModule_' + moduleContainerName, [moduleClass]);\n\t});\n};\n\nlet nextPriorityNumber = 1;\nModule.registerTopButton = function(text, icon, func, priority = nextPriorityNumber++) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerTopButton', [text, icon, func, priority]);\n\t});\n};\n\n\nlet registerPromise = new Promise(function(resolve) {\n\tevents.listen('registerModules', function() {\n\t\tregisterPromise.then(() => {\n\t\t\tevents.dispatch('modulesRegistered');\n\t\t});\n\t\tresolve();\n\t});\n});\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nexport class TopBarModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.logo = el('img.logo.button.iconButton', { src: '../img/logo_reflection_medium.png' }),\n\t\t\tthis.list = list('div.buttonContainer', TopButton)\n\t\t);\n\t\tthis.name = 'TopBar';\n\t}\n\tupdate(state) {\n\t\tthis.list.update(state.topButtons);\n\t}\n}\nModule.register(TopBarModule, 'top');\n\nModule.registerTopButton('Bell', 'fa fa-bell-o', () => { \n\talert('Ring ring');\n\tModule.unpackModuleContainer('bottom');\n}, 1);\nModule.registerTopButton('Cubes', 'fa fa-cubes', () => {\n\tModule.activateModule('Test2');\n\tModule.packModuleContainer('bottom');\n}, 2);\n\nexport class TopButton {\n\tconstructor() {\n\t\tthis.el = el('div.button.topIconTextButton',\n\t\t\tel('div.topIconTextButtonContent',\n\t\t\t\tthis.icon = el('i.fa'),\n\t\t\t\tthis.text = el('span')\n\t\t\t)\n\t\t)\n\t\tthis.el.onclick = () => {\n\t\t\tthis.callback && this.callback();\n\t\t}\n\t\tthis.callback = null;\n\t}\n\tupdate(state) {\n\t\tthis.icon.className = state.icon;\n\t\tthis.text.textContent = state.text;\n\t\tthis.callback = state.func;\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.editor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.name = 'Properties';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t\tthis.componentClasses = state.componentClasses; \n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c.propertyModels.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc.propertyModels.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\t\t\n\t\tnew PJS($(this.editor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass SceneModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test')\n\t\t);\n\t\tthis.name = 'Scene';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(SceneModule, 'center');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test')\n\t\t);\n\t\tthis.name = 'Test';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test2')\n\t\t);\n\t\tthis.name = 'Test2';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'This is test 3')\n\t\t);\n\t\tthis.name = 'Test3';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'bottom');\n","import events from './events';\nimport Layout from './layout/layout';\nimport './module/topBar';\nimport './module/property';\nimport './module/scene';\nimport './module/test';\nimport './module/test2';\nimport './module/test3';\nimport { el, list, mount } from 'redom';\n\nimport { componentClasses } from '../core/component';\n\nwindow.addEventListener('load', () => {\n\teditor = new Editor();\n\tevents.dispatch('registerModules');\n});\nevents.listen('modulesRegistered', () => {\n\teditor.update();\n\tevents.dispatch('loaded');\n});\n\nlet editor = null;\nclass Editor {\n\tconstructor() {\n\t\tthis.layout = new Layout();\n\t\t\n\t\tthis.state = {\n\t\t\ttopButtons: [],\n\t\t\tselectedItems: [],\n\t\t\tcomponentClasses\n\t\t};\n\n\t\tmount(document.body, this.layout);\n\t\t\n\t\tevents.listen('registerTopButton', (text, icon, func, priority) => {\n\t\t\tlet button = { icon, text, func, priority };\n\t\t\tlet i = 0;\n\t\t\tlet topButtons = this.state.topButtons;\n\t\t\twhile (i < topButtons.length) {\n\t\t\t\tlet b = topButtons[i];\n\t\t\t\tif (b.priority > priority) {\n\t\t\t\t\ttopButtons.splice(i, 0, button);\n\t\t\t\t\ti = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i >= 0) topButtons.push(button);\n\t\t});\n\t}\n\tselect(items) {\n\t\tthis.selectedItems = items;\n\t\tthis.layout.select(items);\n\t}\n\tupdate() {\n\t\tthis.layout.update(this.state);\n\t}\n}\n","// tests\nimport './core/test';\nimport './core/componentExample';\n\n// main\nimport './main';\nimport './editor/editor';\n\n\nimport Property from './core/property';\nwindow.Property = Property;\n\nimport PropertyModel from './core/propertyModel';\nwindow.PropertyModel = PropertyModel;\n\nimport PropertyType from './core/propertyType';\nwindow.PropertyType = PropertyType;\n\nimport { Component } from './core/component';\nwindow.Component = Component;\n"],"names":["assert","condition","message","Error","addSerializable","serializable","serializables","has","id","set","removeSerializable","delete","char","BASE_64_CHARACTERS","Math","random","CHAR_COUNT","createStringId","threeLetterPrefix","characters","let","i","PropertyType","propertyName","defaultValue","type","validator","validators","default","description","optionalParameters","forEach","p","validate","PropertyModel","addType","ref","x","name","toJSON","fromJSON","createType","Object","keys","validatorName","createValidator","validatorFunction","parameters","validatorParameters","createElement","query","ns","tag","className","mode","start","length","charCodeAt","HASH","DOT","substring","slice","element","document","createElementNS","text","content","createTextNode","mount","parent","child","before","parentEl","el","childEl","__redom_list","__redom_view","isMounted","remount","insertBefore","appendChild","remounted","mounted","unmount","removeChild","unmounted","arguments$1","arguments","elcache","cloneNode","nodeType","empty","arg","textContent","j","key","value","setAttribute","cssKey","style","setChildren","children","traverse","firstChild","nextSibling","next","list","View","initData","List","this","views","lookup","Map","Serializable","threeLetterType","predefinedId","serializableManager.addSerializable","serializableManager.removeSerializable","toString","JSON","stringify","json","const","ALIVE_ERROR","Entity","super","components","alive","sleeping","prototype","getComponent","get","undefined","getComponents","addComponents","Array","isArray","componentList","push","initComponents","_preInit","_init","makeComponentsSleep","_sleep","deleteComponents","sleep","componentArray","wakeUp","clear","assign","initialValue","parseFloat","isNaN","range","min","max","String","s","console","log","size","float","Property","propertyModel","model","modelId","defineProperty","newValue","_value","componentClasses","Component","componentModel","entity","env","_properties","_componentModel","constructor","propertyModels","requirements","r","_forEachChildComponent","c","preInit","e","error","init","func","reservedPropertyNames","Set","reservedPrototypeMembers","register","k","constructorFunction","deleteFunction","Class","parentClass","properties","category","icon","Prop","string","staticVariable","hiddenVariable","data","lotsOfData","variable","Position","y","howToAccessChildren","Image","property","Sound","SomeComponent","listeners","listen","event","callback","hasOwnProperty","index","indexOf","splice","dispatch","args","apply","extend","clone","bind","update","functionKey","newViews","oldViews","newLookup","oldLookup","item","view","__id","el$$1","Router","Views","route","ModuleContainer","moduleContainerName","packButtonIcon","modules","packButtonEnabled","packButton","tabs","ModuleTab","moduleElements","onclick","classList","contains","remove","this$1","add","stopPropagation","events","split","moduleClass","module","_hide","_updateTabs","_activateModule","state","m","display","activate","_show","toggle","_visible","Layout","moduleContainers","addContainer","container","mc","Module","argsArray","activateModule","moduleName","packModuleContainer","querySelectorAll","unpackModuleContainer","registerPromise","then","nextPriorityNumber","registerTopButton","priority","Promise","resolve","TopBarModule","logo","src","TopButton","topButtons","alert","propertyTypeToEditorType","PropertyModule","editor","schema","editors","field","title","from","values","componentSchema","map","pm","componentData","PJS","$","SceneModule","TestModule","window","addEventListener","Editor","layout","selectedItems","body","button","b","select","items"],"mappings":"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"}