{"version":3,"file":null,"sources":["../src/assert.js","../src/core/serializableManager.js","../src/core/serializable.js","../src/core/propertyType.js","../node_modules/redom/dist/redom.es.js","../src/core/dataTypes.js","../src/core/property.js","../src/core/component.js","../src/game/components/Position.js","../src/game/components/Test.js","../src/core/prototype.js","../src/game/game.js","../src/core/entity.js","../src/core/test.js","../src/core/componentExample.js","../src/editor/events.js","../src/editor/layout/moduleContainer.js","../src/editor/layout/layout.js","../src/editor/module/module.js","../src/editor/module/topBar.js","../src/editor/module/type.js","../src/editor/module/instance.js","../src/editor/module/scene.js","../src/editor/module/types.js","../src/editor/module/instances.js","../src/editor/module/test3.js","../src/editor/editor.js","../src/mainDev.js"],"sourcesContent":["export default function assert(condition, message) {\n\tif (!condition)\n\t\tthrow new Error(message);\n}\n","let serializables = {};\n\nexport function addSerializable(serializable) {\n\tif (serializables[serializable.id]) throw new Error('Serializable id clash!');\n\tserializables[serializable.id] = serializable;\n}\n\nexport function getSerializable(id) {\n\treturn serializables[id] || null;\n}\n\nexport function hasSerializable(id) {\n\treturn Boolean(serializables[id]);\n}\n\nexport function removeSerializable(id) {\n\tif (serializables[id])\n\t\tdelete serializables[id];\n\telse\n\t\tthrow new Error('Serializable not found!');\n}\n","import assert from '../assert';\nimport * as serializableManager from './serializableManager';\n\nconst CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'; // 62 chars\nconst CHAR_COUNT = CHARACTERS.length;\nfunction char() {\n\treturn CHARACTERS[Math.random() * CHAR_COUNT | 0];\n}\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i !== 0; --i)\n\t\tid += char();\n\treturn id;\n}\n\nlet serializableClasses = new Map();\n\nexport default class Serializable {\n\tconstructor(threeLetterType, predefinedId = false) {\n\t\tthis.id = predefinedId || createStringId(threeLetterType);\n\t\tserializableManager.addSerializable(this);\n\t}\n\tdelete() {\n\t\tserializableManager.removeSerializable(this.id);\n\t}\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this.id\n\t\t};\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string' && json.id.length > 3);\n\t\tlet fromJSON = serializableClasses.get(json.id.substring(0, 3));\n\t\tassert(fromJSON);\n\t\treturn fromJSON(json);\n\t}\n\tstatic registerSerializable(threeLetterPrefix, fromJSON) {\n\t\tassert(typeof threeLetterPrefix === 'string' && threeLetterPrefix.length === 3);\n\t\tassert(typeof fromJSON === 'function');\n\t\tserializableClasses.set(threeLetterPrefix, fromJSON);\n\t}\n}\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// info about type, validator, validatorParameters, initialValue\n\nclass PropertyType extends Serializable {\n\tconstructor(name, type, validator, initialValue) {\n\t\tassert(typeof name === 'string');\n\t\tassert(typeof type.name === 'string');\n\t\tassert(typeof validator.validate === 'function');\n\t\t\n\t\tsuper('pmo');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tname: this.name,\n\t\t\ttype: this.type.name,\n\t\t\tvalidatorName: this.validator.validatorName,\n\t\t\tvalidatorParameters: this.validator.validatorParameters,\n\t\t\tinitialValue: this.type.toJSON(this.initialValue)\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.type = null;\n\t\tthis.validator = null;\n\t}\n}\n\n/*\n\tBeautiful way of creating property types\n\t\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\nexport default function createPropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\toptionalParameters.forEach(p => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p);\n\t});\n\treturn new PropertyType(propertyName, type, validator, defaultValue);\n};\n\nexport function addDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist\n\ttoJSON = x => x,\n\tfromJSON = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\tcreatePropertyType[name] = createType;\n}\n\nfunction createValidator(name, validatorFunction) {\n\tlet validator = function() {\n\t\tlet parameters = [...arguments];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidatorParameters: parameters,\n\t\t\tvalidate: x => validatorFunction(x, ...parameters)\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nfunction createElement (query, ns) {\n  var tag;\n  var id;\n  var className;\n\n  var mode = 0;\n  var start = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n\n    if (char === HASH || char === DOT || !char) {\n      if (mode === 0) {\n        if (i === 0) {\n          tag = 'div';\n        } else if (!char) {\n          tag = query;\n        } else {\n          tag = query.substring(start, i);\n        }\n      } else {\n        var slice = query.substring(start, i);\n\n        if (mode === 1) {\n          id = slice;\n        } else if (className) {\n          className += ' ' + slice;\n        } else {\n          className = slice;\n        }\n      }\n\n      start = i + 1;\n\n      if (char === HASH) {\n        mode = 1;\n      } else {\n        mode = 2;\n      }\n    }\n  }\n\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    element.className = className;\n  }\n\n  return element;\n}\n\nfunction text (content) {\n  return document.createTextNode(content);\n}\n\nfunction mount (parent, child, before) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (childEl.__redom_list) {\n    childEl = childEl.el;\n  }\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n  if (child.isMounted) {\n    child.remount && child.remount();\n  } else {\n    child.mount && child.mount();\n  }\n  if (before) {\n    parentEl.insertBefore(childEl, before.el || before);\n  } else {\n    parentEl.appendChild(childEl);\n  }\n  if (child.isMounted) {\n    child.remounted && child.remounted();\n  } else {\n    child.isMounted = true;\n    child.mounted && child.mounted();\n  }\n}\n\nfunction unmount (parent, child) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  child.unmount && child.unmount();\n\n  parentEl.removeChild(childEl);\n\n  child.isMounted = false;\n  child.unmounted && child.unmounted();\n}\n\nvar elcache = {};\n\nfunction el (query) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (elcache[query] || (elcache[query] = createElement(query))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (arg.length) {\n      empty = false;\n      for (var j = 0; j < arg.length; j++) {\n        mount(element, arg[j]);\n      }\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style') {\n          if (typeof value === 'string') {\n            element.setAttribute(key, value);\n          } else {\n            for (var cssKey in value) {\n              element.style[cssKey] = value[cssKey];\n            }\n          }\n        } else if (key in element || typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nel.extend = function (query) {\n  var clone = (elcache[query] || (elcache[query] = createElement(query)));\n\n  return el.bind(this, clone);\n};\n\nfunction setChildren (parent, children) {\n  var parentEl = parent.el || parent;\n  var traverse = parentEl.firstChild;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = child.el || child;\n\n    if (childEl === traverse) {\n      traverse = traverse.nextSibling;\n      continue;\n    }\n\n    mount(parent, child, traverse);\n  }\n\n  while (traverse) {\n    var next = traverse.nextSibling;\n\n    unmount(parent, traverse);\n\n    traverse = next;\n  }\n}\n\nfunction list (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\nfunction List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.key = key;\n  this.initData = initData;\n  this.views = [];\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n\n  if (key) {\n    this.lookup = {};\n  }\n}\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\nList.prototype.update = function (data) {\n  if ( data === void 0 ) data = [];\n\n  var View = this.View;\n  var key = this.key;\n  var functionKey = typeof key === 'function';\n  var initData = this.initData;\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n  var newLookup = key && {};\n  var oldLookup = key && this.lookup;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (key) {\n      var id = functionKey ? key(item) : item[key];\n      view = newViews[i] = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__id = id;\n    } else {\n      view = newViews[i] = oldViews[i] || new View(initData, item, i, data);\n    }\n    var el$$1 = view.el;\n    if (el$$1.__redom_list) {\n      el$$1 = el$$1.el;\n    }\n    el$$1.__redom_view = view;\n    view.update && view.update(item, i, data);\n  }\n\n  setChildren(this, newViews);\n\n  if (key) {\n    this.lookup = newLookup;\n  }\n  this.views = newViews;\n};\n\nfunction router (parent, Views) {\n  return new Router(parent, Views);\n}\n\nvar Router = function Router (parent, Views) {\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n  this.Views = Views;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.view = View && new View();\n    this.route = route;\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data);\n};\n\nvar SVG = 'http://www.w3.org/2000/svg';\n\nvar svgcache = {};\n\nfunction svg (query, a) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (svgcache[query] || (svgcache[query] = createElement(query, SVG))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    } else if (typeof arg === 'function') {\n      arg = arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style' && typeof value !== 'string') {\n          for (var cssKey in value) {\n            element.style[cssKey] = value[cssKey];\n          }\n        } else if (typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nsvg.extend = function (query) {\n  var clone = (svgcache[query] || (svgcache[query] = createElement(query, SVG)));\n\n  return svg.bind(this, clone);\n};\n\nexport { el, list, List, mount, unmount, router, Router, setChildren, svg, text };\n","import assert from '../assert';\nimport { addDataType } from './propertyType';\n\naddDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\naddDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => String(x)\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// Instance of a property\nexport default class Property extends Serializable {\n\tconstructor(propertyModel) {\n\t\tsuper('pro');\n\t\tthis.model = propertyModel;\n\t\tthis.value = propertyModel.initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tvalue: this.type.toJSON(this.value),\n\t\t\tmodelId: this.model.id\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.model = null;\n\t}\n}\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.model.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.model.validator.validate(newValue);\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\nObject.defineProperty(Property.prototype, 'initialValue', {\n\tget() {\n\t\treturn this.model.initialValue;\n\t}\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport Property from './property';\n\nexport { default as Prop } from './propertyType';\n\nexport let componentClasses = new Map();\n\n// Instance of a component, see componentExample.js\nexport class Component extends Serializable {\n\tconstructor(componentData, entity, env) {\n\t\tsuper('com');\n\t\tthis.entity = entity;\n\t\tthis.env = env;\n\t\tthis.children = {}; // TODO: create children\n\t\tthis._properties = {};\n\t\tthis._componentData = componentData;\n\t\tthis.constructor.propertyTypes.forEach(p => {\n\t\t\tthis._properties[p.name] = new Property(p);\n\t\t});\n\t}\n\tdelete() {\n\t\tassert(!this.env.entity.alive, 'Do not call Component.delete!');\n\t\tsuper.delete();\n\t}\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], 'required component not found');\n\t\t});\n\n\t\tthis._forEachChildComponent(c => c._preInit());\n\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'preInit', e);\n\t\t}\n\t}\n\t_init() {\n\t\tthis._forEachChildComponent(c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'sleep', e);\n\t\t}\n\t\tthis._forEachChildComponent(c => c._sleep());\n\t}\n\t_forEachChildComponent(func) {\n\t\tObject.keys(this.children).forEach(key => {\n\t\t\tlet child = this.children[key];\n\t\t\tif (Array.isArray(child)) {\n\t\t\t\tchild.forEach(func);\n\t\t\t} else {\n\t\t\t\tfunc(child);\n\t\t\t}\n\t\t});\n\t}\n}\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.register = function({\n\tname = '', // required\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-bars',\n\tproperties = [],\n\trequirements = [],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {}\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Class extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction();\n\t\t}\n\t\tdelete() {\n\t\t\tsuper.delete(...arguments);\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction();\n\t\t}\n\t}\n\tObject.defineProperty(Class, 'name', { get: () => name });\n\tClass.propertyTypes = properties;\n\tClass.propertyTypeMap = new Map();\n\tClass.category = category;\n\tClass.requirements = requirements;\n\tClass.children = children;\n\tClass.description = description;\n\tClass.icon = icon;\n\tObject.assign(Class.prototype, prototype);\n\n\tClass.propertyTypes.forEach(p => {\n\t\tClass.propertyTypeMap.set(p.name, p);\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t\tassert(Class.prototype[p.name] === undefined, 'Name ' + p.name + ' clashes ');\n\t\tObject.defineProperty(Class.prototype, p.name, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[p.name].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[p.name].value = value;\n\t\t\t}\n\t\t});\n\t});\n\tcomponentClasses.set(Class.name, Class);\n\treturn Class;\n};\n","import { Component, Prop } from '../../core/component';\n\nComponent.register({\n\tname: 'Position',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('x', 0.1, Prop.float),\n\t\tProp('y', 0.2, Prop.float)\n\t]\n});\n","import { Component, Prop } from '../../core/component';\n\nComponent.register({\n\tname: 'Test',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('name', 'Oh right', Prop.string),\n\t\tProp('number', 666, Prop.float)\n\t]\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport { getSerializable } from './serializableManager';\n\nexport default class Prototype extends Serializable {\n\tconstructor({ name = 'No name', parentId = null, componentDatas = new Map(), predefinedId = false }) {\n\t\tsuper('prt', predefinedId);\n\t\tthis.name = name;\n\t\tthis.parentId = parentId;\n\t\tthis.componentDatas = componentDatas; // componentId -> ComponentData\n\t}\n\tgetParent() {\n\t\treturn this.parentId && getSerializable(this.parentId);\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tnm: this.name,\n\t\t\tmom: this.parentId || undefined\n\t\t});\n\t}\n}\n\nSerializable.registerSerializable('prt', json => {\n\tassert(json.nm);\n\treturn new Prototype({\n\t\tname: json.nm,\n\t\tparentId: json.mom,\n\t\tpredefinedId: json.id\n\t});\n});\n","import Serializable from '../core/serializable'\nimport './components/import'\nimport Prototype from '../core/prototype'\nimport assert from '../assert'\n\nexport default class Game extends Serializable {\n\tconstructor({ name = 'Game', prototypes = [], predefinedId = false } = {}) {\n\t\tsuper('gam', predefinedId);\n\t\tthis.prototypes = prototypes;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tnm: this.name,\n\t\t\tprt: this.prototypes.map(p => p.toJSON())\n\t\t});\n\t}\n}\n\nSerializable.registerSerializable('gam', json => {\n\treturn new Game({\n\t\tname: json.nm || undefined,\n\t\tprototypes: json.prt ? json.prt.map(Serializable.fromJSON) : undefined,\n\t\tpredefinedId: json.id\n\t});\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor() {\n\t\tsuper('ent');\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.alive = true;\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null;\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tUses addComponent internally.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet componentList = this.components.get(components[i].name) || this.components.set(components[i].name, []).get(components[i].name);\n\t\t\tcomponentList.push(components[i]);\n\t\t}\n\t\t\n\t\tif (!this.sleeping)\n\t\t\tEntity.initComponents(components);\n\t\treturn this;\n\t}\n\tstatic initComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\tsleep() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\t\t\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.makeComponentsSleep(componentArray);\n\t\t\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\twakeUp() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.initComponents(componentArray);\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\tdelete() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tsuper.delete();\n\t\tthis.alive = false;\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.deleteComponents(componentArray);\n\t\tthis.components.clear();\n\t}\n\ttoJSON() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcomponents: []\n\t\t});\n\t}\n}\n","import assert from '../assert';\n\nimport Serializable from './serializable';\n(() => {\n\tlet s = new Serializable('tes');\n\tSerializable.registerSerializable('tes', json => {\n\t\treturn new Serializable(null, json.id);\n\t});\n\tlet id = s.id;\n\tassert(typeof id === 'string' && id.length > 10);\n\tlet json = s.toJSON();\n\tassert(json && typeof json === 'object' && typeof json.id === 'string');\n\ts.delete();\n\ts = Serializable.fromJSON(json);\n\tassert(typeof s.id === 'string' && s.id.length > 10 && s.id === id);\n\tconsole.log('Serializable tests OK');\n})();\n\nimport Entity from './entity';\n(() => {\n\tlet i = new Entity();\n\tassert(i.components.size === 0);\n\tassert(i.getComponent('moi') === null);\n\tassert(i.getComponents('moi').length === 0);\n\tconsole.log('Entity tests OK');\n})();\n\nimport PropertyType from './propertyType';\n(() => {\n\tassert(PropertyType.float.default().validate('4') === 4);\n\tassert(PropertyType.float.range(0, 1).validate(3) === 1);\n\tconsole.log('PropertyType tests OK');\n})();\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Example',\n\tdescription: 'Description of what this component does',\n\tcategory: 'Core', // You can also make up new categories.\n\ticon: 'fa-circle', // Font Awesome id\n\trequirements: ['Position'], // These shared components are autofilled. Error if component is not found.\n\tchildren: ['Image', 'Image', 'Sound'], // These private components are also autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('variable', 0.5, Prop.float, Prop.float.range(0, 1), 'Description of the property'),\n\t\tProp('otherVar_iaerfperfjoierj', 'Hello', Prop.string, 'Description of the property')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tstaticVariable: 'Example class info',\n\t\tconstructor() {\n\t\t\t// This will be called once, when creating the component\n\t\t\tthis.hiddenVariable = 3;\n\t\t},\n\t\tpreInit() {\n\t\t\t// preInit is called for every component before any component is inited with init(). Children are already preInited here.\n\t\t\tthis.data = {\n\t\t\t\tlotsOfData: 123 + this.variable + this.hiddenVariable\n\t\t\t};\n\t\t},\n\t\tinit() {\n\t\t\t// All the components of this entity has been preInited. You can use them. Children are already inited here.\n\t\t\tthis.Position.x = this.Position.y + 1;\n\n\t\t\tthis.howToAccessChildren = [\n\t\t\t\tthis.children.Image[0].property,\n\t\t\t\tthis.children.Sound.property\n\t\t\t];\n\n\t\t\tthis.SomeComponent = this.entity.getComponent('SomeComponent');\n\t\t},\n\t\tsleep() {\n\t\t\t// Release all the data created in preInit and init\n\t\t\tthis.data = null;\n\t\t\tthis.SomeComponent = null;\n\t\t\tthis.howToAccessChildren = null;\n\t\t\t// Position component is automatically released because it is a requirement.\n\t\t},\n\t\tdelete() {\n\t\t\t// This will be called once, when component stops existing\n\t\t}\n\t}\n});\n","/*\n Global event system\n\n let unlisten = events.listen('event name', function(params, ...) {});\n eventManager.dispatch('event name', paramOrParamArray);\n unlisten();\n */\n\nlet listeners = {};\n\nexport default {\n\tlisten(event, callback) {\n\t\tif (!listeners.hasOwnProperty(event)) {\n\t\t\tlisteners[event] = [];\n\t\t}\n\t\tlisteners[event].push(callback);\n\t\treturn () => {\n\t\t\tvar index = listeners[event].indexOf(callback);\n\t\t\tlisteners[event].splice(index, 1);\n\t\t};\n\t},\n\tdispatch(event, args) {\n\t\tif (listeners.hasOwnProperty(event)) {\n\t\t\tif (!Array.isArray(args)) args = [args];\n\n\t\t\tfor (var i = 0; i < listeners[event].length; ++i) {\n\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t/*\n\t\t\t\ttry {\n\t\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (console && console.error) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t}\n};\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class ModuleContainer {\n\tconstructor(moduleContainerName = 'unknownClass.anotherClass', packButtonIcon = 'fa-chevron-left') {\n\t\t\n\t\tthis.modules = [];\n\t\tthis.packButtonEnabled = !!packButtonIcon;\n\t\tthis.el = el(`div.moduleContainer.packable.${moduleContainerName}`,\n\t\t\tthis.packButton = packButtonIcon && el(`i.packButton.button.iconButton.fa.${packButtonIcon}`),\n\t\t\tthis.tabs = list('div.tabs', ModuleTab),\n\t\t\tthis.moduleElements = el('div.moduleElements')\n\t\t);\n\t\tif (packButtonIcon) {\n\t\t\tthis.el.onclick = () => this.el.classList.contains('packed') && this.el.classList.remove('packed');\n\t\t\tthis.packButton.onclick = e => {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\n\t\tevents.listen('registerModule_' + moduleContainerName.split('.')[0], moduleClass => {\n\t\t\tlet module = new moduleClass();\n\t\t\tmodule.el.classList.add('module-' + module.id);\n\t\t\tthis.modules.push(module);\n\t\t\tif (this.modules.length !== 1) {\n\t\t\t\tmodule._hide();\n\t\t\t}\n\t\t\tmount(this.moduleElements, module.el);\n\t\t\tthis._updateTabs();\n\t\t\t\n\t\t\tevents.listen('activateModule_' + module.id, (unpackModuleView = true, ...args) => {\n\t\t\t\tif (unpackModuleView)\n\t\t\t\t\tthis.el.classList.remove('packed');\n\t\t\t\tthis._activateModule(module, args);\n\t\t\t});\n\t\t});\n\t\tthis._updateTabs();\n\t}\n\tupdate(state) {\n\t\tstate = state || {};\n\t\tthis.modules.forEach(m => m.update(state));\n\t}\n\t_updateTabs() {\n\t\tif (!this.tabs) return;\n\t\t\n\t\tthis.tabs.update(this.modules);\n\t\t\n\t\tif (!this.packButtonEnabled && this.modules.length <= 1)\n\t\t\tthis.tabs.el.style.display = 'none';\n\t\telse\n\t\t\tthis.tabs.el.style.display = 'block';\n\t}\n\t_activateModule(module, args) {\n\t\tlet idx = this.modules.indexOf(module);\n\t\tthis.modules.forEach(m => {\n\t\t\tif (m !== module) {\n\t\t\t\tm._hide();\n\t\t\t}\n\t\t});\n\t\tmodule.activate(...args);\n\t\tmodule._show();\n\t\tthis._updateTabs();\n\t\t\n\t\t/*\n\t\tthis.modules.splice(idx, 1);\n\t\tthis.modules.unshift(module);\n\t\tthis._updateTabs();\n\t\tfor (let i = 1; i < this.modules.length; i++) {\n\t\t\tthis.modules[i].el.style.display = 'none';\n\t\t}\n\t\tmodule.activate(...args);\n\t\tmodule.el.style.display = 'block';\n\t\t*/\n\t}\n}\n\nclass ModuleTab {\n\tconstructor() {\n\t\tthis.el = el('span.moduleTab.button');\n\t\tthis.module = null;\n\t\tthis.el.onclick = () => {\n\t\t\tevents.dispatch('activateModule_' + this.module.id);\n\t\t};\n\t}\n\tupdate(module) {\n\t\tthis.module = module;\n\t\tthis.el.textContent = module.name;\n\t\tthis.el.classList.toggle('active', module._visible);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport ModuleContainer from './moduleContainer';\n\nexport default class Layout {\n\tconstructor() {\n\t\tthis.moduleContainers = [];\n\t\tlet addContainer = (...args) => {\n\t\t\tlet container = new ModuleContainer(...args);\n\t\t\tthis.moduleContainers.push(container);\n\t\t\treturn container;\n\t\t}\n\t\tthis.el = el('div.editorLayout',\n\t\t\tel('div.nonRight',\n\t\t\t\taddContainer('top', null),\n\t\t\t\tel('div.middle',\n\t\t\t\t\taddContainer('left', 'fa-chevron-left'),\n\t\t\t\t\taddContainer('center', null)\n\t\t\t\t),\n\t\t\t\taddContainer('bottom', 'fa-chevron-down')\n\t\t\t),\n\t\t\taddContainer('right', 'fa-chevron-right')\n\t\t);\n\t}\n\tupdate(state) {\n\t\tthis.moduleContainers.forEach(mc => mc.update(state));\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class Module {\n\tconstructor() {\n\t\tthis.name = this.name || 'Module';\n\t\tthis.id = this.id || 'module';\n\t\tthis.el = el('div.module', ...arguments);\n\t\tthis._visible = true;\n\t}\n\t// Called when this module is opened. Other modules can call Module.activateModule('Module', ...args);\n\tactivate() {\n\t}\n\t// Called when state of editor changes\n\tupdate(state) {\n\t}\n\t_show() {\n\t\tthis.el.classList.remove('hidden');\n\t\tthis._visible = true;\n\t}\n\t_hide() {\n\t\tthis.el.classList.add('hidden');\n\t\tthis._visible = false;\n\t}\n}\n//arguments: moduleName, unpackModuleView=true, ...args \nModule.activateModule = function(moduleName, unpackModuleView=true, ...args) {\n\tevents.dispatch('activateModule_' + moduleName, [unpackModuleView, ...args]);\n};\nModule.packModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.add('packed');\n};\nModule.unpackModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.remove('packed');\n};\nModule.requestUpdate = function() {\n\tevents.dispatch('requestUpdate');\n};\n\n// moduleContainerName = left | middle | right | bottom\nModule.register = function(moduleClass, moduleContainerName) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerModule_' + moduleContainerName, [moduleClass]);\n\t});\n};\n\nlet nextPriorityNumber = 1;\nModule.registerTopButton = function(text, icon, func, priority = nextPriorityNumber++) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerTopButton', [text, icon, func, priority]);\n\t});\n};\n\n\nlet registerPromise = new Promise(function(resolve) {\n\tevents.listen('registerModules', function() {\n\t\tregisterPromise.then(() => {\n\t\t\tevents.dispatch('modulesRegistered');\n\t\t});\n\t\tresolve();\n\t});\n});\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nexport class TopBarModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.logo = el('img.logo.button.iconButton', { src: '../img/logo_reflection_medium.png' }),\n\t\t\tthis.list = list('div.buttonContainer', TopButton)\n\t\t);\n\t\tthis.id = 'topbar';\n\t\tthis.name = 'TopBar'; // not visible\n\t}\n\tupdate(state) {\n\t\tthis.list.update(state.topButtons);\n\t}\n}\nModule.register(TopBarModule, 'top');\n\nModule.registerTopButton('Bell Types', 'fa fa-bell-o', () => { \n\tModule.unpackModuleContainer('bottom');\n\tModule.activateModule('types');\n\tModule.activateModule('type');\n}, 1);\nModule.registerTopButton('Cube Instances', 'fa fa-cubes', () => {\n\tModule.activateModule('instances');\n\tModule.activateModule('instance');\n}, 2);\n\nexport class TopButton {\n\tconstructor() {\n\t\tthis.el = el('div.button.topIconTextButton',\n\t\t\tel('div.topIconTextButtonContent',\n\t\t\t\tthis.icon = el('i.fa'),\n\t\t\t\tthis.text = el('span')\n\t\t\t)\n\t\t)\n\t\tthis.el.onclick = () => {\n\t\t\tthis.callback && this.callback();\n\t\t}\n\t\tthis.callback = null;\n\t}\n\tupdate(state) {\n\t\tthis.icon.className = state.icon;\n\t\tthis.text.textContent = state.text;\n\t\tthis.callback = state.func;\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.editor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.id = 'type';\n\t\tthis.name = 'Type';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t\tthis.componentClasses = state.componentClasses; \n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c.propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc.propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\t\t\n\t\tnew PJS($(this.editor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.editor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.id = 'instance';\n\t\tthis.name = 'Instance';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t\tthis.componentClasses = state.componentClasses;\n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c.propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc.propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\n\t\tnew PJS($(this.editor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass SceneModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test')\n\t\t);\n\t\tthis.id = 'scene';\n\t\tthis.name = 'Scene';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(SceneModule, 'center');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport events from '../events';\nimport Prototype from '../../core/prototype';\nimport { getSerializable } from '../../core/serializableManager';\nimport assert from '../../assert';\n\nclass Types extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.addButton = el('span.addTypeButton.button.fa.fa-plus'),\n\t\t\tthis.search = el('input'),\n\t\t\tthis.searchIcon = el('i.fa.fa-search.searchIcon'),\n\t\t\tthis.jstree = el('div')\n\t\t);\n\t\tthis.id = 'types';\n\t\tthis.name = 'Types';\n\n\t\tthis.addButton.onclick = () => {\n\t\t\tthis.game.prototypes.push(new Prototype('' + Math.random()));\n\t\t\tevents.dispatch('requestUpdate');\n\t\t};\n\t\t\n\t\tlet searchTimeout = false;\n\t\tthis.search.addEventListener('keyup', () => {\n\t\t\tif (searchTimeout)\n\t\t\t\tclearTimeout(searchTimeout);\n\n\t\t\tsearchTimeout = setTimeout(() => {\n\t\t\t\t$(this.jstree).jstree().search(this.search.value.trim());\n\t\t\t}, 200);\n\t\t});\n\t}\n\tupdate(state) {\n\t\tconsole.log('types update');\n\t\t//state.game.prototypes.\n\t\tsuper.update(state);\n\t\tthis.game = state.game;\n\n\t\tlet data = state.game.prototypes.map(p => ({\n\t\t\ttext: p.name,\n\t\t\tid: p.id,\n\t\t\tparent: p.parentId || '#'\n\t\t}));\n\t\t\n\t\tif (!this.jstreeInited) {\n\t\t\t$(this.jstree).attr('id', 'types-jstree').jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tcheck_callback: true,\n\t\t\t\t\tdata,\n\t\t\t\t\tforce_text: true\n\t\t\t\t},\n\t\t\t\tplugins: ['types', 'dnd', 'sort', 'search', 'unique'],\n\t\t\t\ttypes: {\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\ticon: 'fa fa-book'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsearch: {\n\t\t\t\t\tfuzzy: true,\n\t\t\t\t\tshow_only_matches: true,\n\t\t\t\t\tshow_only_matches_children: true,\n\t\t\t\t\tclose_opened_onclear: false\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.jstreeInited = true;\n\t\t} else {\n\t\t\t$(this.jstree).jstree(true).settings.core.data = data;\n\t\t\t$(this.jstree).jstree('refresh');\n\t\t}\n\t}\n}\n\n$(document).on('dnd_stop.vakata', function (e, data) {\n\tlet jstree = $('#types-jstree').jstree(true);\n\tlet node = jstree.get_node(data.data.obj);\n\tlet nodes = data.data.nodes; // these prototypes will move\n\tsetTimeout(function () {\n\t\t// Now the nodes have moved in the DOM.\n\t\t\n\t\tlet newParent = node.parent;\n\t\tif (newParent === '#')\n\t\t\tnewParent = null;\n\t\tconsole.log(nodes.map(getSerializable));\n\t\t\n\t\tlet nodeObjects = nodes.map(getSerializable);\n\t\tnodeObjects.forEach(assert);\n\t\tnodeObjects.forEach(prototype => prototype.parentId = newParent);\n\t\t\n\t\tconsole.log(nodes.map(getSerializable));\n\t\tconsole.log(`Nodes ${nodes} to ${newParent}`);\n\t});\n});\n\nModule.register(Types, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'List of instances on the scene')\n\t\t);\n\t\tthis.name = 'Instances';\n\t\tthis.id = 'instances';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'This is test 3')\n\t\t);\n\t\tthis.id = 'test';\n\t\tthis.name = 'Test3';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'bottom');\n","import events from './events';\nimport Layout from './layout/layout';\nimport './module/topBar';\nimport './module/type';\nimport './module/instance';\nimport './module/scene';\nimport './module/types';\nimport './module/instances';\nimport './module/test3';\nimport { el, list, mount } from 'redom';\nimport Game from '../game/game';\nimport Serializable from '../core/serializable';\n\nimport { componentClasses } from '../core/component';\n\nwindow.addEventListener('load', () => {\n\tlet anotherGame;\n\ttry {\n\t\tanotherGame = Serializable.fromJSON(JSON.parse(localStorage.anotherGameJSON));\n\t} catch(e) {}\n\teditor = new Editor(anotherGame);\n\tevents.dispatch('registerModules');\n});\nevents.listen('modulesRegistered', () => {\n\teditor.update();\n\tevents.dispatch('loaded');\n});\n\nsetInterval(function() {\n\tif (!editor || !editor.state.game) return;\n\ttry {\n\t\tlocalStorage.anotherGameJSON = JSON.stringify(editor.state.game.toJSON());\n\t} catch(e) {}\n}, 2000);\n\nlet editor = null;\nclass Editor {\n\tconstructor(game = new Game()) {\n\t\tthis.layout = new Layout();\n\t\t\n\t\tthis.state = {\n\t\t\ttopButtons: [],\n\t\t\tselection: {\n\t\t\t\ttype: 'none',\n\t\t\t\titems: []\n\t\t\t},\n\t\t\tgame,\n\t\t\tcomponentClasses\n\t\t};\n\n\t\tmount(document.body, this.layout);\n\t\t\n\t\tevents.listen('registerTopButton', (text, icon, func, priority) => {\n\t\t\tlet button = { icon, text, func, priority };\n\t\t\tlet i = 0;\n\t\t\tlet topButtons = this.state.topButtons;\n\t\t\twhile (i < topButtons.length) {\n\t\t\t\tlet b = topButtons[i];\n\t\t\t\tif (b.priority > priority) {\n\t\t\t\t\ttopButtons.splice(i, 0, button);\n\t\t\t\t\ti = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i >= 0) topButtons.push(button);\n\t\t});\n\t\t\n\t\tevents.listen('requestUpdate', () => {\n\t\t\tconsole.log('requested');\n\t\t\tthis.update();\n\t\t});\n\t}\n\tselect(items) {\n\t\tthis.selectedItems = items;\n\t\tthis.layout.select(items);\n\t}\n\tupdate() {\n\t\tconsole.log('update');\n\t\tthis.layout.update(this.state);\n\t}\n}\n","import './main';\n\nimport './core/test';\nimport './core/componentExample'; // temp\n\nimport './editor/editor';\n\n\nimport Property from './core/property';\nwindow.Property = Property;\n\nimport PropertyModel from './core/propertyType';\nwindow.PropertyModel = PropertyModel;\n\nimport { Component } from './core/component';\nwindow.Component = Component;\n"],"names":["assert","condition","message","Error","addSerializable","serializable","serializables","id","getSerializable","removeSerializable","char","CHARACTERS","Math","random","CHAR_COUNT","createStringId","threeLetterPrefix","characters","let","i","createPropertyType","propertyName","defaultValue","type","validator","validators","default","description","optionalParameters","forEach","p","validate","PropertyType","addDataType","ref","x","name","toJSON","fromJSON","createType","Object","keys","validatorName","createValidator","validatorFunction","parameters","validatorParameters","createElement","query","ns","tag","className","mode","start","length","charCodeAt","HASH","DOT","substring","slice","element","document","createElementNS","text","content","createTextNode","mount","parent","child","before","parentEl","el","childEl","__redom_list","__redom_view","isMounted","remount","insertBefore","appendChild","remounted","mounted","unmount","removeChild","unmounted","arguments$1","arguments","elcache","cloneNode","nodeType","empty","arg","textContent","j","key","value","setAttribute","cssKey","style","setChildren","children","traverse","firstChild","nextSibling","next","list","View","initData","List","this","views","lookup","serializableClasses","Map","Serializable","threeLetterType","predefinedId","serializableManager.addSerializable","delete","serializableManager.removeSerializable","toString","JSON","stringify","json","get","registerSerializable","set","initialValue","super","assign","parseFloat","isNaN","range","min","max","String","Property","propertyModel","model","modelId","defineProperty","prototype","newValue","_value","componentClasses","Component","componentData","entity","env","_properties","_componentData","constructor","propertyTypes","alive","_preInit","requirements","r","getComponent","_forEachChildComponent","c","preInit","e","console","error","_init","init","_sleep","sleep","func","Array","isArray","reservedPropertyNames","Set","reservedPrototypeMembers","register","has","k","constructorFunction","deleteFunction","Class","parentClass","properties","propertyTypeMap","category","icon","undefined","Prop","float","string","Prototype","parentId","componentDatas","getParent","nm","mom","Game","prototypes","prt","map","const","ALIVE_ERROR","Entity","components","sleeping","getComponents","addComponents","componentList","push","initComponents","makeComponentsSleep","deleteComponents","componentArray","wakeUp","clear","s","log","size","staticVariable","hiddenVariable","data","lotsOfData","variable","Position","y","howToAccessChildren","Image","property","Sound","SomeComponent","listeners","listen","event","callback","hasOwnProperty","index","indexOf","splice","dispatch","args","apply","extend","clone","bind","update","functionKey","newViews","oldViews","newLookup","oldLookup","item","view","__id","el$$1","Router","Views","route","ModuleContainer","moduleContainerName","packButtonIcon","modules","packButtonEnabled","packButton","tabs","ModuleTab","moduleElements","onclick","classList","contains","remove","this$1","add","stopPropagation","events","split","moduleClass","module","_hide","_updateTabs","unpackModuleView","_activateModule","state","m","display","activate","_show","toggle","_visible","Layout","moduleContainers","addContainer","container","mc","Module","argsArray","activateModule","moduleName","packModuleContainer","querySelectorAll","unpackModuleContainer","requestUpdate","registerPromise","then","nextPriorityNumber","registerTopButton","priority","Promise","resolve","TopBarModule","logo","src","TopButton","topButtons","propertyTypeToEditorType","PropertyModule","editor","schema","editors","field","title","from","values","componentSchema","pm","PJS","$","SceneModule","Types","addButton","search","searchIcon","jstree","game","searchTimeout","addEventListener","clearTimeout","setTimeout","trim","jstreeInited","settings","core","attr","check_callback","force_text","plugins","types","fuzzy","show_only_matches","show_only_matches_children","close_opened_onclear","on","node","get_node","obj","nodes","newParent","nodeObjects","TestModule","window","anotherGame","parse","localStorage","anotherGameJSON","Editor","setInterval","layout","selection","items","body","button","b","select","selectedItems","PropertyModel"],"mappings":"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"}