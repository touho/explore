{"version":3,"file":null,"sources":["../src/assert.js","../src/core/serializableManager.js","../src/core/serializable.js","../src/core/propertyType.js","../node_modules/redom/dist/redom.es.js","../src/core/dataTypes.js","../src/core/property.js","../src/core/component.js","../src/components/Position.js","../src/components/Test.js","../src/core/entity.js","../src/core/test.js","../src/core/componentExample.js","../src/editor/events.js","../src/editor/layout/moduleContainer.js","../src/editor/layout/layout.js","../src/editor/module/module.js","../src/editor/module/topBar.js","../src/editor/module/type.js","../src/editor/module/instance.js","../src/editor/module/scene.js","../src/editor/module/types.js","../src/editor/module/instances.js","../src/editor/module/test3.js","../src/editor/editor.js","../src/mainDev.js"],"sourcesContent":["export default function assert(condition, message) {\n\tif (!condition)\n\t\tthrow new Error(message);\n}\n","let serializables = new Map();\n\nexport function addSerializable(serializable) {\n\tif (serializables.has(serializable.id)) throw new Error('Serializable id clash!');\n\tserializables.set(serializable.id, serializable);\n}\n\nexport function getSerializable(id) {\n\treturn serializables.get(id);\n}\n\nexport function hasSerializable(id) {\n\treturn serializables.has(id);\n}\n\nexport function removeSerializable(id) {\n\tif (!serializables.delete(id))\n\t\tthrow new Error('Serializable not found!');\n}\n","import assert from '../assert';\nimport * as serializableManager from './serializableManager';\n\nconst BASE_64_CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\nconst CHAR_COUNT = BASE_64_CHARACTERS.length;\nfunction char() {\n\treturn BASE_64_CHARACTERS[Math.random() * CHAR_COUNT | 0];\n}\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i !== 0; --i)\n\t\tid += char();\n\treturn id;\n}\n\nexport default class Serializable {\n\tconstructor(threeLetterType, predefinedId = false) {\n\t\tif (predefinedId)\n\t\t\tthis.id = predefinedId;\n\t\telse\n\t\t\tthis.id = createStringId(threeLetterType);\n\n\t\tserializableManager.addSerializable(this);\n\t}\n\tdelete() {\n\t\tserializableManager.removeSerializable(this.id);\n\t}\n\ttoJSON() {\n\t\treturn {\n\t\t\tid: this.id\n\t\t};\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string');\n\t\treturn new Serializable(null, json.id);\n\t}\n}\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// info about type, validator, validatorParameters, initialValue\n\nclass PropertyType extends Serializable {\n\tconstructor(name, type, validator, initialValue) {\n\t\tassert(typeof name === 'string');\n\t\tassert(typeof type.name === 'string');\n\t\tassert(typeof validator.validate === 'function');\n\t\t\n\t\tsuper('pmo');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tname: this.name,\n\t\t\ttype: this.type.name,\n\t\t\tvalidatorName: this.validator.validatorName,\n\t\t\tvalidatorParameters: this.validator.validatorParameters,\n\t\t\tinitialValue: this.type.toJSON(this.initialValue)\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.type = null;\n\t\tthis.validator = null;\n\t}\n}\n\n/*\n\tBeautiful way of creating property types\n\t\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\nexport default function createPropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\toptionalParameters.forEach(p => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p);\n\t});\n\treturn new PropertyType(propertyName, type, validator, defaultValue);\n};\n\nexport function addDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist\n\ttoJSON = x => x,\n\tfromJSON = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\tcreatePropertyType[name] = createType;\n}\n\nfunction createValidator(name, validatorFunction) {\n\tlet validator = function() {\n\t\tlet parameters = [...arguments];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidatorParameters: parameters,\n\t\t\tvalidate: x => validatorFunction(x, ...parameters)\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nfunction createElement (query, ns) {\n  var tag;\n  var id;\n  var className;\n\n  var mode = 0;\n  var start = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n\n    if (char === HASH || char === DOT || !char) {\n      if (mode === 0) {\n        if (i === 0) {\n          tag = 'div';\n        } else if (!char) {\n          tag = query;\n        } else {\n          tag = query.substring(start, i);\n        }\n      } else {\n        var slice = query.substring(start, i);\n\n        if (mode === 1) {\n          id = slice;\n        } else if (className) {\n          className += ' ' + slice;\n        } else {\n          className = slice;\n        }\n      }\n\n      start = i + 1;\n\n      if (char === HASH) {\n        mode = 1;\n      } else {\n        mode = 2;\n      }\n    }\n  }\n\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    element.className = className;\n  }\n\n  return element;\n}\n\nfunction text (content) {\n  return document.createTextNode(content);\n}\n\nfunction mount (parent, child, before) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (childEl.__redom_list) {\n    childEl = childEl.el;\n  }\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n  if (child.isMounted) {\n    child.remount && child.remount();\n  } else {\n    child.mount && child.mount();\n  }\n  if (before) {\n    parentEl.insertBefore(childEl, before.el || before);\n  } else {\n    parentEl.appendChild(childEl);\n  }\n  if (child.isMounted) {\n    child.remounted && child.remounted();\n  } else {\n    child.isMounted = true;\n    child.mounted && child.mounted();\n  }\n}\n\nfunction unmount (parent, child) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  child.unmount && child.unmount();\n\n  parentEl.removeChild(childEl);\n\n  child.isMounted = false;\n  child.unmounted && child.unmounted();\n}\n\nvar elcache = {};\n\nfunction el (query) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (elcache[query] || (elcache[query] = createElement(query))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (arg.length) {\n      empty = false;\n      for (var j = 0; j < arg.length; j++) {\n        mount(element, arg[j]);\n      }\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style') {\n          if (typeof value === 'string') {\n            element.setAttribute(key, value);\n          } else {\n            for (var cssKey in value) {\n              element.style[cssKey] = value[cssKey];\n            }\n          }\n        } else if (key in element || typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nel.extend = function (query) {\n  var clone = (elcache[query] || (elcache[query] = createElement(query)));\n\n  return el.bind(this, clone);\n};\n\nfunction setChildren (parent, children) {\n  var parentEl = parent.el || parent;\n  var traverse = parentEl.firstChild;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = child.el || child;\n\n    if (childEl === traverse) {\n      traverse = traverse.nextSibling;\n      continue;\n    }\n\n    mount(parent, child, traverse);\n  }\n\n  while (traverse) {\n    var next = traverse.nextSibling;\n\n    unmount(parent, traverse);\n\n    traverse = next;\n  }\n}\n\nfunction list (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\nfunction List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.key = key;\n  this.initData = initData;\n  this.views = [];\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n\n  if (key) {\n    this.lookup = {};\n  }\n}\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\nList.prototype.update = function (data) {\n  if ( data === void 0 ) data = [];\n\n  var View = this.View;\n  var key = this.key;\n  var functionKey = typeof key === 'function';\n  var initData = this.initData;\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n  var newLookup = key && {};\n  var oldLookup = key && this.lookup;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (key) {\n      var id = functionKey ? key(item) : item[key];\n      view = newViews[i] = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__id = id;\n    } else {\n      view = newViews[i] = oldViews[i] || new View(initData, item, i, data);\n    }\n    var el$$1 = view.el;\n    if (el$$1.__redom_list) {\n      el$$1 = el$$1.el;\n    }\n    el$$1.__redom_view = view;\n    view.update && view.update(item, i, data);\n  }\n\n  setChildren(this, newViews);\n\n  if (key) {\n    this.lookup = newLookup;\n  }\n  this.views = newViews;\n};\n\nfunction router (parent, Views) {\n  return new Router(parent, Views);\n}\n\nvar Router = function Router (parent, Views) {\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n  this.Views = Views;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.view = View && new View();\n    this.route = route;\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data);\n};\n\nvar SVG = 'http://www.w3.org/2000/svg';\n\nvar svgcache = {};\n\nfunction svg (query, a) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (svgcache[query] || (svgcache[query] = createElement(query, SVG))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    } else if (typeof arg === 'function') {\n      arg = arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style' && typeof value !== 'string') {\n          for (var cssKey in value) {\n            element.style[cssKey] = value[cssKey];\n          }\n        } else if (typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nsvg.extend = function (query) {\n  var clone = (svgcache[query] || (svgcache[query] = createElement(query, SVG)));\n\n  return svg.bind(this, clone);\n};\n\nexport { el, list, List, mount, unmount, router, Router, setChildren, svg, text };\n","import assert from '../assert';\nimport { addDataType } from './propertyType';\n\naddDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\naddDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => String(x)\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// Instance of a property\nexport default class Property extends Serializable {\n\tconstructor(propertyModel) {\n\t\tsuper('pro');\n\t\tthis.model = propertyModel;\n\t\tthis.value = propertyModel.initialValue;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tvalue: this.type.toJSON(this.value),\n\t\t\tmodelId: this.model.id\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.model = null;\n\t}\n}\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.model.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.model.validator.validate(newValue);\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\nObject.defineProperty(Property.prototype, 'initialValue', {\n\tget() {\n\t\treturn this.model.initialValue;\n\t}\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport Property from './property';\n\nexport { default as Prop } from './propertyType';\n\nexport let componentClasses = new Map();\n\n// Instance of a component, see componentExample.js\nexport class Component extends Serializable {\n\tconstructor(componentData, entity, env) {\n\t\tsuper('com');\n\t\tthis.entity = entity;\n\t\tthis.env = env;\n\t\tthis.children = {}; // TODO: create children\n\t\tthis._properties = {};\n\t\tthis._componentData = componentData;\n\t\tthis.constructor.propertyTypes.forEach(p => {\n\t\t\tthis._properties[p.name] = new Property(p);\n\t\t});\n\t}\n\tdelete() {\n\t\tassert(!this.env.entity.alive, 'Do not call Component.delete!');\n\t\tsuper.delete();\n\t}\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], 'required component not found');\n\t\t});\n\n\t\tthis._forEachChildComponent(c => c._preInit());\n\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'preInit', e);\n\t\t}\n\t}\n\t_init() {\n\t\tthis._forEachChildComponent(c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.name, 'sleep', e);\n\t\t}\n\t\tthis._forEachChildComponent(c => c._sleep());\n\t}\n\t_forEachChildComponent(func) {\n\t\tObject.keys(this.children).forEach(key => {\n\t\t\tlet child = this.children[key];\n\t\t\tif (Array.isArray(child)) {\n\t\t\t\tchild.forEach(func);\n\t\t\t} else {\n\t\t\t\tfunc(child);\n\t\t\t}\n\t\t});\n\t}\n}\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.register = function({\n\tname = '', // required\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-bars',\n\tproperties = [],\n\trequirements = [],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {}\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Class extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction();\n\t\t}\n\t\tdelete() {\n\t\t\tsuper.delete(...arguments);\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction();\n\t\t}\n\t}\n\tObject.defineProperty(Class, 'name', { get: () => name });\n\tClass.propertyTypes = properties;\n\tClass.propertyTypeMap = new Map();\n\tClass.category = category;\n\tClass.requirements = requirements;\n\tClass.children = children;\n\tClass.description = description;\n\tClass.icon = icon;\n\tObject.assign(Class.prototype, prototype);\n\n\tClass.propertyTypes.forEach(p => {\n\t\tClass.propertyTypeMap.set(p.name, p);\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t\tassert(Class.prototype[p.name] === undefined, 'Name ' + p.name + ' clashes ');\n\t\tObject.defineProperty(Class.prototype, p.name, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[p.name].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[p.name].value = value;\n\t\t\t}\n\t\t});\n\t});\n\tcomponentClasses.set(Class.name, Class);\n\treturn Class;\n};\n","import { Component, Prop } from '../core/component';\n\nComponent.register({\n\tname: 'Position',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('x', 0.1, Prop.float),\n\t\tProp('y', 0.2, Prop.float)\n\t]\n});\n","import { Component, Prop } from '../core/component';\n\nComponent.register({\n\tname: 'Test',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('name', 'Oh right', Prop.string),\n\t\tProp('number', 666, Prop.float)\n\t]\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor() {\n\t\tsuper('ent');\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.alive = true;\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null;\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tUses addComponent internally.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet componentList = this.components.get(components[i].name) || this.components.set(components[i].name, []).get(components[i].name);\n\t\t\tcomponentList.push(components[i]);\n\t\t}\n\t\t\n\t\tif (!this.sleeping)\n\t\t\tEntity.initComponents(components);\n\t\treturn this;\n\t}\n\tstatic initComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\tsleep() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\t\t\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.makeComponentsSleep(componentArray);\n\t\t\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\twakeUp() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.initComponents(componentArray);\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\tdelete() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tsuper.delete();\n\t\tthis.alive = false;\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.deleteComponents(componentArray);\n\t\tthis.components.clear();\n\t}\n\ttoJSON() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcomponents: []\n\t\t});\n\t}\n}\n","import assert from '../assert';\n\nimport Serializable from './serializable';\n(() => {\n\tlet s = new Serializable('tes');\n\tlet id = s.id;\n\tassert(typeof id === 'string' && id.length > 10);\n\tlet json = s.toJSON();\n\tassert(json && typeof json === 'object' && typeof json.id === 'string');\n\ts.delete();\n\ts = Serializable.fromJSON(json);\n\tassert(typeof s.id === 'string' && s.id.length > 10 && s.id === id);\n\tconsole.log('Serializable tests OK');\n})();\n\nimport Entity from './entity';\n(() => {\n\tlet i = new Entity();\n\tassert(i.components.size === 0);\n\tassert(i.getComponent('moi') === null);\n\tassert(i.getComponents('moi').length === 0);\n\tconsole.log('Entity tests OK');\n})();\n\nimport PropertyType from './propertyType';\n(() => {\n\tassert(PropertyType.float.default().validate('4') === 4);\n\tassert(PropertyType.float.range(0, 1).validate(3) === 1);\n\tconsole.log('PropertyType tests OK');\n})();\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Example',\n\tdescription: 'Description of what this component does',\n\tcategory: 'Core', // You can also make up new categories.\n\ticon: 'fa-circle', // Font Awesome id\n\trequirements: ['Position'], // These shared components are autofilled. Error if component is not found.\n\tchildren: ['Image', 'Image', 'Sound'], // These private components are also autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('variable', 0.5, Prop.float, Prop.float.range(0, 1), 'Description of the property'),\n\t\tProp('otherVar_iaerfperfjoierj', 'Hello', Prop.string, 'Description of the property')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tstaticVariable: 'Example class info',\n\t\tconstructor() {\n\t\t\t// This will be called once, when creating the component\n\t\t\tthis.hiddenVariable = 3;\n\t\t},\n\t\tpreInit() {\n\t\t\t// preInit is called for every component before any component is inited with init(). Children are already preInited here.\n\t\t\tthis.data = {\n\t\t\t\tlotsOfData: 123 + this.variable + this.hiddenVariable\n\t\t\t};\n\t\t},\n\t\tinit() {\n\t\t\t// All the components of this entity has been preInited. You can use them. Children are already inited here.\n\t\t\tthis.Position.x = this.Position.y + 1;\n\n\t\t\tthis.howToAccessChildren = [\n\t\t\t\tthis.children.Image[0].property,\n\t\t\t\tthis.children.Sound.property\n\t\t\t];\n\n\t\t\tthis.SomeComponent = this.entity.getComponent('SomeComponent');\n\t\t},\n\t\tsleep() {\n\t\t\t// Release all the data created in preInit and init\n\t\t\tthis.data = null;\n\t\t\tthis.SomeComponent = null;\n\t\t\tthis.howToAccessChildren = null;\n\t\t\t// Position component is automatically released because it is a requirement.\n\t\t},\n\t\tdelete() {\n\t\t\t// This will be called once, when component stops existing\n\t\t}\n\t}\n});\n","/*\n Global event system\n\n let unlisten = events.listen('event name', function(params, ...) {});\n eventManager.dispatch('event name', paramOrParamArray);\n unlisten();\n */\n\nlet listeners = {};\n\nexport default {\n\tlisten(event, callback) {\n\t\tif (!listeners.hasOwnProperty(event)) {\n\t\t\tlisteners[event] = [];\n\t\t}\n\t\tlisteners[event].push(callback);\n\t\treturn () => {\n\t\t\tvar index = listeners[event].indexOf(callback);\n\t\t\tlisteners[event].splice(index, 1);\n\t\t};\n\t},\n\tdispatch(event, args) {\n\t\tif (listeners.hasOwnProperty(event)) {\n\t\t\tif (!Array.isArray(args)) args = [args];\n\n\t\t\tfor (var i = 0; i < listeners[event].length; ++i) {\n\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t/*\n\t\t\t\ttry {\n\t\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (console && console.error) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t}\n};\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class ModuleContainer {\n\tconstructor(moduleContainerName = 'unknownClass.anotherClass', packButtonIcon = 'fa-chevron-left') {\n\t\t\n\t\tthis.modules = [];\n\t\tthis.packButtonEnabled = !!packButtonIcon;\n\t\tthis.el = el(`div.moduleContainer.packable.${moduleContainerName}`,\n\t\t\tthis.packButton = packButtonIcon && el(`i.packButton.button.iconButton.fa.${packButtonIcon}`),\n\t\t\tthis.tabs = list('div.tabs', ModuleTab),\n\t\t\tthis.moduleElements = el('div.moduleElements')\n\t\t);\n\t\tif (packButtonIcon) {\n\t\t\tthis.el.onclick = () => this.el.classList.contains('packed') && this.el.classList.remove('packed');\n\t\t\tthis.packButton.onclick = e => {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\n\t\tevents.listen('registerModule_' + moduleContainerName.split('.')[0], moduleClass => {\n\t\t\tlet module = new moduleClass();\n\t\t\tmodule.el.classList.add('module-' + module.id);\n\t\t\tthis.modules.push(module);\n\t\t\tif (this.modules.length !== 1) {\n\t\t\t\tmodule._hide();\n\t\t\t}\n\t\t\tmount(this.moduleElements, module.el);\n\t\t\tthis._updateTabs();\n\t\t\t\n\t\t\tevents.listen('activateModule_' + module.id, (unpackModuleView = true, ...args) => {\n\t\t\t\tif (unpackModuleView)\n\t\t\t\t\tthis.el.classList.remove('packed');\n\t\t\t\tthis._activateModule(module, args);\n\t\t\t});\n\t\t});\n\t\tthis._updateTabs();\n\t}\n\tupdate(state) {\n\t\tstate = state || {};\n\t\tthis.modules.forEach(m => m.update(state));\n\t}\n\t_updateTabs() {\n\t\tif (!this.tabs) return;\n\t\t\n\t\tthis.tabs.update(this.modules);\n\t\t\n\t\tif (!this.packButtonEnabled && this.modules.length <= 1)\n\t\t\tthis.tabs.el.style.display = 'none';\n\t\telse\n\t\t\tthis.tabs.el.style.display = 'block';\n\t}\n\t_activateModule(module, args) {\n\t\tlet idx = this.modules.indexOf(module);\n\t\tthis.modules.forEach(m => {\n\t\t\tif (m !== module) {\n\t\t\t\tm._hide();\n\t\t\t}\n\t\t});\n\t\tmodule.activate(...args);\n\t\tmodule._show();\n\t\tthis._updateTabs();\n\t\t\n\t\t/*\n\t\tthis.modules.splice(idx, 1);\n\t\tthis.modules.unshift(module);\n\t\tthis._updateTabs();\n\t\tfor (let i = 1; i < this.modules.length; i++) {\n\t\t\tthis.modules[i].el.style.display = 'none';\n\t\t}\n\t\tmodule.activate(...args);\n\t\tmodule.el.style.display = 'block';\n\t\t*/\n\t}\n}\n\nclass ModuleTab {\n\tconstructor() {\n\t\tthis.el = el('span.moduleTab.button');\n\t\tthis.module = null;\n\t\tthis.el.onclick = () => {\n\t\t\tevents.dispatch('activateModule_' + this.module.id);\n\t\t};\n\t}\n\tupdate(module) {\n\t\tthis.module = module;\n\t\tthis.el.textContent = module.name;\n\t\tthis.el.classList.toggle('active', module._visible);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport ModuleContainer from './moduleContainer';\n\nexport default class Layout {\n\tconstructor() {\n\t\tthis.moduleContainers = [];\n\t\tlet addContainer = (...args) => {\n\t\t\tlet container = new ModuleContainer(...args);\n\t\t\tthis.moduleContainers.push(container);\n\t\t\treturn container;\n\t\t}\n\t\tthis.el = el('div.editorLayout',\n\t\t\tel('div.nonRight',\n\t\t\t\taddContainer('top', null),\n\t\t\t\tel('div.middle',\n\t\t\t\t\taddContainer('left', 'fa-chevron-left'),\n\t\t\t\t\taddContainer('center', null)\n\t\t\t\t),\n\t\t\t\taddContainer('bottom', 'fa-chevron-down')\n\t\t\t),\n\t\t\taddContainer('right', 'fa-chevron-right')\n\t\t);\n\t}\n\tupdate(state) {\n\t\tthis.moduleContainers.forEach(mc => mc.update(state));\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class Module {\n\tconstructor() {\n\t\tthis.name = this.name || 'Module';\n\t\tthis.id = this.id || 'module';\n\t\tthis.el = el('div.module', ...arguments);\n\t\tthis._visible = true;\n\t}\n\t// Called when this module is opened. Other modules can call Module.activateModule('Module', ...args);\n\tactivate() {\n\t}\n\t// Called when state of editor changes\n\tupdate(state) {\n\t}\n\t_show() {\n\t\tthis.el.classList.remove('hidden');\n\t\tthis._visible = true;\n\t}\n\t_hide() {\n\t\tthis.el.classList.add('hidden');\n\t\tthis._visible = false;\n\t}\n}\n//arguments: moduleName, unpackModuleView=true, ...args \nModule.activateModule = function(moduleName, unpackModuleView=true, ...args) {\n\tevents.dispatch('activateModule_' + moduleName, [unpackModuleView, ...args]);\n};\nModule.packModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.add('packed');\n};\nModule.unpackModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.remove('packed');\n};\nModule.requestUpdate = function() {\n\tevents.dispatch('requestUpdate');\n};\n\n// moduleContainerName = left | middle | right | bottom\nModule.register = function(moduleClass, moduleContainerName) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerModule_' + moduleContainerName, [moduleClass]);\n\t});\n};\n\nlet nextPriorityNumber = 1;\nModule.registerTopButton = function(text, icon, func, priority = nextPriorityNumber++) {\n\tregisterPromise = registerPromise.then(() => {\n\t\tevents.dispatch('registerTopButton', [text, icon, func, priority]);\n\t});\n};\n\n\nlet registerPromise = new Promise(function(resolve) {\n\tevents.listen('registerModules', function() {\n\t\tregisterPromise.then(() => {\n\t\t\tevents.dispatch('modulesRegistered');\n\t\t});\n\t\tresolve();\n\t});\n});\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nexport class TopBarModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.logo = el('img.logo.button.iconButton', { src: '../img/logo_reflection_medium.png' }),\n\t\t\tthis.list = list('div.buttonContainer', TopButton)\n\t\t);\n\t\tthis.id = 'topbar';\n\t\tthis.name = 'TopBar'; // not visible\n\t}\n\tupdate(state) {\n\t\tthis.list.update(state.topButtons);\n\t}\n}\nModule.register(TopBarModule, 'top');\n\nModule.registerTopButton('Bell Types', 'fa fa-bell-o', () => { \n\tModule.unpackModuleContainer('bottom');\n\tModule.activateModule('types');\n\tModule.activateModule('type');\n}, 1);\nModule.registerTopButton('Cube Instances', 'fa fa-cubes', () => {\n\tModule.activateModule('instances');\n\tModule.activateModule('instance');\n}, 2);\n\nexport class TopButton {\n\tconstructor() {\n\t\tthis.el = el('div.button.topIconTextButton',\n\t\t\tel('div.topIconTextButtonContent',\n\t\t\t\tthis.icon = el('i.fa'),\n\t\t\t\tthis.text = el('span')\n\t\t\t)\n\t\t)\n\t\tthis.el.onclick = () => {\n\t\t\tthis.callback && this.callback();\n\t\t}\n\t\tthis.callback = null;\n\t}\n\tupdate(state) {\n\t\tthis.icon.className = state.icon;\n\t\tthis.text.textContent = state.text;\n\t\tthis.callback = state.func;\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.editor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.id = 'type';\n\t\tthis.name = 'Type';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t\tthis.componentClasses = state.componentClasses; \n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c.propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc.propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\t\t\n\t\tnew PJS($(this.editor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.editor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.id = 'instance';\n\t\tthis.name = 'Instance';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t\tthis.componentClasses = state.componentClasses;\n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c.propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc.propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\n\t\tnew PJS($(this.editor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass SceneModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test')\n\t\t);\n\t\tthis.id = 'scene';\n\t\tthis.name = 'Scene';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(SceneModule, 'center');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'List of prototypes')\n\t\t);\n\t\tthis.id = 'types';\n\t\tthis.name = 'Types';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'List of instances on the scene')\n\t\t);\n\t\tthis.name = 'Instances';\n\t\tthis.id = 'instances';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'This is test 3')\n\t\t);\n\t\tthis.id = 'test';\n\t\tthis.name = 'Test3';\n\t}\n\tupdate(state) {\n\t\tsuper.update(state);\n\t}\n}\n\nModule.register(TestModule, 'bottom');\n","import events from './events';\nimport Layout from './layout/layout';\nimport './module/topBar';\nimport './module/type';\nimport './module/instance';\nimport './module/scene';\nimport './module/types';\nimport './module/instances';\nimport './module/test3';\nimport { el, list, mount } from 'redom';\n\nimport { componentClasses } from '../core/component';\n\nwindow.addEventListener('load', () => {\n\teditor = new Editor();\n\tevents.dispatch('registerModules');\n});\nevents.listen('modulesRegistered', () => {\n\teditor.update();\n\tevents.dispatch('loaded');\n});\n\nlet editor = null;\nclass Editor {\n\tconstructor() {\n\t\tthis.layout = new Layout();\n\t\t\n\t\tthis.state = {\n\t\t\ttopButtons: [],\n\t\t\tselection: {\n\t\t\t\ttype: 'none',\n\t\t\t\titems: []\n\t\t\t},\n\t\t\tcomponentClasses\n\t\t};\n\n\t\tmount(document.body, this.layout);\n\t\t\n\t\tevents.listen('registerTopButton', (text, icon, func, priority) => {\n\t\t\tlet button = { icon, text, func, priority };\n\t\t\tlet i = 0;\n\t\t\tlet topButtons = this.state.topButtons;\n\t\t\twhile (i < topButtons.length) {\n\t\t\t\tlet b = topButtons[i];\n\t\t\t\tif (b.priority > priority) {\n\t\t\t\t\ttopButtons.splice(i, 0, button);\n\t\t\t\t\ti = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i >= 0) topButtons.push(button);\n\t\t});\n\t\t\n\t\tevents.listen('requestUpdate', () => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\tselect(items) {\n\t\tthis.selectedItems = items;\n\t\tthis.layout.select(items);\n\t}\n\tupdate() {\n\t\tthis.layout.update(this.state);\n\t}\n}\n","import './main';\n\nimport './core/test';\nimport './core/componentExample'; // temp\n\nimport './editor/editor';\n\n\nimport Property from './core/property';\nwindow.Property = Property;\n\nimport PropertyModel from './core/propertyType';\nwindow.PropertyModel = PropertyModel;\n\nimport { Component } from './core/component';\nwindow.Component = Component;\n"],"names":["assert","condition","message","Error","addSerializable","serializable","serializables","has","id","set","removeSerializable","delete","char","BASE_64_CHARACTERS","Math","random","CHAR_COUNT","createStringId","threeLetterPrefix","characters","let","i","createPropertyType","propertyName","defaultValue","type","validator","validators","default","description","optionalParameters","forEach","p","validate","PropertyType","addDataType","ref","x","name","toJSON","fromJSON","createType","Object","keys","validatorName","createValidator","validatorFunction","parameters","validatorParameters","createElement","query","ns","tag","className","mode","start","length","charCodeAt","HASH","DOT","substring","slice","element","document","createElementNS","text","content","createTextNode","mount","parent","child","before","parentEl","el","childEl","__redom_list","__redom_view","isMounted","remount","insertBefore","appendChild","remounted","mounted","unmount","removeChild","unmounted","arguments$1","arguments","elcache","cloneNode","nodeType","empty","arg","textContent","j","key","value","setAttribute","cssKey","style","setChildren","children","traverse","firstChild","nextSibling","next","list","View","initData","List","this","views","lookup","Map","Serializable","threeLetterType","predefinedId","serializableManager.addSerializable","serializableManager.removeSerializable","toString","JSON","stringify","json","initialValue","super","assign","parseFloat","isNaN","range","min","max","String","Property","propertyModel","model","modelId","defineProperty","prototype","get","newValue","_value","componentClasses","Component","componentData","entity","env","_properties","_componentData","constructor","propertyTypes","alive","_preInit","requirements","r","getComponent","_forEachChildComponent","c","preInit","e","console","error","_init","init","_sleep","sleep","func","Array","isArray","reservedPropertyNames","Set","reservedPrototypeMembers","register","k","constructorFunction","deleteFunction","Class","parentClass","properties","propertyTypeMap","category","icon","undefined","Prop","float","string","const","ALIVE_ERROR","Entity","components","sleeping","getComponents","addComponents","componentList","push","initComponents","makeComponentsSleep","deleteComponents","componentArray","wakeUp","clear","s","log","size","staticVariable","hiddenVariable","data","lotsOfData","variable","Position","y","howToAccessChildren","Image","property","Sound","SomeComponent","listeners","listen","event","callback","hasOwnProperty","index","indexOf","splice","dispatch","args","apply","extend","clone","bind","update","functionKey","newViews","oldViews","newLookup","oldLookup","item","view","__id","el$$1","Router","Views","route","ModuleContainer","moduleContainerName","packButtonIcon","modules","packButtonEnabled","packButton","tabs","ModuleTab","moduleElements","onclick","classList","contains","remove","this$1","add","stopPropagation","events","split","moduleClass","module","_hide","_updateTabs","unpackModuleView","_activateModule","state","m","display","activate","_show","toggle","_visible","Layout","moduleContainers","addContainer","container","mc","Module","argsArray","activateModule","moduleName","packModuleContainer","querySelectorAll","unpackModuleContainer","requestUpdate","registerPromise","then","nextPriorityNumber","registerTopButton","priority","Promise","resolve","TopBarModule","logo","src","TopButton","topButtons","propertyTypeToEditorType","PropertyModule","editor","schema","editors","field","title","from","values","componentSchema","map","pm","PJS","$","SceneModule","TestModule","window","addEventListener","Editor","layout","selection","items","body","button","b","select","selectedItems","PropertyModel"],"mappings":"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"}