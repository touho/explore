{"version":3,"file":null,"sources":["../src/assert.js","../src/core/serializableManager.js","../src/core/serializable.js","../src/core/propertyType.js","../node_modules/redom/dist/redom.es.js","../src/core/property.js","../src/core/dataTypes.js","../src/core/propertyOwner.js","../src/core/component.js","../src/game/components/Position.js","../src/game/components/Test.js","../src/core/prototype.js","../src/game/game.js","../src/core/entity.js","../src/core/test.js","../src/core/componentExample.js","../src/editor/events.js","../src/editor/layout/moduleContainer.js","../src/editor/layout/layout.js","../src/editor/module/module.js","../src/editor/module/topBar.js","../src/editor/views/propertyEditor.js","../src/editor/module/type.js","../src/editor/module/instance.js","../src/editor/module/scene.js","../src/editor/module/types.js","../src/editor/module/instances.js","../src/editor/module/test3.js","../src/editor/editor.js","../src/mainDev.js"],"sourcesContent":["export default function assert(condition, message) {\n\tif (!condition)\n\t\tthrow new Error(message);\n}\n","let serializables = {};\n\nexport function addSerializable(serializable) {\n\tif (serializables[serializable.id]) throw new Error('Serializable id clash!');\n\tserializables[serializable.id] = serializable;\n}\n\nexport function getSerializable(id) {\n\treturn serializables[id] || null;\n}\n\nexport function hasSerializable(id) {\n\treturn Boolean(serializables[id]);\n}\n\nexport function removeSerializable(id) {\n\tif (serializables[id])\n\t\tdelete serializables[id];\n\telse\n\t\tthrow new Error('Serializable not found!');\n}\n","import assert from '../assert';\nimport * as serializableManager from './serializableManager';\n\nconst CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'; // 62 chars\nconst CHAR_COUNT = CHARACTERS.length;\nfunction char() {\n\treturn CHARACTERS[Math.random() * CHAR_COUNT | 0];\n}\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i !== 0; --i)\n\t\tid += char();\n\treturn id;\n}\n\nlet serializableClasses = new Map();\n\nexport default class Serializable {\n\tconstructor(predefinedId = false) {\n\t\t// defined in prototype\n\t\t// this._dirty = true;\n\t\t// this._parent = null;\n\t\t\n\t\tassert(this._threeLetterType, 'Forgot to Serializable.registerSerializable your class?');\n\t\tthis._children = new Map(); // threeLetterType -> array\n\t\tthis.id = predefinedId || createStringId(this._threeLetterType);\n\t\tif (this.id.startsWith('?'))\n\t\t\tthrow new Error('?');\n\t\tserializableManager.addSerializable(this);\n\t}\n\tdelete() {\n\t\tif (this._parent) {\n\t\t\tthis._parent.deleteChild(this);\n\t\t\treturn;\n\t\t}\n\t\tthis._children.forEach(array => {\n\t\t\tarray.forEach(child => {\n\t\t\t\tchild._parent = null;\n\t\t\t\tchild.delete();\n\t\t\t});\n\t\t});\n\t\tthis._children.clear();\n\t\tserializableManager.removeSerializable(this.id);\n\t}\n\taddChildren(children) {\n\t\tfor (let i = 0; i < children.length; i++)\n\t\t\tthis.addChild(children[i]);\n\t\treturn this;\n\t}\n\taddChild(child) {\n\t\tlet array = this._children.get(child._threeLetterType);\n\t\tif (array === undefined) {\n\t\t\tarray = [];\n\t\t\tthis._children.set(child._threeLetterType, array);\n\t\t}\n\t\tarray.push(child);\n\t\tchild._parent = this;\n\t\treturn this;\n\t}\n\tfindChild(threeLetterType, filterFunction) {\n\t\tlet array = this._children.get(threeLetterType);\n\t\treturn array && array.find(filterFunction) || null;\n\t}\n\tgetChildrenByType(threeLetterType)Â {\n\t\treturn this._children.get(threeLetterType) || [];\n\t}\n\tdeleteChild(child) {\n\t\tthis.detachChild(child);\n\t\tchild.delete();\n\t\treturn this;\n\t}\n\tdetachChild(child) {\n\t\tlet array = this._children.get(child._threeLetterType);\n\t\tlet idx = array.indexOf(child);\n\t\tassert(idx >= 0, 'child not found');\n\t\tarray.splice(idx, 1);\n\t\tchild._parent = null;\n\t\treturn this;\n\t}\n\tforEachChild(threeLetterType = null, callback, deep = false) {\n\t\tfunction processArray(array) {\n\t\t\tarray.forEach(child => {\n\t\t\t\tcallback(child);\n\t\t\t\tdeep && child.forEachChild(threeLetterType, callback, true);\n\t\t\t});\n\t\t}\n\t\tif (threeLetterType) {\n\t\t\tprocessArray(this._children.get(threeLetterType) || []);\n\t\t} else {\n\t\t\tthis._children.forEach(processArray);\n\t\t}\n\t}\n\tdetach() {\n\t\tthis._parent && this._parent.detachChild(this);\n\t\treturn this;\n\t}\n\tgetParent() {\n\t\treturn this._parent || null;\n\t}\n\tgetChildren(threeLetterType) {\n\t\treturn this._children.get(threeLetterType) || [];\n\t}\n\ttoJSON() {\n\t\tlet json = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this._children.size > 0) {\n\t\t\tlet arrays = [];\n\t\t\tthis._children.forEach(child => arrays.push(child));\n\t\t\tjson.c = [].concat(...arrays);\n\t\t}\n\t\treturn json;\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tmarkDirty() {\n\t\tthis._dirty = true;\n\t\tthis._parent && this._parent.markDirty();\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string' && json.id.length > 3);\n\t\tlet fromJSON = serializableClasses.get(json.id.substring(0, 3));\n\t\tassert(fromJSON);\n\t\tlet obj = fromJSON(json);\n\t\tobj.addChildren(json.c ? json.c.map(child => Serializable.fromJSON(child)) : []);\n\t\treturn obj;\n\t}\n\tstatic registerSerializable(Class, threeLetterType, fromJSON = null) {\n\t\tClass.prototype._threeLetterType = threeLetterType;\n\t\tassert(typeof threeLetterType === 'string' && threeLetterType.length === 3);\n\t\tif (!fromJSON)\n\t\t\tfromJSON = json => new Class(json.id);\n\t\tserializableClasses.set(threeLetterType, fromJSON);\n\t}\n}\nSerializable.prototype._dirty = true;\nSerializable.prototype._parent = null;\n","import assert from '../assert';\nimport Property from './property';\n\n// info about type, validator, validatorParameters, initialValue\n\n\n\nclass PropertyType {\n\tconstructor(name, type, validator, initialValue) {\n\t\tassert(typeof name === 'string');\n\t\tassert(type && typeof type.name === 'string');\n\t\tassert(validator && typeof validator.validate === 'function');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t}\n\tcreateProperty({ value, predefinedId } = {}) {\n\t\treturn new Property({\n\t\t\tpropertyType: this,\n\t\t\tvalue,\n\t\t\tpredefinedId,\n\t\t\tname: this.name\n\t\t});\n\t}\n}\n\n/*\n\tBeautiful way of creating property types\n\t\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\nexport default function createPropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\toptionalParameters.forEach(p => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p);\n\t});\n\treturn new PropertyType(propertyName, type, validator, defaultValue);\n};\n\nexport function addDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist\n\ttoJSON = x => x,\n\tfromJSON = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\tcreatePropertyType[name] = createType;\n}\n\nfunction createValidator(name, validatorFunction) {\n\tlet validator = function() {\n\t\tlet parameters = [...arguments];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidatorParameters: parameters,\n\t\t\tvalidate: x => validatorFunction(x, ...parameters)\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","var HASH = '#'.charCodeAt(0);\nvar DOT = '.'.charCodeAt(0);\n\nfunction createElement (query, ns) {\n  var tag;\n  var id;\n  var className;\n\n  var mode = 0;\n  var start = 0;\n\n  for (var i = 0; i <= query.length; i++) {\n    var char = query.charCodeAt(i);\n\n    if (char === HASH || char === DOT || !char) {\n      if (mode === 0) {\n        if (i === 0) {\n          tag = 'div';\n        } else if (!char) {\n          tag = query;\n        } else {\n          tag = query.substring(start, i);\n        }\n      } else {\n        var slice = query.substring(start, i);\n\n        if (mode === 1) {\n          id = slice;\n        } else if (className) {\n          className += ' ' + slice;\n        } else {\n          className = slice;\n        }\n      }\n\n      start = i + 1;\n\n      if (char === HASH) {\n        mode = 1;\n      } else {\n        mode = 2;\n      }\n    }\n  }\n\n  var element = ns ? document.createElementNS(ns, tag) : document.createElement(tag);\n\n  if (id) {\n    element.id = id;\n  }\n\n  if (className) {\n    element.className = className;\n  }\n\n  return element;\n}\n\nfunction text (content) {\n  return document.createTextNode(content);\n}\n\nfunction mount (parent, child, before) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (childEl.__redom_list) {\n    childEl = childEl.el;\n  }\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  if (child !== childEl) {\n    childEl.__redom_view = child;\n  }\n  if (child.isMounted) {\n    child.remount && child.remount();\n  } else {\n    child.mount && child.mount();\n  }\n  if (before) {\n    parentEl.insertBefore(childEl, before.el || before);\n  } else {\n    parentEl.appendChild(childEl);\n  }\n  if (child.isMounted) {\n    child.remounted && child.remounted();\n  } else {\n    child.isMounted = true;\n    child.mounted && child.mounted();\n  }\n}\n\nfunction unmount (parent, child) {\n  var parentEl = parent.el || parent;\n  var childEl = child.el || child;\n\n  if (child === childEl && childEl.__redom_view) {\n    // try to look up the view if not provided\n    child = childEl.__redom_view;\n  }\n\n  child.unmount && child.unmount();\n\n  parentEl.removeChild(childEl);\n\n  child.isMounted = false;\n  child.unmounted && child.unmounted();\n}\n\nvar elcache = {};\n\nfunction el (query) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (elcache[query] || (elcache[query] = createElement(query))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    }\n\n    // support middleware\n    if (typeof arg === 'function') {\n      arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (arg.length) {\n      empty = false;\n      for (var j = 0; j < arg.length; j++) {\n        mount(element, arg[j]);\n      }\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style') {\n          if (typeof value === 'string') {\n            element.setAttribute(key, value);\n          } else {\n            for (var cssKey in value) {\n              element.style[cssKey] = value[cssKey];\n            }\n          }\n        } else if (key in element || typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nel.extend = function (query) {\n  var clone = (elcache[query] || (elcache[query] = createElement(query)));\n\n  return el.bind(this, clone);\n};\n\nfunction setChildren (parent, children) {\n  var parentEl = parent.el || parent;\n  var traverse = parentEl.firstChild;\n\n  for (var i = 0; i < children.length; i++) {\n    var child = children[i];\n\n    if (!child) {\n      continue;\n    }\n\n    var childEl = child.el || child;\n\n    if (childEl === traverse) {\n      traverse = traverse.nextSibling;\n      continue;\n    }\n\n    mount(parent, child, traverse);\n  }\n\n  while (traverse) {\n    var next = traverse.nextSibling;\n\n    unmount(parent, traverse);\n\n    traverse = next;\n  }\n}\n\nfunction list (parent, View, key, initData) {\n  return new List(parent, View, key, initData);\n}\n\nfunction List (parent, View, key, initData) {\n  this.__redom_list = true;\n  this.View = View;\n  this.key = key;\n  this.initData = initData;\n  this.views = [];\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n\n  if (key) {\n    this.lookup = {};\n  }\n}\n\nList.extend = function (parent, View, key, initData) {\n  return List.bind(List, parent, View, key, initData);\n};\n\nlist.extend = List.extend;\n\nList.prototype.update = function (data) {\n  if ( data === void 0 ) data = [];\n\n  var View = this.View;\n  var key = this.key;\n  var functionKey = typeof key === 'function';\n  var initData = this.initData;\n  var newViews = new Array(data.length);\n  var oldViews = this.views;\n  var newLookup = key && {};\n  var oldLookup = key && this.lookup;\n\n  for (var i = 0; i < data.length; i++) {\n    var item = data[i];\n    var view = (void 0);\n\n    if (key) {\n      var id = functionKey ? key(item) : item[key];\n      view = newViews[i] = oldLookup[id] || new View(initData, item, i, data);\n      newLookup[id] = view;\n      view.__id = id;\n    } else {\n      view = newViews[i] = oldViews[i] || new View(initData, item, i, data);\n    }\n    var el$$1 = view.el;\n    if (el$$1.__redom_list) {\n      el$$1 = el$$1.el;\n    }\n    el$$1.__redom_view = view;\n    view.update && view.update(item, i, data);\n  }\n\n  setChildren(this, newViews);\n\n  if (key) {\n    this.lookup = newLookup;\n  }\n  this.views = newViews;\n};\n\nfunction router (parent, Views) {\n  return new Router(parent, Views);\n}\n\nvar Router = function Router (parent, Views) {\n  this.el = typeof parent === 'string' ? el(parent) : parent;\n  this.Views = Views;\n};\nRouter.prototype.update = function update (route, data) {\n  if (route !== this.route) {\n    var Views = this.Views;\n    var View = Views[route];\n\n    this.view = View && new View();\n    this.route = route;\n\n    setChildren(this.el, [ this.view ]);\n  }\n  this.view && this.view.update && this.view.update(data);\n};\n\nvar SVG = 'http://www.w3.org/2000/svg';\n\nvar svgcache = {};\n\nfunction svg (query, a) {\n  var arguments$1 = arguments;\n\n  var element;\n\n  if (typeof query === 'string') {\n    element = (svgcache[query] || (svgcache[query] = createElement(query, SVG))).cloneNode(false);\n  } else if (query && query.nodeType) {\n    element = query.cloneNode(false);\n  } else {\n    throw new Error('At least one argument required');\n  }\n\n  var empty = true;\n\n  for (var i = 1; i < arguments.length; i++) {\n    var arg = arguments$1[i];\n\n    if (!arg) {\n      continue;\n    } else if (typeof arg === 'function') {\n      arg = arg(element);\n    } else if (typeof arg === 'string' || typeof arg === 'number') {\n      if (empty) {\n        empty = false;\n        element.textContent = arg;\n      } else {\n        element.appendChild(text(arg));\n      }\n    } else if (arg.nodeType || (arg.el && arg.el.nodeType)) {\n      empty = false;\n      mount(element, arg);\n    } else if (typeof arg === 'object') {\n      for (var key in arg) {\n        var value = arg[key];\n\n        if (key === 'style' && typeof value !== 'string') {\n          for (var cssKey in value) {\n            element.style[cssKey] = value[cssKey];\n          }\n        } else if (typeof value === 'function') {\n          element[key] = value;\n        } else {\n          element.setAttribute(key, value);\n        }\n      }\n    }\n  }\n\n  return element;\n}\n\nsvg.extend = function (query) {\n  var clone = (svgcache[query] || (svgcache[query] = createElement(query, SVG)));\n\n  return svg.bind(this, clone);\n};\n\nexport { el, list, List, mount, unmount, router, Router, setChildren, svg, text };\n","import Serializable from './serializable';\nimport assert from '../assert';\n\n// Instance of a property\nexport default class Property extends Serializable {\n\tconstructor({ value, predefinedId, name, propertyType }) {\n\t\tassert(name, 'Property without a name can not exist');\n\t\tsuper(predefinedId);\n\t\tthis._initialValue = value;\n\t\tif (propertyType)\n\t\t\tthis.setPropertyType(propertyType);\n\t\telse\n\t\t\tthis.name = name;\n\t}\n\tsetPropertyType(propertyType) {\n\t\tthis.propertyType = propertyType;\n\t\tthis.value = this._initialValue !== undefined ? this._initialValue : propertyType.initialValue;\n\t\tthis.name = propertyType.name;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tv: this.type.toJSON(this.value),\n\t\t\tn: this.propertyType.name\n\t\t});\n\t}\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis.model = null;\n\t}\n}\nProperty.prototype.propertyType = null;\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.propertyType.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.propertyType.validator.validate(newValue);\n\t\tthis.markDirty();\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\nProperty.fromJSON = function(json) {\n\treturn {\n\t\tvalue: json.v,\n\t\tpredefinedId: json.id\n\t};\n};\nSerializable.registerSerializable(Property, 'prp', json => {\n\treturn new Property({\n\t\tvalue: json.v,\n\t\tpredefinedId: json.id,\n\t\tname: json.n\n\t});\n});\n","import assert from '../assert';\nimport { addDataType } from './propertyType';\n\naddDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tassert(!isNaN(x), 'invalid float: ' + x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\naddDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => x ? String(x) : ''\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport { getSerializable } from './serializableManager';\nexport { default as Prop } from './propertyType';\n\nexport default class PropertyOwner extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tassert(Array.isArray(this.constructor._propertyTypes), 'call PropertyOwner.defineProperties after class definition');\n\t\tsuper(predefinedId);\n\t\tthis._properties = {};\n\t\t\n\t\t/*\n\t\tlet properties = children.filter(child => child._threeLetterType === 'prp');\n\n\t\tproperties.forEach(prop => {\n\t\t\tif (!prop.propertyType) {\n\t\t\t\tif (prop.name) {\n\t\t\t\t\tprop.setPropertyType(this.constructor._propertyTypesByName[prop.name]);\n\t\t\t\t} else {\n\t\t\t\t\tassert(false, 'property does not have propertyType nor name');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t\tthis._properties = {};\n\t\tlet givenPropertiesMap = {};\n\t\tfor (let i = 0; i < properties.length; i++)\n\t\t\tgivenPropertiesMap[properties[i].propertyType.name] = properties[i];\n\n\t\tthis.constructor._propertyTypes.forEach(propertyType => {\n\t\t\tlet property = givenPropertiesMap[propertyType.name] || propertyType.createProperty();\n\t\t\tclassInstance._properties[propertyType.name] = property;\n\t\t\tclassInstance.addChild(property);\n\t\t});\n\t\t*/\n\t}\n\t// Just a helper\n\tinitWithPropertyValues(values = {}) {\n\t\tlet children = [];\n\t\t\n\t\tObject.keys(values).forEach(propName => {\n\t\t\tlet propertyType = this.constructor._propertyTypesByName[propName];\n\t\t\tassert(propertyType, 'Invalid property ' + propName);\n\t\t\tchildren.push(propertyType.createProperty({\n\t\t\t\tvalue: values[propName]\n\t\t\t}));\n\t\t});\n\t\tthis.addChildren(children);\n\t\treturn this;\n\t}\n\taddChildren(children = []) {\n\t\tthis._addChildrenCalled = true;\n\t\tlet propChildren = [];\n\t\tlet otherChildren = [];\n\t\t// Separate Property children and other children\n\t\tchildren.forEach(child => {\n\t\t\tif (child._threeLetterType === 'prp') {\n\t\t\t\tpropChildren.push(child);\n\t\t\t} else {\n\t\t\t\totherChildren.push(child);\n\t\t\t}\n\t\t});\n\t\tsuper.addChildren(otherChildren);\n\t\tif (propChildren.length === 0) return;\n\t\t\n\t\tlet invalidPropertiesCount = 0;\n\t\t\n\t\t// Make sure Properties have a PropertyType. They don't work without it.\n\t\tpropChildren.filter(prop => !prop.propertyType).forEach(prop => {\n\t\t\tif (!this.constructor._propertyTypesByName[prop.name]) {\n\t\t\t\tconsole.log('Property of that name not defined', this.id, prop.name, this);\n\t\t\t\tinvalidPropertiesCount++;\n\t\t\t\tprop.isInvalid = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tprop.setPropertyType(this.constructor._propertyTypesByName[prop.name]);\n\t\t});\n\t\tif (invalidPropertiesCount)\n\t\t\tpropChildren = propChildren.filter(p => !p.isInvalid);\n\t\t\n\t\t// Make sure all PropertyTypes have a matching Property\n\t\tlet nameToProp = {};\n\t\tpropChildren.forEach(c => nameToProp[c.name] = c);\n\t\tthis.constructor._propertyTypes.forEach(propertyType => {\n\t\t\tif (!nameToProp[propertyType.name])\n\t\t\t\tpropChildren.push(propertyType.createProperty());\n\t\t});\n\t\t\n\t\tsuper.addChildren(propChildren);\n\t};\n\taddChild(child) {\n\t\tassert(this._addChildrenCalled, this.constructor.name + ' requires that addChildren will be called before addChild');\n\t\tsuper.addChild(child);\n\t\tif (child._threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.constructor._propertyTypesByName[child.name]) {\n\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.constructor._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t\tassert(this._properties[child.propertyType.name] === undefined, 'Property already added');\n\t\t\tthis._properties[child.propertyType.name] = child;\n\t\t}\n\t};\n\tdelete() {\n\t\tsuper.delete();\n\t\tthis._properties = {};\n\t}\n\tdeleteChild(child) {\n\t\tassert(child._threeLetterType !== 'prp', 'Can not delete just one Property child.');\n\t\tsuper.deleteChild(child);\n\t}\n}\n\nPropertyOwner.defineProperties = function(Class, propertyTypes) {\n\tClass._propertyTypes = propertyTypes;\n\tClass._propertyTypesByName = {};\n\tpropertyTypes.forEach(propertyType => {\n\t\tassert(Class.prototype[propertyType.name] === undefined, 'Property name ' + propertyType.name + ' clashes');\n\t\tClass._propertyTypesByName[propertyType.name] = propertyType;\n\t\tObject.defineProperty(Class.prototype, propertyType.name, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[propertyType.name].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[propertyType.name].value = value;\n\t\t\t}\n\t\t});\n\t});\n};\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport Property from './property';\nexport { default as Prop } from './propertyType';\nexport let componentClasses = new Map();\nimport PropertyOwner from './propertyOwner';\n\n// Instance of a component, see componentExample.js\nexport class Component extends PropertyOwner {\n\tconstructor(componentData, entity, env) {\n\t\tsuper('com');\n\t\tthis.entity = entity;\n\t\tthis.env = env;\n\t\tthis.children = {}; // TODO: create children\n\t\tthis._componentData = componentData;\n\t}\n\tdelete() {\n\t\tassert(!this.env.entity.alive, 'Do not call Component.delete!');\n\t\tsuper.delete();\n\t}\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], 'required component not found');\n\t\t});\n\n\t\tthis._forEachChildComponent(c => c._preInit());\n\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'preInit', e);\n\t\t}\n\t}\n\t_init() {\n\t\tthis._forEachChildComponent(c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'sleep', e);\n\t\t}\n\t\tthis._forEachChildComponent(c => c._sleep());\n\t}\n\t_forEachChildComponent(func) {\n\t\tObject.keys(this.children).forEach(key => {\n\t\t\tlet child = this.children[key];\n\t\t\tif (Array.isArray(child)) {\n\t\t\t\tchild.forEach(func);\n\t\t\t} else {\n\t\t\t\tfunc(child);\n\t\t\t}\n\t\t});\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tn: this.constructor.componentName\n\t\t});\n\t}\n}\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.register = function({\n\tname = '', // required\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-bars',\n\tproperties = [],\n\trequirements = [],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {}\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Class extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction();\n\t\t}\n\t\tdelete() {\n\t\t\tsuper.delete(...arguments);\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction();\n\t\t}\n\t}\n\tproperties.forEach(p => {\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t});\n\tPropertyOwner.defineProperties(Class, properties); // properties means propertyTypes here\n\tClass.componentName = name;\n\tClass.category = category;\n\tClass.requirements = requirements;\n\tClass.children = children;\n\tClass.description = description;\n\tClass.icon = icon;\n\tObject.assign(Class.prototype, prototype);\n\tcomponentClasses.set(Class.componentName, Class);\n\treturn Class;\n};\n","import { Component, Prop } from '../../core/component';\n\nComponent.register({\n\tname: 'Position',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('x', 0.1, Prop.float),\n\t\tProp('y', 0.2, Prop.float)\n\t]\n});\n","import { Component, Prop } from '../../core/component';\n\nComponent.register({\n\tname: 'Test',\n\tcategory: 'Core',\n\ticon: 'fa-circle',\n\tproperties: [\n\t\tProp('name', 'Oh right', Prop.string),\n\t\tProp('number', 666, Prop.float)\n\t]\n});\n","import Serializable from './serializable';\nimport assert from '../assert';\nimport { getSerializable } from './serializableManager';\nimport Prop from './propertyType';\nimport PropertyOwner from './propertyOwner';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Prototype extends PropertyOwner {\n\tcopy(constructorParameters = {}) {\n\t\tthrow new Error('broken');\n\t\t// TODO: copy to serializable\n\t\treturn new Prototype(Object.assign({\n\t\t\tname: this.name + ' copy',\n\t\t\tparentId: this.parentId\n\t\t}, constructorParameters));\n\t}\n}\nPropertyOwner.defineProperties(Prototype, propertyTypes);\n\nPrototype.create = function(name) {\n\treturn new Prototype().initWithPropertyValues({ name: name });\n};\n\nSerializable.registerSerializable(Prototype, 'prt');\n","import Serializable from '../core/serializable'\nimport './components/import'\nimport Prototype from '../core/prototype'\nimport assert from '../assert'\nimport PropertyOwner, { Prop } from '../core/propertyOwner';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Game extends PropertyOwner {\n}\nPropertyOwner.defineProperties(Game, propertyTypes);\n\nGame.create = function(name) {\n\treturn new Game().initWithPropertyValues({ name: name });\n};\n\nSerializable.registerSerializable(Game, 'gam');\n","import Serializable from './serializable';\nimport assert from '../assert';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor() {\n\t\tsuper('ent');\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.alive = true;\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null;\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tUses addComponent internally.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components) {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet componentList = this.components.get(components[i].name) || this.components.set(components[i].name, []).get(components[i].name);\n\t\t\tcomponentList.push(components[i]);\n\t\t}\n\t\t\n\t\tif (!this.sleeping)\n\t\t\tEntity.initComponents(components);\n\t\treturn this;\n\t}\n\tstatic initComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\tsleep() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\t\t\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.makeComponentsSleep(componentArray);\n\t\t\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\twakeUp() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.initComponents(componentArray);\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\tdelete() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tsuper.delete();\n\t\tthis.alive = false;\n\t\tfor (let componentArray of this.components)\n\t\t\tEntity.deleteComponents(componentArray);\n\t\tthis.components.clear();\n\t}\n\ttoJSON() {\n\t\tassert(this.alive, ALIVE_ERROR);\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcomponents: []\n\t\t});\n\t}\n}\n\nSerializable.registerSerializable(Entity, 'ent', json => {\n\treturn new Entity(json.id);\n});\n","import assert from '../assert';\n\nimport Serializable from './serializable';\n(() => {\n\tclass S extends Serializable {}\n\tSerializable.registerSerializable(S, 'tes', json => {\n\t\treturn new S(json.id);\n\t});\n\tlet s = new S();\n\tlet id = s.id;\n\tassert(typeof id === 'string' && id.length > 10);\n\tlet json = s.toJSON();\n\tassert(json && typeof json === 'object' && typeof json.id === 'string');\n\ts.delete();\n\ts = Serializable.fromJSON(json);\n\tassert(typeof s.id === 'string' && s.id.length > 10 && s.id === id);\n\tconsole.log('Serializable tests OK');\n})();\n\nimport Entity from './entity';\n(() => {\n\tlet i = new Entity();\n\tassert(i.components.size === 0);\n\tassert(i.getComponent('moi') === null);\n\tassert(i.getComponents('moi').length === 0);\n\tconsole.log('Entity tests OK');\n})();\n\nimport PropertyType from './propertyType';\n(() => {\n\tassert(PropertyType.float.default().validate('4') === 4);\n\tassert(PropertyType.float.range(0, 1).validate(3) === 1);\n\tconsole.log('PropertyType tests OK');\n})();\n","import { Component, Prop } from '../core/component';\n\n// Export so that other components can have this component as parent\nexport default Component.register({\n\tname: 'Example',\n\tdescription: 'Description of what this component does',\n\tcategory: 'Core', // You can also make up new categories.\n\ticon: 'fa-circle', // Font Awesome id\n\trequirements: ['Position'], // These shared components are autofilled. Error if component is not found.\n\tchildren: ['Image', 'Image', 'Sound'], // These private components are also autofilled. Error if component is not found.\n\tproperties: [\n\t\tProp('variable', 0.5, Prop.float, Prop.float.range(0, 1), 'Description of the property'),\n\t\tProp('otherVar_iaerfperfjoierj', 'Hello', Prop.string, 'Description of the property')\n\t],\n\tparentClass: Component,\n\tprototype: {\n\t\tstaticVariable: 'Example class info',\n\t\tconstructor() {\n\t\t\t// This will be called once, when creating the component\n\t\t\tthis.hiddenVariable = 3;\n\t\t},\n\t\tpreInit() {\n\t\t\t// preInit is called for every component before any component is inited with init(). Children are already preInited here.\n\t\t\tthis.data = {\n\t\t\t\tlotsOfData: 123 + this.variable + this.hiddenVariable\n\t\t\t};\n\t\t},\n\t\tinit() {\n\t\t\t// All the components of this entity has been preInited. You can use them. Children are already inited here.\n\t\t\tthis.Position.x = this.Position.y + 1;\n\n\t\t\tthis.howToAccessChildren = [\n\t\t\t\tthis.children.Image[0].property,\n\t\t\t\tthis.children.Sound.property\n\t\t\t];\n\n\t\t\tthis.SomeComponent = this.entity.getComponent('SomeComponent');\n\t\t},\n\t\tsleep() {\n\t\t\t// Release all the data created in preInit and init\n\t\t\tthis.data = null;\n\t\t\tthis.SomeComponent = null;\n\t\t\tthis.howToAccessChildren = null;\n\t\t\t// Position component is automatically released because it is a requirement.\n\t\t},\n\t\tdelete() {\n\t\t\t// This will be called once, when component stops existing\n\t\t}\n\t}\n});\n","/*\n Global event system\n\n let unlisten = events.listen('event name', function(params, ...) {});\n eventManager.dispatch('event name', paramOrParamArray);\n unlisten();\n */\n\nlet listeners = {};\n\nexport default {\n\tlisten(event, callback) {\n\t\tif (!listeners.hasOwnProperty(event)) {\n\t\t\tlisteners[event] = [];\n\t\t}\n\t\tlisteners[event].push(callback);\n\t\treturn () => {\n\t\t\tvar index = listeners[event].indexOf(callback);\n\t\t\tlisteners[event].splice(index, 1);\n\t\t};\n\t},\n\tdispatch(event, ...args) {\n\t\tif (listeners.hasOwnProperty(event)) {\n\t\t\tfor (var i = 0; i < listeners[event].length; ++i) {\n\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t/*\n\t\t\t\ttry {\n\t\t\t\t\tlisteners[event][i].apply(null, args);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tif (console && console.error) {\n\t\t\t\t\t\tconsole.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\t\t}\n\t}\n};\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class ModuleContainer {\n\tconstructor(moduleContainerName = 'unknownClass.anotherClass', packButtonIcon = 'fa-chevron-left') {\n\t\t\n\t\tthis.modules = [];\n\t\tthis.packButtonEnabled = !!packButtonIcon;\n\t\tthis.el = el(`div.moduleContainer.packable.${moduleContainerName}`,\n\t\t\tthis.packButton = packButtonIcon && el(`i.packButton.button.iconButton.fa.${packButtonIcon}`),\n\t\t\tthis.tabs = list('div.tabs', ModuleTab),\n\t\t\tthis.moduleElements = el('div.moduleElements')\n\t\t);\n\t\tif (packButtonIcon) {\n\t\t\tthis.el.onclick = () => this.el.classList.contains('packed') && this.el.classList.remove('packed');\n\t\t\tthis.packButton.onclick = e => {\n\t\t\t\tthis.el.classList.add('packed');\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t}\n\n\t\tevents.listen('registerModule_' + moduleContainerName.split('.')[0], (moduleClass, editor) => {\n\t\t\tlet module = new moduleClass();\n\t\t\tmodule.editor = editor;\n\t\t\tmodule.state = editor.state;\n\t\t\tmodule.el.classList.add('module-' + module.id);\n\t\t\tthis.modules.push(module);\n\t\t\tif (this.modules.length !== 1) {\n\t\t\t\tmodule._hide();\n\t\t\t}\n\t\t\tmount(this.moduleElements, module.el);\n\t\t\tthis._updateTabs();\n\t\t\t\n\t\t\tevents.listen('activateModule_' + module.id, (unpackModuleView = true, ...args) => {\n\t\t\t\tif (unpackModuleView)\n\t\t\t\t\tthis.el.classList.remove('packed');\n\t\t\t\tthis._activateModule(module, args);\n\t\t\t});\n\t\t});\n\t\tthis._updateTabs();\n\t}\n\tupdate() {\n\t\tthis.modules.forEach(m => m.update());\n\t}\n\t_updateTabs() {\n\t\tif (!this.tabs) return;\n\t\t\n\t\tthis.tabs.update(this.modules);\n\t\t\n\t\tif (!this.packButtonEnabled && this.modules.length <= 1)\n\t\t\tthis.tabs.el.style.display = 'none';\n\t\telse\n\t\t\tthis.tabs.el.style.display = 'block';\n\t}\n\t_activateModule(module, args) {\n\t\tlet idx = this.modules.indexOf(module);\n\t\tthis.modules.forEach(m => {\n\t\t\tif (m !== module) {\n\t\t\t\tm._hide();\n\t\t\t}\n\t\t});\n\t\tmodule.activate(...args);\n\t\tmodule._show();\n\t\tthis._updateTabs();\n\t\t\n\t\t/*\n\t\tthis.modules.splice(idx, 1);\n\t\tthis.modules.unshift(module);\n\t\tthis._updateTabs();\n\t\tfor (let i = 1; i < this.modules.length; i++) {\n\t\t\tthis.modules[i].el.style.display = 'none';\n\t\t}\n\t\tmodule.activate(...args);\n\t\tmodule.el.style.display = 'block';\n\t\t*/\n\t}\n}\n\nclass ModuleTab {\n\tconstructor() {\n\t\tthis.el = el('span.moduleTab.button');\n\t\tthis.module = null;\n\t\tthis.el.onclick = () => {\n\t\t\tevents.dispatch('activateModule_' + this.module.id);\n\t\t};\n\t}\n\tupdate(module) {\n\t\tthis.module = module;\n\t\tthis.el.textContent = module.name;\n\t\tthis.el.classList.toggle('active', module._visible);\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport ModuleContainer from './moduleContainer';\n\nexport default class Layout {\n\tconstructor() {\n\t\tthis.moduleContainers = [];\n\t\tlet addContainer = (...args) => {\n\t\t\tlet container = new ModuleContainer(...args);\n\t\t\tthis.moduleContainers.push(container);\n\t\t\treturn container;\n\t\t}\n\t\tthis.el = el('div.editorLayout',\n\t\t\tel('div.nonRight',\n\t\t\t\taddContainer('top', null),\n\t\t\t\tel('div.bottomLeft',\n\t\t\t\t\taddContainer('left', 'fa-chevron-left'),\n\t\t\t\t\tel('div.middle',\n\t\t\t\t\t\taddContainer('center', null),\n\t\t\t\t\t\taddContainer('bottom', 'fa-chevron-down')\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t),\n\t\t\taddContainer('right', 'fa-chevron-right')\n\t\t);\n\t}\n\tupdate(state) {\n\t\tthis.moduleContainers.forEach(mc => mc.update(state));\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\nexport default class Module {\n\tconstructor() {\n\t\tthis.name = this.name || 'Module';\n\t\tthis.id = this.id || 'module';\n\t\tthis.el = el('div.module', ...arguments);\n\t\tthis._visible = true;\n\t}\n\t// Called when this module is opened. Other modules can call Module.activateModule('Module', ...args);\n\tactivate() {\n\t}\n\t// Called when state of editor changes\n\tupdate() {\n\t}\n\t_show() {\n\t\tthis.el.classList.remove('hidden');\n\t\tthis._visible = true;\n\t}\n\t_hide() {\n\t\tthis.el.classList.add('hidden');\n\t\tthis._visible = false;\n\t}\n}\n//arguments: moduleName, unpackModuleView=true, ...args \nModule.activateModule = function(moduleName, unpackModuleView=true, ...args) {\n\tevents.dispatch('activateModule_' + moduleName, unpackModuleView, ...args);\n};\nModule.packModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.add('packed');\n};\nModule.unpackModuleContainer = function(moduleContainerName) {\n\tdocument.querySelectorAll(`.moduleContainer.${moduleContainerName}`)[0].classList.remove('packed');\n};\n\n// moduleContainerName = left | middle | right | bottom\nModule.register = function(moduleClass, moduleContainerName) {\n\tregisterPromise = registerPromise.then(editor => {\n\t\tevents.dispatch('registerModule_' + moduleContainerName, moduleClass, editor);\n\t\treturn editor;\n\t});\n};\n\nlet nextTopBarPriorityNumber = 1;\nModule.registerTopButton = function(text, icon, func, priority = nextTopBarPriorityNumber++) {\n\tregisterPromise = registerPromise.then(editor => {\n\t\tevents.dispatch('registerTopButton', text, icon, func, priority);\n\t\treturn editor;\n\t});\n};\n\n\nlet registerPromise = new Promise(function(resolve) {\n\tevents.listen('registerModules', function(editor) {\n\t\tregisterPromise.then(editor => {\n\t\t\tevents.dispatch('modulesRegistered');\n\t\t\treturn editor;\n\t\t});\n\t\tresolve(editor);\n\t});\n});\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nexport class TopBarModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.logo = el('img.logo.button.iconButton', { src: '../img/logo_reflection_medium.png' }),\n\t\t\tthis.list = list('div.buttonContainer', TopButton)\n\t\t);\n\t\tthis.id = 'topbar';\n\t\tthis.name = 'TopBar'; // not visible\n\t}\n\tupdate() {\n\t\tthis.list.update(this.state.topButtons);\n\t}\n}\nModule.register(TopBarModule, 'top');\n\nModule.registerTopButton('Bell Types', 'fa fa-bell-o', () => { \n\tModule.unpackModuleContainer('bottom');\n\tModule.activateModule('types');\n\tModule.activateModule('type');\n}, 1);\nModule.registerTopButton('Cube Instances', 'fa fa-cubes', () => {\n\tModule.activateModule('instances');\n\tModule.activateModule('instance');\n}, 2);\n\nexport class TopButton {\n\tconstructor() {\n\t\tthis.el = el('div.button.topIconTextButton',\n\t\t\tel('div.topIconTextButtonContent',\n\t\t\t\tthis.icon = el('i.fa'),\n\t\t\t\tthis.text = el('span')\n\t\t\t)\n\t\t)\n\t\tthis.el.onclick = () => {\n\t\t\tthis.callback && this.callback();\n\t\t}\n\t\tthis.callback = null;\n\t}\n\tupdate(state) {\n\t\tthis.icon.className = state.icon;\n\t\tthis.text.textContent = state.text;\n\t\tthis.callback = state.func;\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport events from '../events';\n\n/*\nReference: Unbounce\n https://cdn8.webmaster.net/pics/Unbounce2.jpg\n */\n\nexport default class PropertyEditor {\n\tconstructor() {\n\t\tthis.el = el('div');\n\t\tthis.editor = null;\n\t}\n\tupdate(selection) {\n\t\t$(this.el).empty();\n\t\tif (selection.type === 'prt' && selection.items.length === 1) {\n\t\t\tlet prototypeEditor = new Container();\n\t\t\tprototypeEditor.update(selection.items[0]);\n\t\t\t\n\t\t\tmount(this.el, prototypeEditor);\n\t\t}\n\t}\n}\n\nclass Container {\n\tconstructor() {\n\t\tthis.el = el('div',\n\t\t\tthis.title = el('div'),\n\t\t\tthis.properties = list('div', Property),\n\t\t\tthis.containers = list('div', Container),\n\t\t\tthis.controls = el('div')\n\t\t);\n\t}\n\tupdate(state) {\n\t\tthis.properties.update(state.getChildren('prp'));\n\t\tlet containers = [].concat(state.getChildren('cda'), state.getChildren('com'));\n\t\tthis.containers.update(containers);\n\t\tthis.controls.innerHTML = '';\n\t\t\n\t\tmount(this.controls, el('button', 'Press me'));\n\t}\n}\n\nclass Property {\n\tconstructor() {\n\t\tthis.el = el('div',\n\t\t\tthis.name = el('span'),\n\t\t\tthis.input = el('input')\n\t\t);\n\t\tthis.input.onchange = () => {\n\t\t\tthis.property.value = this.input.value;\n\t\t\tevents.dispatch('requestUpdate');\n\t\t};\n\t}\n\tupdate(property) {\n\t\tthis.property = property;\n\t\tthis.name.textContent = property.propertyType.name;\n\t\tthis.input.value = property.value;\n\t}\n}\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport PropertyEditor from '../views/propertyEditor';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.propertyEditor = new PropertyEditor()\n\t\t);\n\t\tthis.id = 'type';\n\t\tthis.name = 'Type';\n\t}\n\tupdate() {\n\t\tthis.propertyEditor.update(this.state.selection);\n\t\t\n\t\t/*\n\t\t\n\t\t \n\t\tthis.componentClasses = this.state.componentClasses; \n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c._propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc._propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\t\t\n\t\tnew PJS($(this.propertyEditor), schema, data);\n\t\t*/\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nlet propertyTypeToEditorType = {\n\t'float': 'number',\n\t'string': 'text'\n};\n\nclass PropertyModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.propertyEditor = el('div.propertyEditor', 'hei')\n\t\t);\n\t\tthis.id = 'instance';\n\t\tthis.name = 'Instance';\n\t}\n\tupdate() {\n\t\tthis.componentClasses = this.state.componentClasses;\n\n\t\tlet schema = {\n\t\t\teditors: [\n\t\t\t\t{\n\t\t\t\t\tfield: 'yks',\n\t\t\t\t\ttitle: 'YKS',\n\t\t\t\t\ttype: 'text'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tlet data = {};\n\n\t\tlet componentArray = Array.from(this.componentClasses.values());\n\t\tcomponentArray.forEach(c => {\n\t\t\tlet componentSchema = {\n\t\t\t\ttype: 'group',\n\t\t\t\tfield: c.name,\n\t\t\t\ttitle: c.name,\n\t\t\t\teditors: c._propertyTypes.map(pm => ({\n\t\t\t\t\tfield: c.name + '.' + pm.name,\n\t\t\t\t\ttitle: pm.name.length > 30 ? (pm.name.substring(0, 28) + '..') : pm.name,\n\t\t\t\t\ttype: propertyTypeToEditorType[pm.type.name] || 'text'\n\t\t\t\t}))\n\t\t\t};\n\t\t\tschema.editors.push(componentSchema);\n\n\t\t\tlet componentData = {};\n\t\t\tc._propertyTypes.forEach(pm => {\n\t\t\t\tcomponentData[pm.name] = pm.initialValue;\n\t\t\t});\n\t\t\tdata[c.name] = componentData;\n\t\t});\n\n\t\tnew PJS($(this.propertyEditor), schema, data);\n\t}\n}\n\nModule.register(PropertyModule, 'right');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass SceneModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'moi test')\n\t\t);\n\t\tthis.id = 'scene';\n\t\tthis.name = 'Scene';\n\t}\n\tupdate() {\n\t}\n}\n\nModule.register(SceneModule, 'center');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\nimport events from '../events';\nimport Prototype from '../../core/prototype';\nimport { getSerializable } from '../../core/serializableManager';\nimport assert from '../../assert';\n\nclass Types extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.addButton = el('span.addTypeButton.button.fa.fa-plus'),\n\t\t\tthis.search = el('input'),\n\t\t\tthis.searchIcon = el('i.fa.fa-search.searchIcon'),\n\t\t\tthis.jstree = el('div')\n\t\t);\n\t\tthis.id = 'types';\n\t\tthis.name = 'Types';\n\n\t\tthis.addButton.onclick = () => {\n\t\t\tthis.state.game.addChild(Prototype.create('' + Math.random()));\n\t\t\tthis.editor.update();\n\t\t\tthis.editor.save();\n\t\t};\n\t\t\n\t\tlet searchTimeout = false;\n\t\tthis.search.addEventListener('keyup', () => {\n\t\t\tif (searchTimeout)\n\t\t\t\tclearTimeout(searchTimeout);\n\n\t\t\tsearchTimeout = setTimeout(() => {\n\t\t\t\t$(this.jstree).jstree().search(this.search.value.trim());\n\t\t\t}, 200);\n\t\t});\n\t}\n\tupdate() {\n\t\tif (this.skipUpdate) return;\n\t\t\n\t\tlet data = [];\n\t\tthis.state.game.forEachChild('prt', prototype => {\n\t\t\tlet parent = prototype.getParent();\n\t\t\tdata.push({\n\t\t\t\ttext: prototype.name,\n\t\t\t\tid: prototype.id,\n\t\t\t\tparent: parent._threeLetterType === 'prt' ? parent.id : '#'\n\t\t\t});\n\t\t}, true);\n\t\t\n\t\tif (!this.jstreeInited) {\n\t\t\t$(this.jstree).attr('id', 'types-jstree').on('changed.jstree', (e, data) => {\n\t\t\t\t// selection changed\n\t\t\t\tthis.skipUpdate = true;\n\t\t\t\tthis.editor.select(data.selected.map(getSerializable));\n\t\t\t\tthis.skipUpdate = false;\n\t\t\t}).on('loaded.jstree refresh.jstree', () => {\n\t\t\t\tlet jstree = $(this.jstree).jstree(true);\n\t\t\t\t// let selNode = jstree.get_node('prtF21ZLL0vsLdQI5z');\n\t\t\t\t// console.log(jstree, selNode);\n\t\t\t\tif (this.state.selection.type === 'none') {\n\t\t\t\t\t//jstree.select_node();\n\t\t\t\t}\n\t\t\t\tif (this.state.selection.type === 'prt') {\n\t\t\t\t\t// jstree.select_node(this.state.selection.items.map(i => i.id));\n\t\t\t\t}\n\t\t\t}).jstree({\n\t\t\t\tcore: {\n\t\t\t\t\tcheck_callback: true,\n\t\t\t\t\tdata,\n\t\t\t\t\tforce_text: true\n\t\t\t\t},\n\t\t\t\tplugins: ['types', 'dnd', 'sort', 'search', 'state'],\n\t\t\t\ttypes: {\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\ticon: 'fa fa-book'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdnd: {\n\t\t\t\t\tcopy: false // jstree makes it way too hard to copy multiple prototypes\n\t\t\t\t},\n\t\t\t\tsearch: {\n\t\t\t\t\tfuzzy: true,\n\t\t\t\t\tshow_only_matches: true,\n\t\t\t\t\tshow_only_matches_children: true,\n\t\t\t\t\tclose_opened_onclear: false\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.jstreeInited = true;\n\t\t} else {\n\t\t\t$(this.jstree).jstree(true).settings.core.data = data;\n\t\t\t$(this.jstree).jstree('refresh');\n\t\t}\n\t\t$(this.jstree).data('typesModule', this);\n\t\t\n\t\t// $(this.jstree).jstree(true).select_node($('#prtF21ZLL0vsLdQI5z')[0]);//this.state.selection.items.map(i => i.id));\n\t\tif (this.state.selection.type === 'none') {\n\t\t}\n\t}\n}\n\n$(document).on('dnd_stop.vakata', function (e, data) {\n\tlet jstree = $('#types-jstree').jstree(true);\n\tlet typesModule = $('#types-jstree').data('typesModule');\n\t\n\tsetTimeout(function () {\n\t\t// Now the nodes have moved in the DOM.\n\n\t\tlet node = jstree.get_node(data.data.obj);\n\t\tlet nodes = data.data.nodes; // these prototypes will move\n\t\tlet newParent;\n\t\tif (node.parent === '#')\n\t\t\tnewParent = typesModule.state.game;\n\t\telse\n\t\t\tnewParent = getSerializable(node.parent);\n\t\t\n\t\tlet nodeObjects = nodes.map(getSerializable);\n\t\tnodeObjects.forEach(assert);\n\t\tnodeObjects.forEach(prototype => {\n\t\t\tnewParent.addChild(prototype.detach());\n\t\t});\n\t\t\n\t\t// console.log('dnd stopped from', nodes, 'to', newParent);\n\t\t\n\t\ttypesModule.editor.save();\n\t});\n});\n\nModule.register(Types, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'List of instances on the scene')\n\t\t);\n\t\tthis.name = 'Instances';\n\t\tthis.id = 'instances';\n\t}\n\tupdate() {\n\t}\n}\n\nModule.register(TestModule, 'left');\n","import { el, list, mount } from 'redom';\nimport Module from './module';\n\nclass TestModule extends Module {\n\tconstructor() {\n\t\tsuper(\n\t\t\tthis.content = el('span', 'This is test 3')\n\t\t);\n\t\tthis.id = 'test';\n\t\tthis.name = 'Test3';\n\t}\n\tupdate() {\n\t}\n}\n\nModule.register(TestModule, 'bottom');\n","import events from './events';\nimport Layout from './layout/layout';\nimport './module/topBar';\nimport './module/type';\nimport './module/instance';\nimport './module/scene';\nimport './module/types';\nimport './module/instances';\nimport './module/test3';\nimport { el, list, mount } from 'redom';\nimport Game from '../game/game';\nimport Serializable from '../core/serializable';\n\nimport { componentClasses } from '../core/component';\n\nwindow.addEventListener('load', () => {\n\tlet anotherGame;\n\t// anotherGame = Serializable.fromJSON(JSON.parse(localStorage.anotherGameJSON));\n\ttry {\n\t\tanotherGame = Serializable.fromJSON(JSON.parse(localStorage.anotherGameJSON));\n\t} catch(e) {\n\t\tconsole.warn('game parsing failed', e);\n\t}\n\teditor = new Editor(anotherGame);\n\tevents.dispatch('registerModules', editor);\n});\nevents.listen('modulesRegistered', () => {\n\teditor.update();\n\tevents.dispatch('loaded');\n});\n\nlet editor = null;\nclass Editor {\n\tconstructor(game = Game.create('My Game')) {\n\t\tthis.layout = new Layout();\n\t\t\n\t\tthis.state = {\n\t\t\ttopButtons: [],\n\t\t\tselection: {\n\t\t\t\ttype: 'none',\n\t\t\t\titems: []\n\t\t\t},\n\t\t\tgame,\n\t\t\tcomponentClasses\n\t\t};\n\n\t\tmount(document.body, this.layout);\n\t\t\n\t\tevents.listen('registerTopButton', (text, icon, func, priority) => {\n\t\t\tlet button = { icon, text, func, priority };\n\t\t\tlet i = 0;\n\t\t\tlet topButtons = this.state.topButtons;\n\t\t\twhile (i < topButtons.length) {\n\t\t\t\tlet b = topButtons[i];\n\t\t\t\tif (b.priority > priority) {\n\t\t\t\t\ttopButtons.splice(i, 0, button);\n\t\t\t\t\ti = -1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tif (i >= 0) topButtons.push(button);\n\t\t});\n\t\t\n\t\tevents.listen('requestUpdate', () => {\n\t\t\tconsole.log('requested');\n\t\t\tthis.update();\n\t\t});\n\t}\n\tselect(items) {\n\t\tthis.state.selection.items = items;\n\t\t\n\t\tlet types = Array.from(new Set(items.map(i => i.id.substring(0, 3))));\n\t\tif (types.length === 0)\n\t\t\tthis.state.selection.type = 'none';\n\t\telse if (types.length === 1)\n\t\t\tthis.state.selection.type = types[0];\n\t\telse\n\t\t\tthis.state.selection.type = 'mixed';\n\t\t\n\t\tthis.update();\n\t}\n\tupdate() {\n\t\tthis.layout.update(this.state);\n\t}\n\tsave() {\n\t\tlocalStorage.anotherGameJSON = JSON.stringify(this.state.game.toJSON());\n\t\tconsole.log('saved');\n\t}\n}\n","import './main';\n\nimport './core/test';\nimport './core/componentExample'; // temp\n\nimport './editor/editor';\n\n\nimport Property from './core/property';\nwindow.Property = Property;\n\nimport PropertyModel from './core/propertyType';\nwindow.PropertyModel = PropertyModel;\n\nimport { Component } from './core/component';\nwindow.Component = Component;\n\nimport Serializable from './core/serializable';\nwindow.Serializable = Serializable;\n\nimport { getSerializable } from './core/serializableManager';\nwindow.getSerializable = getSerializable;\n"],"names":["assert","condition","message","Error","addSerializable","serializable","serializables","id","getSerializable","removeSerializable","char","CHARACTERS","Math","random","CHAR_COUNT","createStringId","threeLetterPrefix","characters","let","i","createPropertyType","propertyName","defaultValue","type","validator","validators","default","description","optionalParameters","forEach","p","validate","PropertyType","addDataType","ref","x","name","toJSON","fromJSON","createType","Object","keys","validatorName","createValidator","validatorFunction","parameters","validatorParameters","createElement","query","ns","tag","className","mode","start","length","charCodeAt","HASH","DOT","substring","slice","element","document","createElementNS","text","content","createTextNode","mount","parent","child","before","parentEl","el","childEl","__redom_list","__redom_view","isMounted","remount","insertBefore","appendChild","remounted","mounted","unmount","removeChild","unmounted","arguments$1","arguments","elcache","cloneNode","nodeType","empty","arg","textContent","j","key","value","setAttribute","cssKey","style","setChildren","children","traverse","firstChild","nextSibling","next","list","View","initData","List","this","views","lookup","serializableClasses","Map","Serializable","predefinedId","_threeLetterType","_children","startsWith","serializableManager.addSerializable","delete","_parent","deleteChild","array","clear","serializableManager.removeSerializable","addChildren","addChild","get","undefined","set","push","findChild","threeLetterType","filterFunction","find","getChildrenByType","detachChild","idx","indexOf","splice","forEachChild","callback","deep","processArray","detach","getParent","getChildren","json","size","arrays","c","concat","toString","JSON","stringify","markDirty","_dirty","obj","map","registerSerializable","Class","prototype","Property","propertyType","super","_initialValue","setPropertyType","initialValue","assign","v","n","model","defineProperty","newValue","_value","createProperty","parseFloat","isNaN","range","min","max","String","PropertyOwner","Array","isArray","constructor","_propertyTypes","_properties","initWithPropertyValues","values","propName","_propertyTypesByName","_addChildrenCalled","propChildren","otherChildren","invalidPropertiesCount","filter","prop","console","log","isInvalid","nameToProp","defineProperties","propertyTypes","componentClasses","Component","componentData","entity","env","_componentData","alive","_preInit","requirements","r","getComponent","_forEachChildComponent","preInit","e","error","componentName","_init","init","_sleep","sleep","func","reservedPropertyNames","Set","reservedPrototypeMembers","register","has","k","constructorFunction","deleteFunction","parentClass","properties","category","icon","Prop","float","string","Prototype","copy","constructorParameters","create","Game","const","ALIVE_ERROR","Entity","components","sleeping","getComponents","addComponents","componentList","initComponents","makeComponentsSleep","deleteComponents","componentArray","wakeUp","S","s","staticVariable","hiddenVariable","data","lotsOfData","variable","Position","y","howToAccessChildren","Image","property","Sound","SomeComponent","listeners","listen","event","hasOwnProperty","index","dispatch","apply","args","extend","clone","bind","update","functionKey","newViews","oldViews","newLookup","oldLookup","item","view","__id","el$$1","Router","Views","route","ModuleContainer","moduleContainerName","packButtonIcon","modules","packButtonEnabled","packButton","tabs","ModuleTab","moduleElements","onclick","classList","contains","remove","this$1","add","stopPropagation","events","split","moduleClass","editor","module","state","_hide","_updateTabs","unpackModuleView","_activateModule","m","display","activate","_show","toggle","_visible","Layout","moduleContainers","addContainer","container","mc","Module","argsArray","activateModule","moduleName","packModuleContainer","querySelectorAll","unpackModuleContainer","registerPromise","then","nextTopBarPriorityNumber","registerTopButton","priority","Promise","resolve","TopBarModule","logo","src","TopButton","topButtons","PropertyEditor","selection","$","items","prototypeEditor","Container","title","containers","controls","innerHTML","input","onchange","PropertyModule","propertyEditor","propertyTypeToEditorType","schema","editors","field","from","componentSchema","pm","PJS","SceneModule","Types","addButton","search","searchIcon","jstree","game","save","searchTimeout","addEventListener","clearTimeout","setTimeout","trim","skipUpdate","jstreeInited","settings","core","attr","on","select","selected","check_callback","force_text","plugins","types","dnd","fuzzy","show_only_matches","show_only_matches_children","close_opened_onclear","typesModule","newParent","node","get_node","nodes","nodeObjects","TestModule","window","anotherGame","parse","localStorage","anotherGameJSON","warn","Editor","layout","body","button","b","PropertyModel"],"mappings":"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"}