{"version":3,"file":null,"sources":["../src/util/environment.js","../src/core/serializable.js","../src/core/serializableManager.js","../src/util/assert.js","../src/core/property.js","../src/core/propertyType.js","../src/util/vector.js","../src/core/dataTypes.js","../src/core/propertyOwner.js","../src/core/entity.js","../src/core/componentData.js","../src/core/prototype.js","../src/core/game.js","../src/feature/physics.js","../src/core/scene.js","../src/core/component.js","../src/core/entityPrototype.js","../src/core/level.js","../src/components/Transform.js","../src/components/TransformVariance.js","../src/components/Test.js","../src/util/input.js","../src/components/Mover.js","../src/components/Rect.js","../src/components/Spawner.js","../src/components/Trigger.js","../src/components/Physics.js","../src/server/gameDataTools.js","../src/server/gameServer.js","../src/server/connection.js","../src/server/template.js","../src/serverMain.js"],"sourcesContent":["let isClient = typeof window !== 'undefined';\nlet isServer = typeof module !== 'undefined';\n\nif (isClient && isServer)\n\tthrow new Error('Can not be client and server at the same time.');\n\nexport { isClient, isServer };\n","import assert from '../util/assert';\nimport { addSerializable, removeSerializable, addChange, changeType } from './serializableManager';\nimport { isClient } from '../util/environment';\n\nconst CHARACTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'; // 62 chars\nconst CHAR_COUNT = CHARACTERS.length;\n\nconst random = Math.random;\nexport function createStringId(threeLetterPrefix = '???', characters = 16) {\n\tlet id = threeLetterPrefix;\n\tfor (let i = characters - 1; i >= 0; --i)\n\t\tid += CHARACTERS[random() * CHAR_COUNT | 0];\n\treturn id;\n}\n\nlet serializableClasses = new Map();\n\nexport default class Serializable {\n\tconstructor(predefinedId = false, skipSerializableRegistering = false) {\n// @ifndef OPTIMIZE\n\t\tassert(this.threeLetterType, 'Forgot to Serializable.registerSerializable your class?');\n// @endif\n\t\tthis._children = new Map(); // threeLetterType -> array\n\t\tthis._listeners = {};\n\t\tthis._rootType = this.isRoot ? this.threeLetterType : null;\n\t\tif (skipSerializableRegistering)\n\t\t\treturn;\n\t\tif (predefinedId) {\n\t\t\tthis.id = predefinedId;\n\t\t} else {\n\t\t\tthis.id = createStringId(this.threeLetterType);\n\t\t}\n\t\t/*\n\t\tif (this.id.startsWith('?'))\n\t\t\tthrow new Error('?');\n\t\t\t*/\n\t\taddSerializable(this);\n\t}\n\tdelete() {\n\t\tif (this._parent) {\n\t\t\tthis._parent.deleteChild(this);\n\t\t\treturn false;\n\t\t}\n\t\tthis.deleteChildren();\n\t\tthis._alive = false;\n\t\tthis._rootType = null;\n\t\tthis._listeners = {};\n\t\tremoveSerializable(this.id);\n\t\tthis._state |= Serializable.STATE_DESTROY;\n\t\treturn true;\n\t}\n\tdeleteChildren() {\n\t\tif (this._children.size) {\n\t\t\tthis._children.forEach(array => {\n\t\t\t\tarray.forEach(child => {\n\t\t\t\t\tchild._parent = null;\n\t\t\t\t\tchild.delete();\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis._children.clear();\n\n\t\t\tif (this._parent) {\n\t\t\t\taddChange(changeType.deleteAllChildren, this);\n\t\t\t}\n\t\t}\n\t}\n\t// this is called right after constructor\n\tinitWithChildren(children = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\t\tif (children.length > 0)\n\t\t\tthis.addChildren(children);\n\t\treturn this;\n\t}\n\taddChildren(children) {\n\t\tfor (let i = 0; i < children.length; i++)\n\t\t\tthis.addChild(children[i]);\n\t\treturn this;\n\t}\n\taddChild(child) {\n\t\tthis._addChild(child);\n\t\t\n\t\tthis._state |= Serializable.STATE_ADDCHILD;\n\t\t\n\t\tif (this._rootType)\n\t\t\taddChange(changeType.addSerializableToTree, child);\n\t\treturn this;\n\t}\n\t_addChild(child) {\n\t\tassert(child._parent === null);\n\t\t\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tif (array === undefined) {\n\t\t\tarray = [];\n\t\t\tthis._children.set(child.threeLetterType, array);\n\t\t}\n\t\tarray.push(child);\n\t\tchild._parent = this;\n\t\tchild._state |= Serializable.STATE_ADDPARENT;\n\t\t\n\t\tif (child._rootType !== this._rootType) // tiny optimization\n\t\t\tchild.setRootType(this._rootType);\n\t\t\n\t\treturn this;\n\t}\n\tfindChild(threeLetterType, filterFunction, deep = false) {\n\t\tlet array = this._children.get(threeLetterType);\n\t\tif (!array) return null;\n\t\tif (filterFunction) {\n\t\t\tlet foundChild = array.find(filterFunction);\n\t\t\tif (foundChild) {\n\t\t\t\treturn foundChild;\n\t\t\t} else if (deep) {\n\t\t\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\t\t\tlet child = array[i];\n\t\t\t\t\tlet foundChild = child.findChild(threeLetterType, filterFunction, true);\n\t\t\t\t\tif (foundChild)\n\t\t\t\t\t\treturn foundChild;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn array[0];\n\t\t}\n\t}\n\tfindParent(threeLetterType, filterFunction = null) {\n\t\tlet parent = this;\n\t\twhile (parent) {\n\t\t\tif (parent.threeLetterType === threeLetterType && (!filterFunction || filterFunction(parent)))\n\t\t\t\treturn parent;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn null;\n\t}\n\tgetRoot() {\n\t\tlet element = this;\n\t\twhile (element._parent) {\n\t\t\telement = element._parent;\n\t\t}\n\t\treturn element;\n\t}\n\t// idx is optional\n\tdeleteChild(child, idx) {\n\t\taddChange(changeType.deleteSerializable, child);\n\t\tthis._detachChild(child, idx);\n\t\tchild.delete();\n\t\treturn this;\n\t}\n\t// idx is optional\n\t_detachChild(child, idx = 0) {\n\t\tlet array = this._children.get(child.threeLetterType);\n\t\tassert(array, 'child not found');\n\t\tif (array[idx] !== child)\n\t\t\tidx = array.indexOf(child);\n\t\tassert(idx >= 0, 'child not found');\n\t\tarray.splice(idx, 1);\n\t\tif (array.length === 0)\n\t\t\tthis._children.delete(child.threeLetterType);\n\t\tchild._parent = null;\n\t\tchild.setRootType(null);\n\t\t\n\t\treturn this;\n\t}\n\tforEachChild(threeLetterType = null, callback, deep = false) {\n\t\tfunction processArray(array) {\n\t\t\tarray.forEach(child => {\n\t\t\t\tcallback(child);\n\t\t\t\tdeep && child.forEachChild(threeLetterType, callback, true);\n\t\t\t});\n\t\t}\n\t\tif (threeLetterType) {\n\t\t\tprocessArray(this._children.get(threeLetterType) || []);\n\t\t} else {\n\t\t\tthis._children.forEach(processArray);\n\t\t}\n\t\treturn this;\n\t}\n\tmove(newParent) {\n\t\t\n\t\tnewParent._addChild(this._detach());\n\n\t\taddChange(changeType.move, this);\n\t\t\n\t\treturn this;\n\t}\n\t_detach() {\n\t\tthis._parent && this._parent._detachChild(this);\n\t\treturn this;\n\t}\n\tgetParent() {\n\t\treturn this._parent || null;\n\t}\n\tgetChildren(threeLetterType) {\n\t\treturn this._children.get(threeLetterType) || [];\n\t}\n\ttoJSON() {\n\t\tlet json = {\n\t\t\tid: this.id\n\t\t};\n\t\tif (this._children.size > 0) {\n\t\t\tlet arrays = [];\n\t\t\t// prototypes must come before a level\n\t\t\tArray.from(this._children.keys()).sort((a, b) => a === 'prt' ? -1 : 1)\n\t\t\t\t.forEach(key => arrays.push(this._children.get(key)));\n\t\t\tjson.c = [].concat(...arrays).map(child => child.toJSON());\n\t\t}\n\t\treturn json;\n\t}\n\ttoString() {\n\t\treturn JSON.stringify(this.toJSON(), null, 4);\n\t}\n\tclone() {\n\t\tlet obj = new this.constructor();\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\tlisten(event, callback) {\n\t\tif (!this._listeners.hasOwnProperty(event)) {\n\t\t\tthis._listeners[event] = [];\n\t\t}\n\t\tthis._listeners[event].unshift(callback);\n\t\treturn () => {\n\t\t\tvar index = this._listeners[event].indexOf(callback);\n\t\t\tthis._listeners[event].splice(index, 1);\n\t\t};\n\t}\n\tdispatch(event, a, b, c) {\n\t\tif (this._listeners.hasOwnProperty(event)) {\n\t\t\tlet listeners = this._listeners[event];\n\t\t\tfor (var i = listeners.length - 1; i >= 0; --i) {\n// @ifndef OPTIMIZE\n\t\t\t\ttry {\n// @endif\n\n\t\t\t\t\tlisteners[i](a, b, c);\n\t\t\t\t\t\n// @ifndef OPTIMIZE\n\t\t\t\t} catch(e) {\n\t\t\t\t\tconsole.error(`Event ${event} listener crashed.`, this._listeners[event][i], e);\n\t\t\t\t}\n// @endif\n\t\t\t}\n\t\t}\n\t}\n\thasDescendant(child) {\n\t\tif (!child) return false;\n\t\tlet parent = child._parent;\n\t\twhile (parent) {\n\t\t\tif (parent === this) return true;\n\t\t\tparent = parent._parent;\n\t\t}\n\t\treturn false;\n\t}\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tthis._rootType = rootType;\n\t\t\n\t\t// Optimized\n\t\tlet i;\n\t\tthis._children.forEach(childArray => {\n\t\t\tfor (i = 0; i < childArray.length; ++i) {\n\t\t\t\tchildArray[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\tisInTree() {\n\t\treturn !!this._rootType;\n\t}\n\tstatic fromJSON(json) {\n\t\tassert(typeof json.id === 'string' && json.id.length > 5, 'Invalid id.');\n\t\tlet fromJSON = serializableClasses.get(json.id.substring(0, 3));\n\t\tassert(fromJSON);\n\t\tlet obj;\n\t\ttry {\n\t\t\tobj = fromJSON(json);\n\t\t} catch(e) {\n\t\t\tif (isClient) {\n\t\t\t\tif (!window.force)\n\t\t\t\t\tdebugger; // Type 'force = true' in console to ignore failed imports.\n\n\t\t\t\tif (!window.force)\n\t\t\t\t\tthrow new Error();\n\t\t\t} else {\n\t\t\t\tconsole.log('Error fromJSON', e);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\tlet children = json.c ? json.c.map(child => Serializable.fromJSON(child)).filter(Boolean) : [];\n\t\tif (obj._state & Serializable.STATE_INIT)\n\t\t\tobj.addChildren(children);\n\t\telse\n\t\t\tobj.initWithChildren(children);\n\t\tobj._state |= Serializable.STATE_FROMJSON;\n\t\treturn obj;\n\t}\n\tstatic registerSerializable(Class, threeLetterType, fromJSON = null) {\n\t\tClass.prototype.threeLetterType = threeLetterType;\n\t\tassert(typeof threeLetterType === 'string' && threeLetterType.length === 3);\n\t\tif (!fromJSON)\n\t\t\tfromJSON = json => new Class(json.id);\n\t\tserializableClasses.set(threeLetterType, fromJSON);\n\t}\n}\n\nSerializable.prototype._parent = null;\nSerializable.prototype._alive = true;\nSerializable.prototype._state = 0;\nSerializable.prototype._rootType = null;\n\nSerializable.STATE_INIT = 2;\nSerializable.STATE_ADDCHILD = 4;\nSerializable.STATE_ADDPARENT = 8;\nSerializable.STATE_CLONE = 16;\nSerializable.STATE_DESTROY = 32;\nSerializable.STATE_FROMJSON = 64;\n\nSerializable.prototype.isRoot = false; // If this should be a root node\nObject.defineProperty(Serializable.prototype, 'debug', {\n\tget() {\n\t\tlet info = this.threeLetterType;\n\n\t\tthis._children.forEach((value, key) => {\n\t\t\tinfo += '|';\n\t\t\tif (key === 'prp')\n\t\t\t\tinfo += this.getChildren('prp').map(p => `${p.name}=${p._value}`).join(', ');\n\t\t\telse\n\t\t\t\tinfo += `${key}(${value.length})`;\n\t\t});\n\t\t\n\t\tinfo += '|state: ';\n\t\t\n\t\tlet states = [];\n\t\tlet logState = (state, stateString) => {\n\t\t\tif (this._state & state)\n\t\t\t\tstates.push(stateString);\n\t\t};\n\t\t\n\t\tlogState(Serializable.STATE_INIT, 'init');\n\t\tlogState(Serializable.STATE_ADDCHILD, 'add child');\n\t\tlogState(Serializable.STATE_ADDPARENT, 'add parent');\n\t\tlogState(Serializable.STATE_CLONE, 'clone');\n\t\tlogState(Serializable.STATE_DESTROY, 'destroy');\n\t\tlogState(Serializable.STATE_FROMJSON, 'from json');\n\t\t\n\t\tinfo += states.join(', ');\n\t\t\n\t\treturn info;\n\t}\n});\nObject.defineProperty(Serializable.prototype, 'debugChildren', {\n\tget() {\n\t\tlet c = [];\n\t\tthis._children.forEach((value, key) => {\n\t\t\tc = c.concat(value);\n\t\t});\n\t\t\n\t\tlet children = [];\n\t\t\n\t\tfunction createDebugObject(type) {\n\t\t\tif (type === 'gam') return new function Game(){};\n\t\t\tif (type === 'sce') return new function Scene(){};\n\t\t\tif (type === 'prt') return new function Prototype(){};\n\t\t\tif (type === 'prp') return new function Property(){};\n\t\t\tif (type === 'cda') return new function ComponentData(){};\n\t\t\tif (type === 'com') return new function Component(){};\n\t\t\tif (type === 'epr') return new function EntityPrototype(){};\n\t\t\tif (type === 'ent') return new function Entity(){};\n\t\t\tif (type === 'lvl') return new function Level(){};\n\t\t\treturn new function Other(){};\n\t\t}\n\n\t\tc.forEach(child => {\n\t\t\tlet obj = createDebugObject(child.threeLetterType);\n\t\t\t\n\t\t\tobj.debug = child.debug;\n\t\t\tobj.ref = child;\n\t\t\tlet c = child.debugChildArray;\n\t\t\tif (c && c.length > 0)\n\t\t\t\tobj.children = c;\n\t\t\tchildren.push(obj);\n\t\t});\n\n\t\treturn children;\n\t}\n});\n","import assert from '../util/assert';\nimport Serializable from './serializable';\n\nexport let serializables = {};\n\nlet DEBUG_CHANGES = 0;\nlet CHECK_FOR_INVALID_ORIGINS = 1;\n\nexport function addSerializable(serializable) {\n// @ifndef OPTIMIZE\n\tif (serializables[serializable.id] !== undefined)\n\t\tassert(false, (\"Serializable id clash \" + (serializable.id)));\n// @endif\n\tserializables[serializable.id] = serializable;\n}\n\nexport function getSerializable(id) {\n\treturn serializables[id] || null;\n}\n\nexport function hasSerializable(id) {\n\treturn Boolean(serializables[id]);\n}\n\nexport function removeSerializable(id) {\n\t/* When deleting a scene, this function is called a lot of times\n\tif (!serializables[id])\n\t\tthrow new Error('Serializable not found!');\n\t*/\n\tdelete serializables[id];\n}\n\n// reference parameters are not sent over net. they are helpers in local game instance\nexport let changeType = {\n\taddSerializableToTree: 'a', // parentId, reference\n\tsetPropertyValue: 's', // id, value\n\tdeleteSerializable: 'd', // id\n\tmove: 'm', // id, parentId\n\tdeleteAllChildren: 'c', // id\n};\nlet keyToShortKey = {\n\tid: 'i', // obj.id\n\ttype: 't', // changeType.*\n\tvalue: 'v', // value after toJSON\n\tparentId: 'p' // obj._parent.id\n};\nlet shortKeyToKey = {};\nObject.keys(keyToShortKey).forEach(k => {\n\tshortKeyToKey[keyToShortKey[k]] = k;\n});\n\nlet origin;\n\n// @ifndef OPTIMIZE\nlet previousVisualOrigin;\nfunction resetOrigin() {\n\torigin = null;\n}\nexport function getChangeOrigin() {\n\treturn origin;\n}\n// @endif\nexport function setChangeOrigin(_origin) {\n\t// @ifndef OPTIMIZE\n\tif (_origin !== origin) {\n\t\torigin = _origin;\n\t\tif (DEBUG_CHANGES && _origin && _origin !== previousVisualOrigin) {\n\t\t\tconsole.log('origin', previousVisualOrigin);\n\t\t\tpreviousVisualOrigin = _origin;\n\t\t}\n\t\t\n\t\tif (CHECK_FOR_INVALID_ORIGINS)\n\t\t\tsetTimeout(resetOrigin);\n\t}\n\t// @endif\n}\n\nlet externalChange = false;\nexport function addChange(type, reference) {\n\t// @ifndef OPTIMIZE\n\tassert(origin, 'Change without origin!');\n\t// @endif\n\t\n\tif (!reference.id) return;\n\t\n\tlet change = {\n\t\ttype,\n\t\treference,\n\t\tid: reference.id,\n\t\texternal: externalChange,\n\t\torigin // exists in editor, but not in optimized release\n\t};\n\tif (type === changeType.setPropertyValue) {\n\t\tchange.value = reference._value;\n\t} else if (type === changeType.move) {\n\t\tchange.parent = reference._parent;\n\t} else if (type === changeType.addSerializableToTree) {\n\t\tchange.parent = reference._parent;\n\t\tdelete change.id;\n\t}\n\t\n\t// @ifndef OPTIMIZE\n\tif (DEBUG_CHANGES)\n\t\tconsole.log('change', change);\n\n\tlet previousOrigin = origin;\n\t// @endif\n\n\tfor (let i = 0; i < listeners.length; ++i) {\n\t\tlisteners[i](change);\n\t}\n\n\t// @ifndef OPTIMIZE\n\tif (origin !== previousOrigin) {\n\t\tif (DEBUG_CHANGES)\n\t\t\tconsole.log('origin changed from', previousOrigin, 'to', origin && origin.constructor || origin);\n\t\torigin = previousOrigin;\n\t}\n\t// @endif\n}\n\nexport function executeExternal(callback) {\n\tsetChangeOrigin('external');\n\tif (externalChange) return callback();\n\texternalChange = true;\n\tcallback();\n\texternalChange = false;\n}\n\nlet listeners = [];\n\nexport function addChangeListener(callback) {\n\tassert(typeof callback === 'function');\n\tlisteners.push(callback);\n}\n\nexport function packChange(change) {\n\tif (change.packedChange)\n\t\treturn change.packedChange; // optimization\n\t\n\tlet packed = {};\n\ttry {\n\t\tif (change.parent)\n\t\t\tchange.parentId = change.parent.id;\n\t\t\n\t\tif (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.reference) {\n\t\t\t\tchange.value = change.reference.toJSON();\n\t\t\t} else {\n\t\t\t\tassert(false, 'invalid change of type addSerializableToTree', change);\n\t\t\t}\n\t\t} else if (change.value !== undefined) {\n\t\t\tchange.value = change.reference.propertyType.type.toJSON(change.value);\n\t\t}\n\n\t\tObject.keys(keyToShortKey).forEach(key => {\n\t\t\tif (change[key] !== undefined) {\n\t\t\t\tif (key === 'type' && change[key] === changeType.setPropertyValue) return; // optimize most common type\n\t\t\t\tpacked[keyToShortKey[key]] = change[key];\n\t\t\t}\n\t\t});\n\t} catch(e) {\n\t\tconsole.log('PACK ERROR', e);\n\t}\n\treturn packed;\n}\n\nexport function unpackChange(packedChange) {\n\tlet change = {\n\t\tpackedChange // optimization\n\t};\n\tObject.keys(packedChange).forEach(shortKey => {\n\t\tlet key = shortKeyToKey[shortKey];\n\t\tchange[key] = packedChange[shortKey];\n\t});\n\tif (!change.type)\n\t\tchange.type = changeType.setPropertyValue;\n\t\n\tif (change.type === changeType.addSerializableToTree) {\n\t\t// reference does not exist because it has not been created yet\n\t\tchange.id = change.value.id;\n\t} else {\n\t\tchange.reference = getSerializable(change.id);\n\t\tif (change.reference) {\n\t\t\tchange.id = change.reference.id;\n\t\t} else {\n\t\t\tconsole.error('received a change with unknown id', change, 'packed:', packedChange);\n\t\t\treturn null;\n\t\t}\n\t}\n\t\n\tif (change.parentId)\n\t\tchange.parent = getSerializable(change.parentId);\n\treturn change;\n}\n\nexport function executeChange(change) {\n\tlet newScene;\n\t\n\texecuteExternal(() => {\n\t\tconsole.log('execute change', change.type, change.id || change.value);\n\t\tif (change.type === changeType.setPropertyValue) {\n\t\t\tchange.reference.value = change.reference.propertyType.type.fromJSON(change.value);\n\t\t} else if (change.type === changeType.addSerializableToTree) {\n\t\t\tif (change.parent) {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value);\n\t\t\t\tchange.parent.addChild(obj);\n\t\t\t\tif (obj.threeLetterType === 'ent') {\n\t\t\t\t\tobj.localMaster = false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet obj = Serializable.fromJSON(change.value); // Scene does not need a parent\n\t\t\t\tif (obj.threeLetterType === 'sce')\n\t\t\t\t\tnewScene = obj;\n\t\t\t}\n\t\t} else if (change.type === changeType.deleteAllChildren) {\n\t\t\tchange.reference.deleteChildren();\n\t\t} else if (change.type === changeType.deleteSerializable) {\n\t\t\tchange.reference.delete();\n\t\t} else if (change.type === changeType.move) {\n\t\t\tchange.reference.move(change.parent);\n\t\t}\n\t});\n\t\n\tif (newScene)\n\t\tnewScene.play();\n}\n","// @ifndef OPTIMIZE\nimport { getChangeOrigin } from '../core/serializableManager';\n// @endif\n\nexport default function assert(condition, message) {\n\t// @ifndef OPTIMIZE\n\tif (!condition) {\n\t\tconsole.log('Assert', message, new Error().stack, '\\norigin', getChangeOrigin());\n\t\tdebugger;\n\t\tthrow new Error(message);\n\t}\n\t// @endif\n}\n","import Serializable from './serializable';\nimport { addChange, changeType, setChangeOrigin } from './serializableManager'; \nimport assert from '../util/assert';\n\n// Instance of a property\nexport default class Property extends Serializable {\n\t// set skipSerializableRegistering=true if you are not planning to add this property to the hierarchy\n\t// if you give propertyType, value in real value form\n\t// if you don't give propertyType (give it later), value as JSON form\n\tconstructor({ value, predefinedId, name, propertyType, skipSerializableRegistering = false }) {\n\t\tassert(name, 'Property without a name can not exist');\n\t\tsuper(predefinedId, skipSerializableRegistering);\n\t\tthis._initialValue = value;\n\t\tif (propertyType)\n\t\t\tthis.setPropertyType(propertyType);\n\t\telse {\n\t\t\tthis.name = name;\n\t\t\tthis._initialValueIsJSON = true;\n\t\t}\n\t}\n\tsetPropertyType(propertyType) {\n\t\tthis.propertyType = propertyType;\n\t\ttry {\n\t\t\tif (this._initialValue !== undefined)\n\t\t\t\tthis.value = this._initialValueIsJSON ? propertyType.type.fromJSON(this._initialValue) : this._initialValue;\n\t\t\telse\n\t\t\t\tthis.value = propertyType.initialValue;\n\t\t} catch(e) {\n\t\t\tconsole.log('Invalid value', e, propertyType, this);\n\t\t\tthis.value = propertyType.initialValue;\n\t\t}\n\t\tthis.name = propertyType.name;\n\t}\n\tclone(skipSerializableRegistering = false) {\n\t\treturn new Property({\n\t\t\tvalue: this.propertyType.type.clone(this.value),\n\t\t\tname: this.name,\n\t\t\tpropertyType: this.propertyType,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tv: this.type.toJSON(this.value),\n\t\t\tn: this.propertyType.name\n\t\t});\n\t}\n}\nProperty.prototype.propertyType = null;\nObject.defineProperty(Property.prototype, 'type', {\n\tget() {\n\t\treturn this.propertyType.type;\n\t}\n});\nObject.defineProperty(Property.prototype, 'value', {\n\tset(newValue) {\n\t\tthis._value = this.propertyType.validator.validate(newValue);\n\t\tthis.dispatch('change', this._value);\n\t\tif (this._rootType)\n\t\t\taddChange(changeType.setPropertyValue, this);\n\t},\n\tget() {\n\t\treturn this._value;\n\t}\n});\n\nSerializable.registerSerializable(Property, 'prp', json => {\n\treturn new Property({\n\t\tvalue: json.v,\n\t\tpredefinedId: json.id,\n\t\tname: json.n\n\t});\n});\n\nObject.defineProperty(Property.prototype, 'debug', {\n\tget() {\n\t\treturn `prp ${this.name}=${this.value}`;\n\t}\n});\n","import assert from '../util/assert';\nimport Property from './property';\n\n// info about type, validator, validatorParameters, initialValue\n\n\n\nclass PropertyType {\n\tconstructor(name, type, validator, initialValue, description, flags = [], visibleIf) {\n\t\tassert(typeof name === 'string');\n\t\tassert(name[0] >= 'a' && name[0] <= 'z', 'Name of a property must start with lower case letter.');\n\t\tassert(type && typeof type.name === 'string');\n\t\tassert(validator && typeof validator.validate === 'function');\n\t\t\n\t\tthis.name = name;\n\t\tthis.type = type;\n\t\tthis.validator = validator;\n\t\tthis.initialValue = initialValue;\n\t\tthis.description = description;\n\t\tthis.visibleIf = visibleIf;\n\t\tthis.flags = {};\n\t\tflags.forEach(f => this.flags[f.type] = f);\n\t}\n\tgetFlag(flag) {\n\t\treturn this.flags[flag.type];\n\t}\n\tcreateProperty({ value, predefinedId, skipSerializableRegistering = false } = {}) {\n\t\treturn new Property({\n\t\t\tpropertyType: this,\n\t\t\tvalue,\n\t\t\tpredefinedId,\n\t\t\tname: this.name,\n\t\t\tskipSerializableRegistering\n\t\t});\n\t}\n}\n\n/*\n\tBeautiful way of creating property types\n\t\n\toptionalParameters:\n\t\tdescription: 'Example',\n\t\tvalidator: PropertyType.\n */\nexport default function createPropertyType(propertyName, defaultValue, type, ...optionalParameters) {\n\ttype = type();\n\tlet validator = type.validators.default();\n\tlet description = '';\n\tlet flags = [];\n\tlet visibleIf = null;\n\toptionalParameters.forEach((p, idx) => {\n\t\tif (typeof p === 'string')\n\t\t\tdescription = p;\n\t\telse if (p && p.validate)\n\t\t\tvalidator = p;\n\t\telse if (p && p.isFlag)\n\t\t\tflags.push(p);\n\t\telse if (p && p.visibleIf)\n\t\t\tvisibleIf = p;\n\t\telse\n\t\t\tassert(false, 'invalid parameter ' + p + ' idx ' + idx);\n\t});\n\treturn new PropertyType(propertyName, type, validator, defaultValue, description, flags, visibleIf);\n};\n\nexport let dataType = createPropertyType;\n\ndataType.visibleIf = function(propertyName, value) {\n\tassert(typeof propertyName === 'string' && propertyName.length);\n\tassert(typeof value !== 'undefined');\n\treturn {\n\t\tvisibleIf: true,\n\t\tpropertyName,\n\t\tvalue\n\t};\n};\n\nfunction createFlag(type, func = {}) {\n\tfunc.isFlag = true;\n\tfunc.type = type;\n\treturn func;\n}\n\ncreatePropertyType.flagDegreesInEditor = createFlag('degreesInEditor');\n\nexport function createDataType({\n\tname = '',\n\tvalidators = { default: x => x }, // default must exist. if value is a reference(object), validator should copy the value.\n\ttoJSON = x => x,\n\tfromJSON = x => x,\n\tclone = x => x\n}) {\n\tassert(name, 'name missing from property type');\n\tassert(typeof validators.default === 'function','default validator missing from property type: ' + name);\n\tassert(typeof toJSON === 'function', 'invalid toJSON for property type: ' + name);\n\tassert(typeof fromJSON === 'function', 'invalid fromJSON for property type: ' + name);\n\n\tlet type = {\n\t\tname,\n\t\tvalidators,\n\t\ttoJSON,\n\t\tfromJSON,\n\t\tclone\n\t};\n\tlet createType = () => type;\n\n\tObject.keys(validators).forEach(validatorName => {\n\t\tcreateType[validatorName] = createValidator(validatorName, validators[validatorName]);\n\t\tvalidators[validatorName] = createType[validatorName];\n\t});\n\treturn createType;\n}\n\nfunction createValidator(name, validatorFunction) {\n\tlet validator = function() {\n\t\tlet parameters = [...arguments];\n\t\tlet validatorArgs = [null, ...arguments];\n\t\treturn {\n\t\t\tvalidatorName: name,\n\t\t\tvalidate: function(x) {\n\t\t\t\tvalidatorArgs[0] = x;\n\t\t\t\treturn validatorFunction.apply(null, validatorArgs);\n\t\t\t},\n\t\t\tparameters\n\t\t};\n\t};\n\tvalidator.validatorName = name;\n\tvalidator.validate = validatorFunction;\n\treturn validator;\n}\n","export default class Vector {\n\tconstructor(x, y) {\n\t\tthis.x = x || 0;\n\t\tthis.y = y || 0;\n\t}\n\tadd(vec) {\n\t\tthis.x += vec.x;\n\t\tthis.y += vec.y;\n\t\treturn this;\n\t}\n\tsubtract(vec) {\n\t\tthis.x -= vec.x;\n\t\tthis.y -= vec.y;\n\t\treturn this;\n\t}\n\tmultiply(vec) {\n\t\tthis.x *= vec.x;\n\t\tthis.y *= vec.y;\n\t\treturn this;\n\t}\n\tmultiplyScalar(scalar) {\n\t\tthis.x *= scalar;\n\t\tthis.y *= scalar;\n\t\treturn this;\n\t}\n\tdivide(vec) {\n\t\tthis.x /= vec.x;\n\t\tthis.y /= vec.y;\n\t\treturn this;\n\t}\n\tdivideScalar(scalar) {\n\t\tthis.x /= scalar;\n\t\tthis.y /= scalar;\n\t\treturn this;\n\t}\n\tdot(vec) {\n\t\treturn this.x * vec.x + this.y * vec.y;\n\t}\n\tlength() {\n\t\treturn Math.sqrt(this.x * this.x + this.y * this.y);\n\t}\n\tlengthSq() {\n\t\treturn this.x * this.x + this.y * this.y;\n\t}\n\tsetLength(newLength) {\n\t\tlet oldLength = this.length();\n\n\t\tif (oldLength === 0) {\n\t\t\tthis.x = newLength;\n\t\t\tthis.y = 0;\n\t\t} else {\n\t\t\tthis.multiplyScalar(newLength / oldLength);\n\t\t}\n\t\treturn this;\n\t}\n\tgetProjectionOn(vec) {\n\t\tlet length = vec.length();\n\t\tif (length === 0)\n\t\t\treturn this.clone();\n\t\telse\n\t\t\treturn vec.clone().multiplyScalar(this.dot(vec) / (length * length));\n\t}\n\tdistance(vec) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t}\n\tdistanceSq(vec) {\n\t\tlet dx = this.x - vec.x,\n\t\t\tdy = this.y - vec.y;\n\t\treturn dx * dx + dy * dy;\n\t}\n\tnormalize() {\n\t\treturn this.setLength(1);\n\t}\n\thorizontalAngle() {\n\t\treturn Math.atan2(this.y, this.x);\n\t}\n\tverticalAngle() {\n\t\treturn Math.atan2(this.x, this.y);\n\t}\n\trotate(angle) {\n\t\tlet x = this.x * Math.cos(angle) - this.y * Math.sin(angle);\n\t\tthis.y = this.x * Math.sin(angle) + this.y * Math.cos(angle);\n\t\tthis.x = x;\n\n\t\treturn this;\n\t}\n\trotateTo(angle) {\n\t\treturn this.rotate(angle-this.verticalAngle());\n\t}\n\tisEqualTo(vec) {\n\t\treturn this.x === vec.x && this.y === vec.y;\n\t}\n\tisZero() {\n\t\treturn !this.x && !this.y;\n\t}\n\tclone() {\n\t\treturn new Vector(this.x, this.y);\n\t}\n\tset(vec) {\n\t\tthis.x = vec.x;\n\t\tthis.y = vec.y;\n\t\treturn this;\n\t}\n\ttoString() {\n\t\treturn `[${this.x}, ${this.y}]`;\n\t}\n\ttoArray() {\n\t\treturn [this.x, this.y];\n\t}\n}\nVector.fromObject = function(obj) {\n\treturn new Vector(obj.x, obj.y);\n};\nVector.fromArray = function(obj) {\n\treturn new Vector(obj[0], obj[1]);\n};\n","import assert from '../util/assert';\nimport { createDataType, dataType } from './propertyType';\nimport Vector from '../util/vector';\n\nfunction validateFloat(val) {\n\tif (isNaN(val) || val === Infinity || val === -Infinity)\n\t\tthrow new Error('Invalid float: ' + val);\n}\n\nconst FLOAT_JSON_PRECISION = 4;\nconst FLOAT_JSON_PRECISION_MULTIPLIER = Math.pow(10, FLOAT_JSON_PRECISION);\nconst FLOAT_DELTA = 0.0000001;\n\ndataType.float = createDataType({\n\tname: 'float',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseFloat(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t},\n\t\tmodulo(x, min, max) {\n\t\t\tx = parseFloat(x);\n\t\t\tvalidateFloat(x);\n\t\t\t\n\t\t\tlet range = max - min;\n\t\t\t\n\t\t\tif (x < min) {\n\t\t\t\tx += (((min - x) / range | 0) + 1) * range;\n\t\t\t} else if (x > max - FLOAT_DELTA) {\n\t\t\t\tx -= (((x - max) / range | 0) + 1) * range;\n\t\t\t}\n\t\t\t\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => Math.round(x*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER,\n\tfromJSON: x => x\n});\ndataType.int = createDataType({\n\tname: 'int',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tx = parseInt(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn x;\n\t\t},\n\t\t// PropertyType.float.range(min, max)\n\t\trange(x, min, max) {\n\t\t\tx = parseInt(x);\n\t\t\tvalidateFloat(x);\n\t\t\treturn Math.min(max, Math.max(min, x));\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\ndataType.vector = createDataType({\n\tname: 'vector',\n\tvalidators: {\n\t\tdefault(vec) {\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tif (!(vec instanceof Vector))\n\t\t\t\tthrow new Error();\n\t\t\t// @endif\n\t\t\tvec = vec.clone();\n\t\t\t// @ifndef OPTIMIZE\n\t\t\tvec.x = parseFloat(vec.x);\n\t\t\tvec.y = parseFloat(vec.y);\n\t\t\tvalidateFloat(vec.x);\n\t\t\tvalidateFloat(vec.y);\n\t\t\t// @endif\n\t\t\treturn vec;\n\t\t}\n\t},\n\ttoJSON: vec => ({\n\t\tx: Math.round(vec.x*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER,\n\t\ty: Math.round(vec.y*FLOAT_JSON_PRECISION_MULTIPLIER)/FLOAT_JSON_PRECISION_MULTIPLIER\n\t}),\n\tfromJSON: vec => Vector.fromObject(vec),\n\tclone: vec => vec.clone()\n});\n\ndataType.string = createDataType({\n\tname: 'string',\n\tvalidators: {\n\t\tdefault: x => x ? String(x) : ''\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n\ndataType.bool = createDataType({\n\tname: 'bool',\n\tvalidators: {\n\t\tdefault(x) {\n\t\t\tif (typeof x !== 'boolean')\n\t\t\t\tthrow new Error();\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x ? 1 : 0,\n\tfromJSON: x => !!x\n});\n\ndataType.enum = createDataType({\n\tname: 'enum',\n\tvalidators: {\n\t\tdefault() {\n\t\t\tassert(false, `also specify enum values with Prop.enum.values('value1', 'value2', ...)`);\n\t\t},\n\t\tvalues(x, ...values) {\n\t\t\tif (!Array.isArray(values))\n\t\t\t\tthrow new Error();\n\t\t\tif (typeof x !== 'string')\n\t\t\t\tthrow new Error('val should be string');\n\t\t\tif (values.indexOf(x) < 0)\n\t\t\t\tthrow new Error(`value ${x} not in enum: [${values}]`);\n\t\t\treturn x;\n\t\t}\n\t},\n\ttoJSON: x => x,\n\tfromJSON: x => x\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nexport { default as Prop } from './propertyType';\n\nexport default class PropertyOwner extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tassert(Array.isArray(this.constructor._propertyTypes), 'call PropertyOwner.defineProperties after class definition');\n\t\tsuper(predefinedId);\n\t\tthis._properties = {};\n\t}\n\t// Just a helper\n\tinitWithPropertyValues(values = {}) {\n\t\tlet children = [];\n\t\t\n\t\tObject.keys(values).forEach(propName => {\n\t\t\tlet propertyType = this.constructor._propertyTypesByName[propName];\n\t\t\tassert(propertyType, 'Invalid property ' + propName);\n\t\t\tchildren.push(propertyType.createProperty({\n\t\t\t\tvalue: values[propName]\n\t\t\t}));\n\t\t});\n\t\tthis.initWithChildren(children);\n\t\treturn this;\n\t}\n\tinitWithChildren(children = []) {\n\t\tassert(!(this._state & Serializable.STATE_INIT), 'init already done');\n\t\tthis._state |= Serializable.STATE_INIT;\n\t\t\n\t\tlet propChildren = [];\n\t\tlet otherChildren = [];\n\t\t// Separate Property children and other children\n\t\tchildren.forEach(child => {\n\t\t\tif (child.threeLetterType === 'prp') {\n\t\t\t\tpropChildren.push(child);\n\t\t\t} else {\n\t\t\t\totherChildren.push(child);\n\t\t\t}\n\t\t});\n\t\tsuper.addChildren(otherChildren);\n\t\t\n\t\tlet invalidPropertiesCount = 0;\n\t\t\n\t\t// Make sure Properties have a PropertyType. They don't work without it.\n\t\tpropChildren.filter(prop => !prop.propertyType).forEach(prop => {\n\t\t\tif (!this.constructor._propertyTypesByName[prop.name]) {\n\t\t\t\tconsole.log('Property of that name not defined', this.id, prop.name, this);\n\t\t\t\tinvalidPropertiesCount++;\n\t\t\t\tprop.isInvalid = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tprop.setPropertyType(this.constructor._propertyTypesByName[prop.name]);\n\t\t});\n\t\tif (invalidPropertiesCount)\n\t\t\tpropChildren = propChildren.filter(p => !p.isInvalid);\n\t\t\n\t\t// Make sure all PropertyTypes have a matching Property\n\t\tlet nameToProp = {};\n\t\tpropChildren.forEach(c => nameToProp[c.name] = c);\n\t\tthis.constructor._propertyTypes.forEach(propertyType => {\n\t\t\tif (!nameToProp[propertyType.name])\n\t\t\t\tpropChildren.push(propertyType.createProperty());\n\t\t});\n\t\t\n\t\tsuper.addChildren(propChildren);\n\t};\n\taddChild(child) {\n\t\tassert(this._state & Serializable.STATE_INIT, this.constructor.componentName || this.constructor + ' requires that initWithChildren will be called before addChild');\n\t\tsuper.addChild(child);\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.constructor._propertyTypesByName[child.name]) {\n\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.constructor._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t\tassert(this._properties[child.propertyType.name] === undefined, 'Property already added');\n\t\t\tthis._properties[child.propertyType.name] = child;\n\t\t}\n\t};\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\t\tthis._properties = {};\n\t\treturn true;\n\t}\n\t// idx is optional\n\tdeleteChild(child, idx) {\n\t\tassert(child.threeLetterType !== 'prp', 'Can not delete just one Property child.');\n\t\tsuper.deleteChild(child, idx);\n\t}\n}\n\nPropertyOwner.defineProperties = function(Class, propertyTypes) {\n\tClass._propertyTypes = propertyTypes;\n\tClass._propertyTypesByName = {};\n\tpropertyTypes.forEach(propertyType => {\n\t\tassert(Class.prototype[propertyType.name] === undefined, 'Property name ' + propertyType.name + ' clashes');\n\t\tClass._propertyTypesByName[propertyType.name] = propertyType;\n\t\tObject.defineProperty(Class.prototype, propertyType.name, {\n\t\t\tget() {\n\t\t\t\treturn this._properties[propertyType.name].value;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis._properties[propertyType.name].value = value;\n\t\t\t}\n\t\t});\n\t});\n};\n","import Serializable from './serializable';\nimport assert from '../util/assert';\n\nconst ALIVE_ERROR = 'entity is already dead';\n\nexport default class Entity extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\t\tthis.components = new Map(); // name -> array\n\t\tthis.sleeping = false;\n\t\tthis.prototype = null; // should be set immediately after constructor\n\t\tthis.localMaster = true; // set false if entity is controlled over the net\n\t}\n\n\t// Get the first component of given name\n\tgetComponent(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tlet components = this.components.get(name);\n\t\tif (components !== undefined)\n\t\t\treturn components[0];\n\t\telse\n\t\t\treturn null;\n\t}\n\n\t// Get all components with given name\n\tgetComponents(name) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\treturn this.components.get(name) || [];\n\t}\n\t\n\tgetListOfAllComponents() {\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value);\n\t\t});\n\t\treturn components;\n\t}\n\t\n\tclone() {\n\t\tlet entity = new Entity();\n\t\tentity.prototype = this.prototype.clone();\n\t\tentity.sleeping = this.sleeping;\n\t\tlet components = [];\n\t\tthis.components.forEach((value, key) => {\n\t\t\tcomponents.push(...value.map(c => c.clone()));\n\t\t});\n\t\tentity.addComponents(components);\n\t\treturn entity;\n\t}\n\n\t/*\n\tAdds multiple components as an array to this Entity.\n\tUses addComponent internally.\n\tInitializes components after all components are added.\n\t*/\n\taddComponents(components) {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tassert(Array.isArray(components), 'Parameter is not an array.');\n\n\t\tfor (let i = 0; i < components.length; i++) {\n\t\t\tlet componentList = this.components.get(components[i]._name) || this.components.set(components[i]._name, []).get(components[i]._name);\n\t\t\tcomponentList.push(components[i]);\n\t\t\tcomponents[i].entity = this;\n\t\t\tcomponents[i]._parent = this;\n\t\t}\n\t\t\n\t\tif (!this.sleeping)\n\t\t\tEntity.initComponents(components);\n\t\treturn this;\n\t}\n\tstatic initComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._preInit();\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._init();\n\t}\n\tstatic makeComponentsSleep(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i]._sleep();\n\t}\n\tstatic deleteComponents(components) {\n\t\tfor (let i = 0; i < components.length; i++)\n\t\t\tcomponents[i].delete();\n\t}\n\tsleep() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (this.sleeping) return false;\n\t\t\n\t\tthis.components.forEach((value, key) => Entity.makeComponentsSleep(value));\n\t\t\n\t\tthis.sleeping = true;\n\t\treturn true;\n\t}\n\twakeUp() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tif (!this.sleeping) return false;\n\n\t\tthis.components.forEach((value, key) => Entity.initComponents(value));\n\n\t\tthis.sleeping = false;\n\t\treturn true;\n\t}\n\tdelete() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\tthis.sleep();\n\t\tif (!super.delete()) return false;\n\t\t\n\t\tthis.components.forEach((value, key) => Entity.deleteComponents(value));\n\t\tthis.components.clear();\n\t\t\n\t\treturn true;\n\t}\n\tdeleteComponent(component) {\n\t\tlet array = this.getComponents(component.constructor.componentName);\n\t\tlet idx = array.indexOf(component);\n\t\tassert(idx >= 0);\n\t\tif (!this.sleeping)\n\t\t\tcomponent._sleep();\n\t\tcomponent.delete();\n\t\tarray.splice(idx, 1);\n\t\treturn this;\n\t}\n\tsetRootType(rootType) {\n\t\tif (this._rootType === rootType)\n\t\t\treturn;\n\t\tthis._rootType = rootType;\n\n\t\tlet i;\n\t\tthis.components.forEach((value, key) => {\n\t\t\tfor (i = 0; i < value.length; ++i) {\n\t\t\t\tvalue[i].setRootType(rootType);\n\t\t\t}\n\t\t});\n\t}\n\ttoJSON() {\n\t\tassert(this._alive, ALIVE_ERROR);\n\t\t\n\t\tlet components = [];\n\t\tthis.components.forEach(compArray => {\n\t\t\tcompArray.forEach(comp => {\n\t\t\t\tcomponents.push(comp.toJSON());\n\t\t\t});\n\t\t});\n\t\t\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcomp: components,\n\t\t\tproto: this.prototype.id\n\t\t});\n\t}\n}\nObject.defineProperty(Entity.prototype, 'position', {\n\tget() {\n\t\treturn this.getComponent('Transform').position;\n\t},\n\tset(position) {\n\t\tthis.getComponent('Transform').position = position;\n\t}\n});\n\nSerializable.registerSerializable(Entity, 'ent', json => {\n\tconsole.log('creating entity from json', json);\n\tlet entity = new Entity(json.id);\n\tentity.prototype = getSerializable(json.proto);\n\tconsole.log('created entity from json', entity);\n\tif (json.comp) {\n\t\tentity.addComponents(json.comp.map(Serializable.fromJSON));\n\t}\n\treturn entity;\n});\n","import Serializable, { createStringId } from './serializable';\nimport assert from '../util/assert';\nimport { componentClasses, Component } from './component';\nimport { isClient } from '../util/environment';\n\nexport default class ComponentData extends Serializable {\n\tconstructor(componentClassName, predefinedId = false, predefinedComponentId = false) {\n\t\tthis.name = componentClassName;\n\t\tthis.componentClass = componentClasses.get(this.name);\n\t\tassert(this.componentClass, 'Component class not defined: ' + componentClassName);\n\t\tsuper(predefinedId);\n\t\tif (!this.componentClass.allowMultiple)\n\t\t\tpredefinedComponentId = '_' + componentClassName;\n\t\tthis.componentId = predefinedComponentId || createStringId('cid', 10); // what will be the id of component created from this componentData\n\t}\n\taddChild(child) {\n\t\tif (child.threeLetterType === 'prp') {\n\t\t\tif (!child.propertyType) {\n\t\t\t\tif (!this.componentClass._propertyTypesByName[child.name]) {\n\t\t\t\t\tif (isClient)\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, child, this);\n\t\t\t\t\telse\n\t\t\t\t\t\tconsole.log('Property of that name not defined', this.id, this.name, child.name);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tchild.setPropertyType(this.componentClass._propertyTypesByName[child.name]);\n\t\t\t}\n\t\t}\n\t\tsuper.addChild(child);\n\t\treturn this;\n\t};\n\tclone(options) {\n\t\tlet newComponentId = (options && options.cloneComponentId) ? this.componentId : false;\n\t\tlet obj = new ComponentData(this.name, false, newComponentId);\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tchildren.push(child.clone());\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tcid: this.componentId,\n\t\t\tn: this.name\n\t\t});\n\t}\n\t/*\n\tReturns a list of Properties.\n\tThose which don't have an id are temporary properties generated from parents.\n\tDon't set _depth.\n\t */\n\tgetInheritedProperties(_depth = 0) {\n\t\tlet properties = {};\n\n\t\t// properties from parent\n\t\tlet parentComponentData = this.getParentComponentData();\n\t\tif (parentComponentData)\n\t\t\tparentComponentData.getInheritedProperties(_depth + 1).forEach(prop => properties[prop.name] = prop);\n\t\t\n\t\t// properties from this. override properties of parents\n\t\tthis.getChildren('prp').forEach(prop => {\n\t\t\tif (_depth === 0)\n\t\t\t\tproperties[prop.name] = prop;\n\t\t\telse\n\t\t\t\tproperties[prop.name] = prop.clone(true);\n\t\t});\n\t\t\n\t\t// fill from propertyType\n\t\tif (_depth === 0) {\n\t\t\treturn this.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn properties[propertyType.name] || propertyType.createProperty({\n\t\t\t\t\tskipSerializableRegistering: true\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn Object.keys(properties).map(key => properties[key]);\n\t\t}\n\t}\n\tgetParentComponentData() {\n\t\tif (!this._parent) return null;\n\t\tlet parentPrototype = this._parent.getParentPrototype();\n\t\twhile (parentPrototype) {\n\t\t\tlet parentComponentData = parentPrototype.findChild('cda', componentData => componentData.componentId === this.componentId);\n\t\t\tif (parentComponentData)\n\t\t\t\treturn parentComponentData;\n\t\t\telse\n\t\t\t\tparentPrototype = parentPrototype.getParentPrototype();\n\t\t}\n\t\treturn null;\n\t}\n\tgetPropertyOrCreate(name) {\n\t\tlet property = this.findChild('prp', prp => prp.name === name);\n\t\tif (!property) {\n\t\t\tproperty = this.componentClass._propertyTypesByName[name].createProperty();\n\t\t\tthis.addChild(property);\n\t\t}\n\t\treturn property;\n\t}\n\tgetProperty(name) {\n\t\treturn this.findChild('prp', prp => prp.name === name);\n\t}\n\tsetValue(propertyName, value) {\n\t\tthis.getPropertyOrCreate(propertyName).value = value;\n\t\treturn this;\n\t}\n\tgetValue(name) {\n\t\tlet property = this.getProperty(name);\n\t\tif (property)\n\t\t\treturn property.value;\n\t\tlet parent = this.getParentComponentData();\n\t\t\n\t\tif (parent)\n\t\t\treturn parent.getValue(name);\n\t\t\n\t\treturn this.componentClass._propertyTypesByName[name].initialValue;\n\t}\n\tcreateComponent() {\n\t\tlet properties = this.getInheritedProperties();\n\t\tlet values = {};\n\t\tproperties.forEach(prop => {\n\t\t\tvalues[prop.name] = prop.value;\n\t\t});\n\t\tlet component = Component.create(this.name, values);\n\t\tcomponent._componentId = this.componentId;\n\t\treturn component;\n\t}\n}\nSerializable.registerSerializable(ComponentData, 'cda', json => {\n\treturn new ComponentData(json.n, json.id, json.cid);\n});\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport { getSerializable } from './serializableManager';\nimport Prop from './propertyType';\nimport PropertyOwner from './propertyOwner';\nimport ComponentData from './componentData';\nimport Entity from './entity';\nimport { game } from './game';\nimport { Component } from './component';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Prototype extends PropertyOwner {\n\tconstructor() {\n\t\tsuper(...arguments);\n\t\t\n\t\tthis.previouslyCreatedEntity = null;\n\t}\n\t\n\taddChild(child) {\n\t\tif (child.threeLetterType === 'cda' && !child.componentClass.allowMultiple)\n\t\t\tassert(this.findChild('cda', cda => cda.componentId === child.componentId) === null, `Can't have multiple ${child.name} components. See Component.allowMultiple`);\n\t\tsuper.addChild(child);\n\t}\n\tgetParentPrototype() {\n\t\treturn this._parent && this._parent.threeLetterType === 'prt' ? this._parent : null;\n\t}\n\t\n\t/*\n\tReturns JSON:\n\t[\n\t\t{\n\t\t\townComponent: false, // component of a parent prototype\n\t\t\tcomponentClass: [object Object],\n\t\t\tcomponentId: <componentId>,\n\t\t\tthreeLetterType: 'icd',\n\t \t\tgeneratedForPrototype: <this>,\n\t\t\tproperties: [\n\t\t\t\t{ id missing }\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t ownComponentData: <ComponentData> || null, // null if this prototype has 0 properties defined\n\t\t\t componentClass: [object Object],\n\t\t\t componentId: <componentId>,\n\t\t\t threeLetterType: 'icd',\n\t\t\t generatedForPrototype: <this>,\n\t\t\t properties: [\n\t\t\t \t{ id found if own property } // some properties might be from parent prototypes and thus missing id\n\t\t\t ]\n\t\t }\n\t]\n\t */\n\tgetInheritedComponentDatas(filter = null) {\n\t\tlet data = getDataFromPrototype(this, this, filter);\n\t\tlet array = Object.keys(data).map(key => data[key]);\n\t\tlet inheritedComponentData;\n\t\tfor (let i = 0; i < array.length; ++i) {\n\t\t\tinheritedComponentData = array[i];\n\t\t\tinheritedComponentData.properties = inheritedComponentData.componentClass._propertyTypes.map(propertyType => {\n\t\t\t\treturn inheritedComponentData.propertyHash[propertyType.name]\n\t\t\t\t\t|| propertyType.createProperty({ skipSerializableRegistering: true });\n\t\t\t});\n\t\t\tdelete inheritedComponentData.propertyHash;\n\t\t}\n\n\t\treturn array.sort(sortInheritedComponentDatas);\n\t}\n\t\n\tcreateAndAddPropertyForComponentData(inheritedComponentData, propertyName, propertyValue) {\n\t\tlet propertyType = inheritedComponentData.componentClass._propertyTypesByName[propertyName];\n\t\tassert(propertyType, 'Invalid propertyName', propertyName, inheritedComponentData);\n\t\tlet componentData = this.findChild('cda', componentData => componentData.componentId === inheritedComponentData.componentId);\n\t\tlet componentDataIsNew = false;\n\t\tif (!componentData) {\n\t\t\tconsole.log('no component data. create one', this, inheritedComponentData);\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.componentClass.componentName, false, inheritedComponentData.componentId);\n\t\t\tcomponentDataIsNew = true;\n\t\t}\n\t\tlet property = componentData.findChild('prp', property => property.name === propertyName);\n\t\tif (property) {\n\t\t\tproperty.value = propertyValue;\n\t\t\treturn property;\n\t\t}\n\n\t\tproperty = propertyType.createProperty({\n\t\t\tvalue: propertyValue,\n\t\t});\n\t\tcomponentData.addChild(property);\n\t\t\n\t\tif (componentDataIsNew)\n\t\t\tthis.addChild(componentData);\n\t\t\n\t\treturn property;\n\t}\n\t\n\tfindComponentDataByComponentId(componentId, alsoFindFromParents = false) {\n\t\tlet child = this.findChild('cda', componentData => componentData.componentId === componentId);\n\t\tif (child)\n\t\t\treturn child;\n\t\tif (alsoFindFromParents) {\n\t\t\tlet parent = this.getParentPrototype();\n\t\t\tif (parent)\n\t\t\t\treturn parent.findComponentDataByComponentId(componentId, alsoFindFromParents);\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tgetOwnComponentDataOrInherit(componentId) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, false);\n\t\tif (!componentData) {\n\t\t\tlet inheritedComponentData = this.findComponentDataByComponentId(componentId, true);\n\t\t\tif (!inheritedComponentData)\n\t\t\t\treturn null;\n\t\t\t\n\t\t\tcomponentData = new ComponentData(inheritedComponentData.name, false, componentId);\n\t\t\tthis.addChild(componentData);\n\t\t}\n\t\treturn componentData\n\t}\n\t\n\tfindOwnProperty(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId);\n\t\tif (componentData) {\n\t\t\treturn componentData.getProperty(propertyName);\n\t\t}\n\t\treturn null;\n\t}\n\t\n\tcreateEntity() {\n\t\tlet entity = new Entity();\n\t\tlet inheritedComponentDatas = this.getInheritedComponentDatas();\n\t\tlet components = inheritedComponentDatas.map(Component.createWithInheritedComponentData);\n\t\tentity.addComponents(components);\n\t\tentity.prototype = this;\n\t\t\n\t\tthis.previouslyCreatedEntity = entity;\n\t\treturn entity;\n\t}\n\t\n\tgetValue(componentId, propertyName) {\n\t\tlet componentData = this.findComponentDataByComponentId(componentId, true);\n\t\tif (componentData)\n\t\t\treturn componentData.getValue(propertyName);\n\t\telse\n\t\t\treturn undefined;\n\t}\n\t\n\tcountEntityPrototypes(findParents = false) {\n\t\tif (this.threeLetterType !== 'prt')\n\t\t\treturn 0;\n\t\t\n\t\tlet count = 0;\n\t\tlet levels = game.getChildren('lvl');\n\t\tfor (let i = levels.length-1; i >= 0; i--) {\n\t\t\tlet entityPrototypes = levels[i].getChildren('epr');\n\t\t\tfor (let j = entityPrototypes.length-1; j >= 0; j--) {\n\t\t\t\tif (entityPrototypes[j].prototype === this)\n\t\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (findParents)\n\t\t\tthis.forEachChild('prt', prt => count += prt.countEntityPrototypes(true));\n\t\t\n\t\treturn count;\n\t}\n\t\n\tdelete() {\n\t\tthis._gameRoot = this._gameRoot || this.getRoot();\n\t\tif (!super.delete()) return false;\n\t\tif (this.threeLetterType === 'prt' && this._gameRoot.threeLetterType === 'gam') {\n\t\t\tthis._gameRoot.forEachChild('lvl', lvl => {\n\t\t\t\tlet items = lvl.getChildren('epr');\n\t\t\t\tfor (let i = items.length-1; i >= 0; i--) {\n\t\t\t\t\tif (items[i].prototype === this) {\n\t\t\t\t\t\tlvl.deleteChild(items[i], i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.previouslyCreatedEntity = null;\n\t\treturn true;\n\t}\n}\nPropertyOwner.defineProperties(Prototype, propertyTypes);\n\nPrototype.create = function(name) {\n\treturn new Prototype().initWithPropertyValues({ name: name });\n};\n\nSerializable.registerSerializable(Prototype, 'prt');\n\n\nfunction getDataFromPrototype(prototype, originalPrototype, filter, _depth = 0) {\n\tlet data;\n\n\tlet parentPrototype = prototype.getParentPrototype();\n\tif (parentPrototype)\n\t\tdata = getDataFromPrototype(parentPrototype, originalPrototype, filter, _depth + 1);\n\telse\n\t\tdata = {}; // Top level\n\t\n\tlet componentDatas = prototype.getChildren('cda');\n\tif (filter)\n\t\tcomponentDatas = componentDatas.filter(filter);\n\tlet componentData;\n\tfor (let i = 0; i < componentDatas.length; ++i) {\n\t\tcomponentData = componentDatas[i];\n\n\t\tif (!data[componentData.componentId]) {\n\t\t\t// Most parent version of this componentId\n\t\t\tdata[componentData.componentId] = {\n\t\t\t\t// ownComponent = true if the original prototype is the first one introducing this componentId\n\t\t\t\townComponentData: _depth === 0 ? componentData : null, // will be given value if original prototype has this componentId\n\t\t\t\tcomponentClass: componentData.componentClass,\n\t\t\t\tcomponentId: componentData.componentId,\n\t\t\t\tpropertyHash: {},\n\t\t\t\tthreeLetterType: 'icd',\n\t\t\t\tgeneratedForPrototype: originalPrototype,\n\t\t\t};\n\t\t}\n\t\t\n\t\tlet propertyHash = data[componentData.componentId].propertyHash;\n\t\t\n\t\tlet properties = componentData.getChildren('prp');\n\t\tlet property;\n\t\tfor (let j = 0; j < properties.length; ++j) {\n\t\t\tproperty = properties[j];\n\t\t\t// Newest version of a property always overrides old property\n\t\t\tpropertyHash[property.name] = _depth === 0 ? property : property.clone(true);\n\t\t}\n\t};\n\n\treturn data;\n}\n\nfunction sortInheritedComponentDatas(a, b) {\n\treturn a.componentClass.componentName.localeCompare(b.componentClass.componentName);\n}\n","import Serializable from './serializable'\nimport { addChange, changeType, setChangeOrigin } from './serializableManager';\nimport Prototype from '../core/prototype'\nimport assert from '../util/assert'\nimport PropertyOwner, { Prop } from '../core/propertyOwner';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nlet game = null; // only one game at the time\nexport { game };\n\nlet isClient = typeof window !== 'undefined';\n\nexport default class Game extends PropertyOwner {\n\tconstructor(predefinedId) {\n\t\tif (isClient) {\n\t\t\tif (game) {\n\t\t\t\ttry {\n\t\t\t\t\tgame.delete();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn('Deleting old game failed', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\tgame = this;\n\t\t}\n\t\t\n\t\tif (predefinedId)\n\t\t\tconsole.log('game import');\n\t\telse\n\t\t\tconsole.log('game created');\n\t\t\n\t\tsuper(...arguments);\n\t}\n\tinitWithChildren() {\n\t\tsuper.initWithChildren(...arguments);\n\t\taddChange(changeType.addSerializableToTree, this);\n\t}\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\t\t\n\t\tif (game === this)\n\t\t\tgame = null;\n\t\tconsole.log('game.delete');\n\t\t\n\t\treturn true;\n\t}\n}\nPropertyOwner.defineProperties(Game, propertyTypes);\n\nGame.prototype.isRoot = true;\n\nSerializable.registerSerializable(Game, 'gam');\n","import assert from '../util/assert';\nimport { isClient } from '../util/environment';\n\nlet p2;\nif (isClient)\n\tp2 = window.p2;\nelse\n\tp2 = require('../src/external/p2');\n\nexport default p2;\n\nexport function createWorld(owner, options) {\n\tassert(!owner._p2World);\n\towner._p2World = new p2.World({\n\t\tgravity: [0, 9.81]\n\t});\n\n\t// Stress test says that Body sleeping performs better than Island sleeping when idling.\n\towner._p2World.sleepMode = p2.World.BODY_SLEEPING;\n}\n// const MAX_PHYSICS_DT = 0.2;\nconst PHYSICS_DT = 1 / 60;\nexport function updateWorld(owner, dt) {\n\towner._p2World.step(PHYSICS_DT, dt, 10);\n}\nexport function deleteWorld(owner) {\n\tif (owner._p2World)\n\t\towner._p2World.clear()\n\tdelete owner._p2World;\n\tdelete owner._p2Materials;\n}\nexport function addBody(owner, body) {\n\towner._p2World.addBody(body);\n}\nexport function deleteBody(owner, body) {\n\towner._p2World.removeBody(body);\n}\n\n// export function addContactMaterial(owner, A, B, options) {\n// \towner._p2World.addContactMaterial(new p2.ContactMaterial(A, B, options));\n// }\n\nconst defaultMaterialOptions = {\n\tfriction: 0.3,\n\trestitution: 0,\n\tstiffness: 1e6,\n\trelaxation: 4,\n\tfrictionStiffness: 1e6,\n\tfrictionRelaxation: 4,\n\tsurfaceVelocity: 0\n};\n\nexport function createMaterial(owner, options) {\n\tif (!owner._p2Materials)\n\t\towner._p2Materials = {};\n\tlet materials = owner._p2Materials;\n\toptions = Object.assign({}, defaultMaterialOptions, options);\n\tlet hash = [\n\t\toptions.friction,\n\t\toptions.restitution,\n\t\toptions.stiffness,\n\t\toptions.relaxation,\n\t\toptions.frictionStiffness,\n\t\toptions.frictionRelaxation,\n\t\toptions.surfaceVelocity\n\t].join(';');\n\t\n\tif (materials[hash])\n\t\treturn materials[hash];\n\t\n\tlet material = new p2.Material();\n\tmaterial.options = options;\n\tmaterials[hash] = material;\n\t\n\tfor (var h in materials) {\n\t\tlet m = materials[h];\n\t\tlet o1 = material.options;\n\t\tlet o2 = m.options;\n\t\tlet contactMaterial = new p2.ContactMaterial(material, m, {\n\t\t\tfriction:\t\t\t\tMath.min(o1.friction, o2.friction),\n\t\t\trestitution:\t\t\to1.restitution * o2.restitution,\n\t\t\tstiffness:\t\t\t\tMath.min(o1.stiffness, o2.stiffness),\n\t\t\trelaxation:\t\t\t\t(o1.relaxation + o2.relaxation) / 2,\n\t\t\tfrictionStiffness:\t\tMath.min(o1.frictionStiffness, o2.frictionStiffness),\n\t\t\tfrictionRelaxation:\t\t(o1.frictionRelaxation + o2.frictionRelaxation) / 2,\n\t\t\tsurfaceVelocity:\t\tMath.max(o1.surfaceVelocity, o2.surfaceVelocity)\n\t\t});\n\t\towner._p2World.addContactMaterial(contactMaterial);\n\t}\n\t\n\treturn material;\n}\n","import Serializable from './serializable';\nimport Entity from './entity';\nimport assert from '../util/assert';\nimport { game } from './game';\nimport { addChange, changeType, setChangeOrigin } from './serializableManager';\nimport { isClient } from '../util/environment';\n\n// import { createWorld, deleteWorld, updateWorld } from '../feature/physicsMatter';\n// import { createWorld, deleteWorld, updateWorld } from '../feature/physicsJs';\nimport { createWorld, deleteWorld, updateWorld } from '../feature/physics';\n\nlet scene = null;\nexport { scene };\n\nconst physicsOptions = {\n\tenableSleeping: true\n};\n\nexport default class Scene extends Serializable {\n\tconstructor(predefinedId = false) {\n\t\tif (isClient) {\n\t\t\tif (scene) {\n\t\t\t\ttry {\n\t\t\t\t\tscene.delete();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.warn('Deleting old scene failed', e);\n\t\t\t\t}\n\t\t\t}\n\t\t\tscene = this;\n\t\t\t\n\t\t\tthis.canvas = document.querySelector('canvas.anotherCanvas');\n\t\t\tthis.context = this.canvas.getContext('2d');\n\t\t}\n\t\tthis.level = null;\n\t\t\n\t\t// To make component based entity search fast:\n\t\tthis.components = new Map(); // componentName -> Set of components\n\t\t\n\t\tthis.animationFrameId = null;\n\t\tthis.playing = false;\n\t\tthis.time = 0;\n\t\tthis.won = false;\n\t\t\n\t\tsuper(predefinedId);\n\t\taddChange(changeType.addSerializableToTree, this);\n\n\t\tif (predefinedId)\n\t\t\tconsole.log('scene import');\n\t\telse\n\t\t\tconsole.log('scene created');\n\n\t\tcreateWorld(this, physicsOptions);\n\t\t\n\t\tthis.draw();\n\t}\n\twin() {\n\t\tthis.won = true;\n\t}\n\tanimFrame(playCalled) {\n\t\tthis.animationFrameId = null;\n\t\tif (!this._alive || !this.playing) return;\n\t\t\n\t\tlet timeInMilliseconds = performance.now();\n\t\tlet t = 0.001*timeInMilliseconds;\n\t\tlet dt = t-this._prevUpdate;\n\t\tif (dt > 0.05)\n\t\t\tdt = 0.05;\n\t\tthis._prevUpdate = t;\n\t\tthis.time += dt;\n\n\t\tsetChangeOrigin(this);\n\t\t\n\t\tthis.dispatch('onUpdate', dt, this.time);\n\t\tupdateWorld(this, dt, timeInMilliseconds);\n\t\t\n\t\tthis.draw();\n\t\t\n\t\tif (this.won) {\n\t\t\tthis.pause();\n\t\t\tthis.time = 0;\n\t\t\tgame.dispatch('levelCompleted');\n\t\t\tthis.reset();\n\t\t}\n\t\t\n\t\tthis.requestAnimFrame();\n\t}\n\trequestAnimFrame() {\n\t\tthis.animationFrameId = window.requestAnimationFrame(() => this.animFrame());\n\t}\n\tdraw() {\n\t\tthis.context.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\tthis.dispatch('onDraw', this.context);\n\t}\n\tisInInitialState() {\n\t\treturn !this.playing && this.time === 0;\n\t}\n\treset() {\n\t\tif (!this._alive)\n\t\t\treturn; // scene has been replaced by another one\n\t\tthis.resetting = true;\n\t\tthis.pause();\n\t\tthis.deleteChildren();\n\n\t\tdeleteWorld(this);\n\t\tcreateWorld(this, physicsOptions);\n\t\t\n\t\tif (this.level)\n\t\t\tthis.level.createScene(this);\n\t\t\n\t\tthis.won = false;\n\t\tthis.time = 0;\n\t\tthis.draw();\n\t\tdelete this.resetting;\n\t}\n\tpause() {\n\t\tif (!this.playing) return;\n\t\t\n\t\tthis.playing = false;\n\t\tif (this.animationFrameId)\n\t\t\twindow.cancelAnimationFrame(this.animationFrameId);\n\t\tthis.animationFrameId = null;\n\t}\n\tplay() {\n\t\tif (this.playing) return;\n\t\t\n\t\tthis._prevUpdate = 0.001*performance.now();\n\t\tthis.playing = true;\n\t\t\n\t\tthis.requestAnimFrame();\n\t\t\n\t\t\n\t\tif (this.time === 0)\n\t\t\tthis.dispatch('onStart');\n\t\t\n\t\t/*\n\t\tlet player = game.findChild('prt', p => p.name === 'Player', true);\n\t\tif (player) {\n\t\t\tconsole.log('Spawning player!', player);\n\t\t\tthis.spawn(player);\n\t\t}\n\t\t*/\n\t}\n\tdelete() {\n\t\tif (!super.delete()) return false;\n\n\t\tdeleteWorld(this);\n\t\t\n\t\tif (scene === this)\n\t\t\tscene = null;\n\t\t\n\t\tconsole.log('scene.delete');\n\t\treturn true;\n\t}\n\n\t// To make component based entity search fast:\n\taddComponent(component) {\n\t\tlet set = this.components.get(component.constructor.componentName);\n\t\tif (!set) {\n\t\t\tset = new Set();\n\t\t\tthis.components.set(component.constructor.componentName, set);\n\t\t}\n\t\tset.add(component);\n\t}\n\tremoveComponent(component) {\n\t\tlet set = this.components.get(component.constructor.componentName);\n\t\tassert(set);\n\t\tassert(set.delete(component));\n\t}\n\tgetComponents(componentName) {\n\t\treturn this.components.get(componentName) || new Set;\n\t}\n}\nScene.prototype.isRoot = true;\n\nSerializable.registerSerializable(Scene, 'sce');\n","import Serializable from './serializable';\nimport assert from '../util/assert';\nimport Property from './property';\nimport PropertyOwner from './propertyOwner';\nimport { scene } from './scene';\nimport { game } from './game';\nexport { default as Prop } from './propertyType';\nexport let componentClasses = new Map();\nimport ComponentData from './componentData';\n\nconst eventListeners = [\n\t'onUpdate'\n\t,'onDraw'\n\t,'onStart'\n// @ifndef OPTIMIZE\n\t,'onDrawHelper'\n// @endif\n];\n\n// Instance of a component, see componentExample.js\nexport class Component extends PropertyOwner {\n\tconstructor(predefinedId = false) {\n\t\tsuper(predefinedId);\n\t\tthis._componentId = null; // Creator will fill this\n\t\tthis.scene = scene;\n\t\tthis.game = game;\n\t\tthis._listenRemoveFunctions = [];\n\t\tthis.entity = null;\n\t}\n\tdelete() {\n\t\t// Component.delete never returns false because entity doesn't have components as children\n\t\tthis._parent = null;\n\t\tthis.entity = null;\n\t\tsuper.delete();\n\t\treturn true;\n\t}\n\t_addEventListener(functionName) {\n\t\tlet func = this[functionName];\n\t\tlet self = this;\n\t\tthis._listenRemoveFunctions.push(this.scene.listen(functionName, function() {\n\t\t\tfunc.apply(self, arguments);\n\t\t}));\n\t}\n\t_preInit() {\n\t\tthis.constructor.requirements.forEach(r => {\n\t\t\tthis[r] = this.entity.getComponent(r);\n\t\t\tassert(this[r], `${this.constructor.componentName} requires component ${r} but it is not found`);\n\t\t});\n\n\t\tthis.forEachChild('com', c => c._preInit());\n\n\t\tfor (let i = 0; i < eventListeners.length; ++i) {\n\t\t\tif (typeof this[eventListeners[i]] === 'function')\n\t\t\t\tthis._addEventListener(eventListeners[i]);\n\t\t}\n\t\t\n\t\tif (this.constructor.componentName !== 'Transform')\n\t\t\tthis.scene.addComponent(this);\n\t\t\n\t\ttry {\n\t\t\tif (typeof this.preInit === 'function')\n\t\t\t\tthis.preInit();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'preInit', e);\n\t\t}\n\t}\n\t_init() {\n\t\tthis.forEachChild('com', c => c._init());\n\t\ttry {\n\t\t\tif (typeof this.init === 'function')\n\t\t\t\tthis.init();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'init', e);\n\t\t}\n\t}\n\t_sleep() {\n\t\ttry {\n\t\t\tif (typeof this.sleep === 'function')\n\t\t\t\tthis.sleep();\n\t\t} catch(e) {\n\t\t\tconsole.error(this.entity, this.constructor.componentName, 'sleep', e);\n\t\t}\n\n\t\tif (this.constructor.componentName !== 'Transform')\n\t\t\tthis.scene.removeComponent(this);\n\t\t\n\t\tthis.forEachChild('com', c => c._sleep());\n\t\t// console.log(`remove ${this._listenRemoveFunctions.length} listeners`);\n\t\tthis._listenRemoveFunctions.forEach(f => f());\n\t\tthis._listenRemoveFunctions.length = 0;\n\t}\n\tlistenProperty(component, propertyName, callback) {\n\t\tthis._listenRemoveFunctions.push(component._properties[propertyName].listen('change', callback));\n\t}\n\tcreateComponentData() {\n\t\tlet componentName = this.constructor.componentName;\n\t\tlet propertyTypes = this.constructor._propertyTypes;\n\t\tlet componentData = new ComponentData(componentName);\n\t\tlet children = [];\n\t\tpropertyTypes.forEach(pt => {\n\t\t\tchildren.push(pt.createProperty({\n\t\t\t\tvalue: this[pt.name]\n\t\t\t}));\n\t\t});\n\t\tcomponentData.initWithChildren(children);\n\t\treturn componentData;\n\t}\n\ttoJSON() {\n\t\treturn Object.assign(super.toJSON(), {\n\t\t\tn: this.constructor.componentName,\n\t\t\tcid: this._componentId\n\t\t});\n\t}\n}\nComponent.create = function(name, values = {}) {\n\tlet componentClass = componentClasses.get(name);\n\tassert(componentClass);\n\tlet component = new componentClass();\n\tcomponent.initWithPropertyValues(values);\n\treturn component;\n};\nComponent.createWithInheritedComponentData = function(inheritedComponentData) {\n\tlet component = new inheritedComponentData.componentClass;\n\tcomponent._componentId = inheritedComponentData.componentId;\n\tlet properties = inheritedComponentData.properties.map(p => p.clone());\n\tcomponent.initWithChildren(properties);\n\treturn component;\n};\n\nComponent.reservedPropertyNames = new Set(['id', 'constructor', 'delete', 'children', 'entity', 'env', 'init', 'preInit', 'sleep', 'toJSON', 'fromJSON']);\nComponent.reservedPrototypeMembers = new Set(['id', 'children', 'entity', 'env', '_preInit', '_init', '_sleep', '_forEachChildComponent', '_properties', '_componentData', 'toJSON', 'fromJSON']);\nComponent.register = function({\n\tname = '', // required\n\tdescription = '',\n\tcategory = 'Other',\n\ticon = 'fa-puzzle-piece', // in editor\n\tcolor = '', // in editor\n\tproperties = [],\n\trequirements = ['Transform'],\n\tchildren = [],\n\tparentClass = Component,\n\tprototype = {},\n\tallowMultiple = true,\n\trequiesInitWhenEntityIsEdited = false\n}) {\n\tassert(name, 'Component must have a name.');\n\tassert(name[0] >= 'A' && name[0] <= 'Z', 'Component name must start with capital letter.');\n\tassert(!componentClasses.has(name), 'Duplicate component class ' + name);\n\tObject.keys(prototype).forEach(k => {\n\t\tif (Component.reservedPrototypeMembers.has(k))\n\t\t\tassert(false, 'Component prototype can not have a reserved member: ' + k);\n\t});\n\t\n\tlet constructorFunction = prototype.constructor;\n\tlet deleteFunction = prototype.delete;\n\tdelete prototype.constructor;\n\tdelete prototype.delete;\n\tclass Com extends parentClass {\n\t\tconstructor() {\n\t\t\tsuper(...arguments);\n\t\t\tif (constructorFunction)\n\t\t\t\tconstructorFunction();\n\t\t}\n\t\tdelete() {\n\t\t\tif (!super.delete()) return false;\n\t\t\t\n\t\t\tif (deleteFunction)\n\t\t\t\tdeleteFunction();\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\t}\n\tproperties.forEach(p => {\n\t\tassert(!Component.reservedPropertyNames.has(p.name), 'Can not have property called ' + p.name);\n\t});\n\tPropertyOwner.defineProperties(Com, properties); // properties means propertyTypes here\n\tCom.componentName = name;\n\tCom.category = category;\n\tif (requirements.indexOf('Transform') < 0) requirements.push('Transform');\n\tCom.requirements = requirements;\n\tCom.children = children;\n\tCom.description = description;\n\tCom.allowMultiple = allowMultiple;\n\tCom.icon = icon;\n\t\n\tlet num = name.split('').reduce((prev, curr) => prev + curr.charCodeAt(0), 0);\n\tCom.color = color || `hsla(${ num % 360 }, 40%, 60%, 1)`;\n\n\tprototype._name = name;\n\tObject.assign(Com.prototype, prototype);\n\tcomponentClasses.set(Com.componentName, Com);\n\treturn Com;\n};\n\nSerializable.registerSerializable(Component, 'com', json => {\n\tlet component = new (componentClasses.get(json.n))(json.id);\n\tcomponent._componentId = json.cid || null;\n\treturn component;\n});\n","import Prototype from './prototype';\nimport Property from './property';\nimport Serializable from './serializable';\nimport { getSerializable } from './serializableManager';\nimport { Prop, componentClasses } from './component';\nimport ComponentData from './componentData';\nimport { scene } from './scene';\nimport assert from '../util/assert';\nimport Vector from '../util/vector';\n\n// EntityPrototype is a prototype that always has one Transform ComponentData and optionally other ComponentDatas also.\n// Entities are created based on EntityPrototypes\nexport default class EntityPrototype extends Prototype {\n\tconstructor(predefinedId = false) {\n\t\tsuper(...arguments);\n\t\t// this._parent is level, not prototype. We need a link to parent-prototype.\n\t\tthis.prototype = null;\n\t}\n\tgetTransform() {\n\t\treturn this.findChild('cda', cda => cda.name === 'Transform');\n\t}\n\tgetParentPrototype() {\n\t\treturn this.prototype;\n\t}\n\tclone() {\n\t\tlet obj = new EntityPrototype();\n\t\tobj.prototype = this.prototype;\n\t\tlet id = obj.id;\n\t\tlet children = [];\n\t\tthis.forEachChild(null, child => {\n\t\t\tif (child.threeLetterType === 'prp' && child.name === 'name') {\n\t\t\t\tlet property = new Property({\n\t\t\t\t\tvalue: child.propertyType.type.clone(child.value),\n\t\t\t\t\tname: child.name,\n\t\t\t\t\tpropertyType: this.propertyType,\n\t\t\t\t\tpredefinedId: id + '_n'\n\t\t\t\t});\n\t\t\t\tchildren.push(property);\n\t\t\t} else if (child.threeLetterType === 'cda' && child.name === 'Transform') {\n\t\t\t\tlet transform = new ComponentData('Transform', id + '_t');\n\n\t\t\t\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\t\t\t\tvalue: child.findChild('prp', prp => prp.name === 'position').value,\n\t\t\t\t\tpredefinedId: id + '_p'\n\t\t\t\t});\n\t\t\t\ttransform.addChild(position);\n\n\t\t\t\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\t\t\t\tvalue: child.findChild('prp', prp => prp.name === 'scale').value,\n\t\t\t\t\tpredefinedId: id + '_s'\n\t\t\t\t});\n\t\t\t\ttransform.addChild(scale);\n\n\t\t\t\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\t\t\t\tvalue: child.findChild('prp', prp => prp.name === 'angle').value,\n\t\t\t\t\tpredefinedId: id + '_r'\n\t\t\t\t});\n\t\t\t\ttransform.addChild(angle);\n\t\t\t\t\n\t\t\t\tchildren.push(transform);\n\t\t\t} else if (child.threeLetterType === 'cda') {\n\t\t\t\tchildren.push(child.clone({ cloneComponentId: true }));\n\t\t\t} else {\n\t\t\t\tchildren.push(child.clone());\n\t\t\t}\n\t\t});\n\t\tobj.initWithChildren(children);\n\t\tthis._state |= Serializable.STATE_CLONE;\n\t\treturn obj;\n\t}\n\ttoJSON() {\n\t\t// return super.toJSON();\n\t\t\n\t\t// Below optimization reduces size 88%. id's have to be generated based on this.id\n\t\t\n\t\tlet Transform = this.getTransform();\n\t\tlet json = {\n\t\t\tid: this.id,\n\t\t\tp: this.prototype.id\n\t\t};\n\t\t\n\t\tlet childArrays = [];\n\t\tthis._children.forEach(child => {\n\t\t\tchildArrays.push(child);\n\t\t});\n\t\tlet children = [].concat(...childArrays).filter(child => {\n\t\t\treturn child !== Transform && child !== this._properties.name;\n\t\t});\n\t\tif (children.length > 0)\n\t\t\tjson.c = children.map(child => child.toJSON());\n\t\t\n\t\tlet floatToJSON = Prop.float().toJSON;\n\t\tlet handleProperty = prp => {\n\t\t\tif (prp.name === 'name') {\n\t\t\t\tif (prp.value)\n\t\t\t\t\tjson.n = prp.value;\n\t\t\t} else if (prp.name === 'position') {\n\t\t\t\tjson.x = floatToJSON(prp.value.x);\n\t\t\t\tjson.y = floatToJSON(prp.value.y);\n\t\t\t} else if (prp.name === 'scale') {\n\t\t\t\tif (!prp.value.isEqualTo(new Vector(1, 1))) {\n\t\t\t\t\tjson.w = floatToJSON(prp.value.x);\n\t\t\t\t\tjson.h = floatToJSON(prp.value.y);\n\t\t\t\t}\n\t\t\t} else if (prp.name === 'angle') {\n\t\t\t\tif (prp.value !== 0)\n\t\t\t\t\tjson.a = floatToJSON(prp.value);\n\t\t\t}\n\t\t};\n\t\thandleProperty(this._properties.name);\n\n\t\tTransform.getChildren('prp').forEach(handleProperty);\n\t\treturn json;\n\t}\n\tspawnEntityToScene(position) {\n\t\tif (!scene)\n\t\t\treturn;\n\t\t\n\t\tif (position) {\n\t\t\tthis.getTransform().getPropertyOrCreate('position').value = position;\n\t\t}\n\t\t\n\t\tlet entity = this.createEntity();\n\t\tscene.addChild(entity);\n\t}\n}\nObject.defineProperty(EntityPrototype.prototype, 'position', {\n\tget() {\n\t\treturn this.getTransform().findChild('prp', prp => prp.name === 'position').value;\n\t},\n\tset(position) {\n\t\treturn this.getTransform().findChild('prp', prp => prp.name === 'position').value = position;\n\t}\n});\n\n// If Transform or Transform.position is missing, they are added.\nEntityPrototype.createFromPrototype = function(prototype, componentDatas = []) {\n\n\tlet entityPrototype = new EntityPrototype();\n\tentityPrototype.prototype = prototype;\n\tlet id = entityPrototype.id;\n\t\n\tassert(!componentDatas.find(cda => cda.name === 'Transform'), 'Prototype (prt) can not have a Transform component');\n\t\n\tlet transform = new ComponentData('Transform', id + '_t');\n\tcomponentDatas.push(transform);\n\t\n\tlet position = transform.componentClass._propertyTypesByName.position.createProperty({\n\t\tvalue: new Vector(0, 0),\n\t\tpredefinedId: id + '_p'\n\t});\n\ttransform.addChild(position);\n\n\tlet scale = transform.componentClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: new Vector(1, 1),\n\t\tpredefinedId: id + '_s'\n\t});\n\ttransform.addChild(scale);\n\n\tlet angle = transform.componentClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: 0,\n\t\tpredefinedId: id + '_r'\n\t});\n\ttransform.addChild(angle);\n\n\tlet name = EntityPrototype._propertyTypesByName.name.createProperty({\n\t\tvalue: '',\n\t\tpredefinedId: id + '_n'\n\t});\n\t\n\tentityPrototype.initWithChildren([name, ...componentDatas])\n\n\treturn entityPrototype;\n};\n\nSerializable.registerSerializable(EntityPrototype, 'epr', json => {\n\tlet entityPrototype = new EntityPrototype(json.id);\n\tentityPrototype.prototype = getSerializable(json.p);\n\tassert(entityPrototype.prototype, `Prototype ${json.p} not found`);\n\t\n\tlet nameId = json.id + '_n';\n\tlet transformId = json.id + '_t';\n\tlet positionId = json.id + '_p';\n\tlet scaleId = json.id + '_s';\n\tlet angleId = json.id + '_r';\n\t\n\tlet name = Prototype._propertyTypesByName.name.createProperty({ \n\t\tvalue: json.n === undefined ? '' : json.n,\n\t\tpredefinedId: nameId \n\t});\n\t\n\tlet transformData = new ComponentData('Transform', transformId);\n\tlet transformClass = componentClasses.get('Transform');\n\t\n\tlet position = transformClass._propertyTypesByName.position.createProperty({\n\t\tvalue: new Vector(json.x, json.y),\n\t\tpredefinedId: positionId\n\t});\n\ttransformData.addChild(position);\n\n\tlet scale = transformClass._propertyTypesByName.scale.createProperty({\n\t\tvalue: new Vector(json.w === undefined ? 1 : json.w, json.h === undefined ? 1 : json.h),\n\t\tpredefinedId: scaleId\n\t});\n\ttransformData.addChild(scale);\n\n\tlet angle = transformClass._propertyTypesByName.angle.createProperty({\n\t\tvalue: json.a || 0,\n\t\tpredefinedId: angleId\n\t});\n\ttransformData.addChild(angle);\n\t\n\t\n\tentityPrototype.initWithChildren([name, transformData]);\n\treturn entityPrototype;\n});\n","import Serializable from './serializable';\nimport PropertyOwner, { Prop } from '../core/propertyOwner';\nimport Scene, { scene } from './scene';\n\nlet propertyTypes = [\n\tProp('name', 'No name', Prop.string)\n];\n\nexport default class Level extends PropertyOwner {\n\tconstructor(predefinedId) {\n\t\tsuper(...arguments);\n\n\t\tif (predefinedId)\n\t\t\tconsole.log('level import');\n\t\telse\n\t\t\tconsole.log('level created');\n\t}\n\tcreateScene(predefinedSceneObject = false) {\n\t\tif (!predefinedSceneObject)\n\t\t\tnew Scene();\n\t\tlet entities = this.getChildren('epr').map(epr => epr.createEntity());\n\t\tscene.addChildren(entities);\n\t\tscene.level = this;\n\t\treturn scene;\n\t}\n\tisEmpty() {\n\t\treturn this.getChildren('epr').length === 0;\n\t}\n\t\n\t/*\n\tOPTIMIZATION DOES NOT WORK, YET\n\ttoJSON() {\n\t\tlet json = super.toJSON();\n\t\tconsole.log('before', json);\n\t\tif (json.c) {\n\t\t\tlet prototypeIds = new Set();\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tconsole.log('child', child);\n\t\t\t\tprototypeIds.add(child.p);\n\t\t\t});\n\t\t\t\n\t\t\tlet prototypeIdToNum = {};\n\t\t\tlet prototypeIdArray = [];\n\t\t\tlet num = 0;\n\t\t\tprototypeIds.forEach(key => {\n\t\t\t\tprototypeIdArray[num] = key;\n\t\t\t\tprototypeIdToNum[key] = num++;\n\t\t\t});\n\n\t\t\tjson.c.forEach(child => {\n\t\t\t\tchild.p = prototypeIdToNum[child.p] || child.p;\n\t\t\t});\n\t\t\t\n\t\t\tjson.p = prototypeIdArray;\n\n\t\t\tconsole.log(json, prototypeIds, prototypeIdToNum, prototypeIdArray);\n\t\t}\n\t\treturn json;\n\t}\n\t*/\n}\nPropertyOwner.defineProperties(Level, propertyTypes);\n\nSerializable.registerSerializable(Level, 'lvl');\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Transform',\n\tcategory: 'Core',\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('position', new Vector(0, 0), Prop.vector),\n\t\tProp('scale', new Vector(1, 1), Prop.vector),\n\t\tProp('angle', 0, Prop.float, Prop.float.modulo(0, Math.PI * 2), Prop.flagDegreesInEditor)\n\t]\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'TransformVariance',\n\tcategory: 'Core',\n\ticon: 'fa-dot-circle-o',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('positionVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('scaleVariance', new Vector(0, 0), Prop.vector),\n\t\tProp('angleVariance', 0, Prop.float, Prop.float.range(0, Math.PI), Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tonStart() {\n\t\t\tif (!this.positionVariance.isZero())\n\t\t\t\tthis.Transform.position = this.Transform.position.add(this.positionVariance.clone().multiplyScalar(-1 + 2 * Math.random()));\n\n\t\t\tif (!this.scaleVariance.isZero())\n\t\t\t\tthis.Transform.scale = this.Transform.scale.add(this.scaleVariance.clone().multiplyScalar(-1 + 2 * Math.random()));\n\t\t\t\n\t\t\tif (this.angleVariance)\n\t\t\t\tthis.Transform.angle += this.angleVariance * (-1 + 2 * Math.random());\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nlet vari = 0;\n\nComponent.register({\n\tname: 'Test',\n\tcategory: 'Core',\n\tproperties: [\n\t\tProp('name', 'Oh right', Prop.string),\n\t\tProp('enum', 'yksi', Prop.enum, Prop.enum.values('yksi', 'kaksi', 'kolme', 'neljä')),\n\t\tProp('topBarHelper', new Vector(0, 1), Prop.vector),\n\t\tProp('test' + ++vari, vari, Prop.int),\n\t\tProp('test' + ++vari, false, Prop.bool),\n\t\tProp('test' + ++vari, true, Prop.bool)\n\t]\n});\n","import Vector from '../util/vector';\n\nexport function keyPressed(key) {\n\treturn keys[key] || false;\n}\n\nexport function listenKeyDown(handler) {\n\tkeyDownListeners.push(handler);\n\treturn () => keyDownListeners.splice(keyDownListeners.indexOf(handler), 1);\n}\nexport function listenKeyUp(handler) {\n\tkeyUpListeners.push(handler);\n\treturn () => keyUpListeners.splice(keyUpListeners.indexOf(handler), 1);\n}\n\nexport const key = {\n\tleft: 37,\n\tright: 39,\n\tup: 38,\n\tdown: 40,\n\tctrl: 17,\n\tappleLeft: 91,\n\tappleRight: 93,\n\talt: 18,\n\tshift: 16,\n\tspace: 32,\n\ta: 65,\n\tb: 66,\n\tc: 67,\n\td: 68,\n\te: 69,\n\tf: 70,\n\tg: 71,\n\th: 72,\n\ti: 73,\n\tj: 74,\n\tk: 75,\n\tl: 76,\n\tm: 77,\n\tn: 78,\n\to: 79,\n\tp: 80,\n\tq: 81,\n\tr: 82,\n\ts: 83,\n\tt: 84,\n\tu: 85,\n\tv: 86,\n\tw: 87,\n\tx: 88,\n\ty: 89,\n\tz: 90,\n\t'0': 48,\n\t'1': 49,\n\t'9': 57,\n\tbackspace: 8,\n\tenter: 13,\n\tesc: 27\n};\n\nexport function listenMouseMove(element, handler) {\n\telement.addEventListener('mousemove', event => {\n\t\tlet x = event.pageX;\n\t\tlet y = event.pageY;\n\t\tlet el = element;\n\t\twhile( el != null ) {\n\t\t\tx -= el.offsetLeft;\n\t\t\ty -= el.offsetTop;\n\t\t\tel = el.offsetParent;\n\t\t}\n\t\t\n\t\telement._mx = x;\n\t\telement._my = y;\n\t\thandler(new Vector(x, y));\n\t});\n}\n\nexport function listenMouseDown(element, handler) {\n\telement.addEventListener('mousedown', event => {\n\t\tif (typeof element._mx === 'number')\n\t\t\thandler(new Vector(element._mx, element._my));\n\t\telse\n\t\t\thandler();\n\t});\n}\nexport function listenMouseUp(element, handler) {\n\telement.addEventListener('mouseup', event => {\n\t\tif (typeof element._mx === 'number')\n\t\t\thandler(new Vector(element._mx, element._my));\n\t\telse\n\t\t\thandler();\n\t});\n}\n\n////////////////////////////////////\n\n\nlet keys = {};\nlet keyDownListeners = [];\nlet keyUpListeners = [];\n\n\nif (typeof window !== 'undefined') {\n\n\twindow.onkeydown = event => {\n\t\tlet keyCode = event.which || event.keyCode;\n\n\t\tif (document.activeElement.nodeName.toLowerCase() == \"input\" && keyCode !== key.esc)\n\t\t\treturn;\n\n\t\tkeys[keyCode] = true;\n\t\tkeyDownListeners.forEach(l => l(keyCode));\n\t};\n\twindow.onkeyup = event => {\n\t\tlet key = event.which || event.keyCode;\n\t\tkeys[key] = false;\n\t\tkeyUpListeners.forEach(l => l(key));\n\t};\n}\n","import { Component, Prop } from '../core/component';\nimport { key, keyPressed } from '../util/input';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Mover',\n\tproperties: [\n\t\tProp('change', new Vector(10, 10), Prop.vector),\n\t\tProp('userControlled', false, Prop.bool),\n\t\tProp('speed', 1, Prop.float),\n\t\tProp('rotationSpeed', 0, Prop.float, 'Degrees per second', Prop.flagDegreesInEditor)\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tthis.Physics = this.entity.getComponent('Physics');\n\t\t},\n\t\tonUpdate(dt, t) {\n\t\t\tif (!this._rootType)\n\t\t\t\treturn;\n\t\t\t\n\t\t\tif (this.userControlled) {\n\t\t\t\tif (!this.entity.localMaster) return;\n\t\t\t\t\n\t\t\t\tlet dx = 0;\n\t\t\t\tlet dy = 0;\n\t\t\t\t\n\t\t\t\tif (keyPressed(key.left)) dx -= 1;\n\t\t\t\tif (keyPressed(key.right)) dx += 1;\n\t\t\t\tif (keyPressed(key.up)) dy -= 1;\n\t\t\t\tif (keyPressed(key.down)) dy += 1;\n\t\t\t\tif (this.Physics) {\n\t\t\t\t\tif (dx || dy) {\n\t\t\t\t\t\tlet force = new Vector(\n\t\t\t\t\t\t\tdx * this.Physics.getMass() * this.speed * dt,\n\t\t\t\t\t\t\tdy * this.Physics.getMass() * this.speed * dt\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.Physics.applyForce(force);\n\t\t\t\t\t}\n\t\t\t\t\tif (dx && this.rotationSpeed) {\n\t\t\t\t\t\tthis.Physics.setAngularForce(dx * this.rotationSpeed * dt);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (dx) this.Transform.position.x += dx * this.speed * dt;\n\t\t\t\t\tif (dy) this.Transform.position.y += dy * this.speed * dt;\n\t\t\t\t\tif (dx || dy) {\n\t\t\t\t\t\tthis.Transform.position = this.Transform.position;\n\t\t\t\t\t}\n\t\t\t\t\tif (dx && this.rotationSpeed) {\n\t\t\t\t\t\tthis.Transform.angle += dt * dx * this.rotationSpeed;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet change = new Vector(dt, 0).rotate(t * this.speed).multiply(this.change);\n\t\t\t\tthis.Transform.position.set(this.Transform.position).add(change);\n\t\t\t\t\n\t\t\t\tif (this.rotationSpeed)\n\t\t\t\t\tthis.Transform.angle += dt * this.rotationSpeed;\n\t\t\t}\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Rect',\n\ticon: 'fa-stop',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('size', new Vector(10, 10), Prop.vector),\n\t\tProp('style', 'red', Prop.string),\n\t\tProp('randomStyle', false, Prop.bool)\n\t],\n\tprototype: {\n\t\tinit() {\n\t\t\tif (this.randomStyle)\n\t\t\t\tthis.style = `hsl(${Math.random()*360 | 0}, 100%, 40%)`;\n\t\t},\n\t\tonDraw(context) {\n\t\t\tlet\n\t\t\t\tx = this.Transform.position.x - this.size.x/2 * this.Transform.scale.x,\n\t\t\t\ty = this.Transform.position.y - this.size.y/2 * this.Transform.scale.y,\n\t\t\t\tw = this.size.x * this.Transform.scale.x,\n\t\t\t\th = this.size.y * this.Transform.scale.y;\n\t\t\tcontext.save();\n\t\t\tcontext.fillStyle = this.style;\n\t\t\tcontext.translate(x+w/2, y+h/2);\n\t\t\tcontext.rotate(this.Transform.angle);\n\t\t\tcontext.fillRect(-w/2, -h/2, w, h);\n\t\t\tcontext.restore();\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport EntityPrototype from '../core/entityPrototype';\n\nComponent.register({\n\tname: 'Spawner',\n\tproperties: [\n\t\tProp('typeName', '', Prop.string)\n\t],\n\tprototype: {\n\t\tonStart() {\n\t\t\tthis.spawn();\n\t\t},\n\t\tonDrawHelper(context) {\n\t\t\tlet size = 30;\n\t\t\tlet\n\t\t\t\tx = this.Transform.position.x - size * this.Transform.scale.x/2,\n\t\t\t\ty = this.Transform.position.y - size * this.Transform.scale.y/2,\n\t\t\t\tw = size * this.Transform.scale.x,\n\t\t\t\th = size * this.Transform.scale.y;\n\t\t\tcontext.save();\n\t\t\tcontext.fillStyle = 'blue';\n\t\t\tcontext.strokeStyle = 'white';\n\t\t\tcontext.lineWidth = 1;\n\t\t\tcontext.font = '40px FontAwesome';\n\t\t\tcontext.textAlign = 'center';\n\t\t\tcontext.fillText('\\uF21D', this.Transform.position.x + 2, this.Transform.position.y);\n\t\t\tcontext.strokeText('\\uf21d', this.Transform.position.x + 2, this.Transform.position.y);\n\t\t\t\n\t\t\tcontext.restore();\n\t\t},\n\t\tspawn() {\n\t\t\tlet prototype = this.game.findChild('prt', prt => prt.name === this.typeName, true);\n\t\t\tif (!prototype)\n\t\t\t\treturn;\n\n\t\t\tEntityPrototype.createFromPrototype(prototype).spawnEntityToScene(this.Transform.position);\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\n\nComponent.register({\n\tname: 'Trigger',\n\tallowMultiple: true,\n\tproperties: [\n\t\tProp('trigger', 'playerComesNear', Prop.enum, Prop.enum.values('playerComesNear')),\n\t\tProp('radius', 40, Prop.float, Prop.float.range(0, 1000), Prop.visibleIf('trigger', 'playerComesNear')),\n\t\tProp('action', 'win', Prop.enum, Prop.enum.values('win'))\n\t],\n\tprototype: {\n\t\tonDrawHelper(context) {\n\t\t\tlet size = 30;\n\t\t\tlet\n\t\t\t\tx = this.Transform.position.x - size * this.Transform.scale.x/2,\n\t\t\t\ty = this.Transform.position.y - size * this.Transform.scale.y/2,\n\t\t\t\tw = size * this.Transform.scale.x,\n\t\t\t\th = size * this.Transform.scale.y;\n\t\t\tcontext.save();\n\t\t\tcontext.fillStyle = 'blue';\n\t\t\tcontext.strokeStyle = 'white';\n\t\t\tcontext.lineWidth = 1;\n\t\t\tcontext.font = '40px FontAwesome';\n\t\t\tcontext.textAlign = 'center';\n\t\t\tcontext.fillText('\\uf085', this.Transform.position.x, this.Transform.position.y + 15);\n\t\t\tcontext.strokeText('\\uf085', this.Transform.position.x, this.Transform.position.y + 15);\n\t\t\t\n\t\t\tcontext.restore();\n\t\t},\n\t\tpreInit() {\n\t\t\tthis.storeProp = `__Trigger_${this._componentId}`;\n\t\t},\n\t\tonUpdate() {\n\t\t\tif (this.trigger === 'playerComesNear') {\n\t\t\t\tlet componentSet = this.scene.getComponents('Mover');\n\t\t\t\tlet entities = [];\n\t\t\t\tcomponentSet.forEach(c => entities.push(c.entity));\n\t\t\t\tlet distSq = this.radius * this.radius;\n\t\t\t\tlet pos = this.Transform.position;\n\t\t\t\tfor (let i = 0; i < entities.length; ++i) {\n\t\t\t\t\tif (entities[i].position.distanceSq(pos) < distSq) {\n\t\t\t\t\t\tif (!entities[i][this.storeProp] && this.launchTrigger(entities[i]) !== false)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tentities[i][this.storeProp] = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tentities[i][this.storeProp] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\t// Return false if other triggers should not be checked\n\t\tlaunchTrigger(entity) {\n\t\t\tif (this.action === 'win') {\n\t\t\t\tconsole.log('will win');\n\t\t\t\tthis.scene.win();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n});\n","import { Component, Prop } from '../core/component';\nimport Vector from '../util/vector';\nimport p2, { addBody, deleteBody, createMaterial } from '../feature/physics';\nimport assert from '../util/assert';\n\nconst PHYSICS_SCALE = 1/50;\nconst PHYSICS_SCALE_INV = 1/PHYSICS_SCALE;\n\nconst type = {\n\tdynamic: p2.Body.DYNAMIC,\n\tkinematic: p2.Body.KINEMATIC,\n\tstatic: p2.Body.STATIC\n};\n\nComponent.register({\n\tname: 'Physics',\n\ticon: 'fa-stop',\n\tallowMultiple: false,\n\tproperties: [\n\t\tProp('type', 'dynamic', Prop.enum, Prop.enum.values('dynamic', 'static')),\n\t\tProp('density', 1, Prop.float, Prop.float.range(0, 100), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('drag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('rotationalDrag', 0.1, Prop.float, Prop.float.range(0, 1), Prop.visibleIf('type', 'dynamic')),\n\t\tProp('bounciness', 0, Prop.float, Prop.float.range(0, 1)),\n\t\tProp('friction', 0.1, Prop.float, Prop.float.range(0, 1))\n\t],\n\trequirements: [\n\t\t'Rect'\n\t],\n\trequiesInitWhenEntityIsEdited: true,\n\tprototype: {\n\t\tinited: false,\n\t\tinit() {\n\t\t\tthis.inited = true;\n\t\t\tthis.Rects = this.entity.getComponents('Rect');\n\t\t\tlet update = callback => {\n\t\t\t\treturn value => {\n\t\t\t\t\tif (!this.updatingOthers && this.body) {\n\t\t\t\t\t\tcallback(value);\n\t\t\t\t\t\tif (this.type === 'dynamic')\n\t\t\t\t\t\t\tthis.body.wakeUp();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.listenProperty(this.Transform, 'position', update(position => this.body.position = position.toArray().map(x => x * PHYSICS_SCALE)));\n\t\t\tthis.listenProperty(this.Transform, 'angle', update(angle => this.body.angle = angle));\n\t\t\tthis.listenProperty(this, 'density', update(density => {\n\t\t\t\tthis.body.setDensity(density);\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'friction', update(friction => this.updateMaterial()));\n\t\t\tthis.listenProperty(this, 'drag', update(drag => this.body.damping = drag));\n\t\t\tthis.listenProperty(this, 'type', update(type => {\n\t\t\t\tthis.body.type = type[this.type];\n\t\t\t\tthis.entity.sleep();\n\t\t\t\tthis.entity.wakeUp();\n\t\t\t\t// this.body.setDensity(this.density);\n\t\t\t}));\n\t\t\tthis.listenProperty(this, 'bounciness', update(bounciness => this.updateMaterial()));\n\n\t\t\tif (this._rootType)\n\t\t\t\tthis.createBody();\n\t\t},\n\t\tcreateBody() {\n\t\t\tassert(!this.body);\n\t\t\t\n\t\t\tthis.body = new p2.Body({\n\t\t\t\ttype: type[this.type],\n\t\t\t\tposition: [this.Transform.position.x * PHYSICS_SCALE, this.Transform.position.y * PHYSICS_SCALE],\n\t\t\t\tangle: this.Transform.angle,\n\t\t\t\tvelocity: [0, 0],\n\t\t\t\tangularVelocity: 0,\n\t\t\t\tsleepTimeLimit: 0.5,\n\t\t\t\tsleepSpeedLimit: 0.3,\n\t\t\t\tdamping: this.drag,\n\t\t\t\tangularDamping: this.rotationalDrag\n\t\t\t});\n\t\t\tthis.body.entity = this.entity;\n\t\t\tthis.Rects.forEach(R => {\n\t\t\t\tlet shape = new p2.Box({\n\t\t\t\t\twidth: R.size.x * PHYSICS_SCALE,\n\t\t\t\t\theight: R.size.y * PHYSICS_SCALE\n\t\t\t\t});\n\t\t\t\tthis.body.addShape(shape);\n\t\t\t});\n\t\t\tthis.updateMaterial();\n\t\t\t\n\t\t\tif (this.type === 'dynamic')\n\t\t\t\tthis.body.setDensity(this.density);\n\t\t\t\n\t\t\taddBody(this.scene, this.body);\n\t\t},\n\t\tupdateMaterial() {\n\t\t\tlet material = createMaterial(this.scene, {\n\t\t\t\tfriction: this.friction,\n\t\t\t\trestitution: this.bounciness,\n\t\t\t\t// stiffness: 1e6,\n\t\t\t\t// relaxation: 4,\n\t\t\t\t// frictionStiffness: 1e6,\n\t\t\t\t// frictionRelaxation: 4,\n\t\t\t\t// surfaceVelocity: 0\n\t\t\t});\n\t\t\tthis.body.shapes.forEach(s => s.material = material);\n\t\t},\n\t\tsetRootType(rootType) {\n\t\t\tif (rootType) {\n\t\t\t\tif (this.inited)\n\t\t\t\t\tthis.createBody();\n\t\t\t}\n\t\t\treturn Component.prototype.setRootType.call(this, rootType);\n\t\t},\n\t\tonUpdate() {\n\t\t\tlet b = this.body;\n\t\t\tif (!b || b.sleepState === p2.Body.SLEEPING)\n\t\t\t\treturn;\n\t\t\t\n\t\t\tthis.updatingOthers = true;\n\t\t\t\n\t\t\tlet newPos = new Vector(b.position[0] * PHYSICS_SCALE_INV, b.position[1] * PHYSICS_SCALE_INV);\n\t\t\tif (!this.Transform.position.isEqualTo(newPos))\n\t\t\t\tthis.Transform.position = newPos;\n\t\t\t\n\t\t\tif (this.Transform.angle !== b.angle)\n\t\t\t\tthis.Transform.angle = b.angle;\n\t\t\t\n\t\t\tthis.updatingOthers = false;\n\t\t},\n\t\tsleep() {\n\t\t\tif (this.body) {\n\t\t\t\tdeleteBody(this.scene, this.body);\n\t\t\t\tthis.body = null;\n\t\t\t}\n\t\t\tthis.inited = false;\n\t\t},\n\t\tgetMass() {\n\t\t\treturn this.body.mass;\n\t\t},\n\t\tapplyForce(forceVector) {\n\t\t\tthis.body.applyForce(forceVector.toArray());\n\t\t\tthis.body.wakeUp();\n\t\t},\n\t\tsetAngularForce(force) {\n\t\t\tthis.body.angularForce = force;\n\t\t\tthis.body.wakeUp();\n\t\t}\n\t}\n});\n","import fs from 'fs';\n\nexport function gameIdToFilename(gameId) {\n\t// File system can be case-insensitive. Add '_' before every uppercase letter.\n\treturn gameId.replace(/([A-Z])/g, '_$1') + '.txt';\n}\n\nconst isGameFileRegExp = /^gam[A-Za-z0-9_]+\\.txt$/;\nexport function filenameToGameId(filename) {\n\tif (!isGameFileRegExp.test(filename))\n\t\treturn null;\n\t\n\treturn filename.replace(/_([A-Z])/g, '$1').replace('.txt', '');\n}\n\nfunction readFile(path) {\n\treturn new Promise((resolve, reject) => {\n\t\tfs.readFile(DIR_ROOT + path, (err, data) => {\n\t\t\tif (err)\n\t\t\t\treturn reject(err);\n\t\t\tresolve(data);\n\t\t})\n\t});\n}\n\n// GameInfo cache\nexport let cachedGameInfo = [];\nfunction updateCachedGameData() {\n\treturn getGameFilenames().then(filenames => {\n\t\tlet p = Promise.resolve();\n\t\t\n\t\tlet gameInfo = [];\n\t\t\n\t\tfilenames.forEach(filename => {\n\t\t\tp = p.then(() => {\n\t\t\t\treturn readFile(`/gameData/${filename}`).then(data => {\n\t\t\t\t\tlet obj = JSON.parse(data);\n\t\t\t\t\tlet id = obj.id;\n\t\t\t\t\tlet nameObj = obj.c.find(child => child.n === 'name' && child.id.startsWith('prp'));\n\t\t\t\t\tlet levels = obj.c.filter(child => child.id.startsWith('lvl')).length;\n\t\t\t\t\tlet name = nameObj ? nameObj.v : 'NULL';\n\t\t\t\t\tlet size = data.length;\n\t\t\t\t\tgameInfo.push({\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tsize,\n\t\t\t\t\t\tlevels\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t\t\n\t\tp = p.then(() => {\n\t\t\tcachedGameInfo = gameInfo;\n\t\t});\n\t\t\n\t\treturn p;\n\t}).catch(err => {\n\t\tconsole.error('updateCachedGameData error', err);\n\t});\n}\nsetInterval(updateCachedGameData, 1000 * 5);\nupdateCachedGameData();\n\nexport function getGameFilenames() {\n\treturn new Promise(function(resolve, reject) {\n\t\tfs.readdir(global.DIR_GAMEDATA, (err, files) => {\n\t\t\tif (err)\n\t\t\t\treturn reject(err);\n\t\t\tfiles = files.filter(filename => isGameFileRegExp.test(filename));\n\t\t\tresolve(files);\n\t\t});\n\t});\n}\n\nexport function getGameIdList() {\n\treturn getGameFilenames().then(filenames => {\n\t\treturn filenames.map(filenameToGameId).filter(Boolean);\n\t});\n}\n\nexport function removeDummyGames() {\n\tgetGameFilenames().then(filenames => {\n\t\tlet timeoutMs = 0;\n\t\tfilenames.forEach(filename => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tfs.stat(`${DIR_GAMEDATA}/${filename}`, (err, stat) => {\n\t\t\t\t\tif (stat.size < 500 && new Date() - new Date(stat.mtime) > 1000*60*60)\n\t\t\t\t\t\tfs.unlink(`${DIR_GAMEDATA}/${filename}`);\n\t\t\t\t})\n\t\t\t}, timeoutMs);\n\t\t\ttimeoutMs += 50;\n\t\t});\n\t});\n}\n","import fs from 'fs';\nimport Game from '../core/game';\nimport Serializable from '../core/serializable';\nimport { getConnectionsForGameServer } from './connection';\nimport { executeChange, setChangeOrigin, addChangeListener } from '../core/serializableManager';\nimport { gameIdToFilename, removeDummyGames } from './gameDataTools';\n\nlet idToGameServer = {}; // gameId => GameServer\nexport { idToGameServer };\n\naddChangeListener(change => {\n\tlet root = change.reference.getRoot();\n\tif (root.threeLetterType === 'gam') {\n\t\tlet gameServer = idToGameServer[root.id];\n\t\tif (gameServer) {\n\t\t\tgameServer.saveNeeded = true;\n\t\t\tgameServer.lastUsed = new Date();\n\t\t\treturn;\n\t\t} else {\n\t\t\t// console.log('Invalid change, gameServer does not exist', change, root.id);\n\t\t}\n\t} else {\n\t\tconsole.log('Invalid change, root is not game', change, root);\n\t}\n});\n\n\nclass GameServer {\n\tconstructor(game) {\n\t\tthis.id = game.id;\n\t\tthis.game = game;\n\t\tconsole.log('open GameServer', game.id);\n\t\tthis.connections = getConnectionsForGameServer(game.id);\n\t\tthis.lastUsed = new Date();\n\t\tthis.saveNeeded = false;\n\t\t\n\t\tidToGameServer[this.id] = this;\n\t}\n\taddConnection(connection) {\n\t\tthis.connections.add(connection);\n\t}\n\tremoveConnection(connection) {\n\t\tthis.connections.delete(connection);\n\t}\n\tapplyChange(change, origin) {\n\t\tif (change)\n\t\t\texecuteChange(change);\n\t\t\n\t\tfor (let connection of this.connections) {\n\t\t\tif (connection !== origin) {\n\t\t\t\tconnection.sendChangeToOwner(change);\n\t\t\t}\n\t\t}\n\t}\n\tsave() {\n\t\tfs.writeFile(`${DIR_GAMEDATA}/${gameIdToFilename(this.id)}`, JSON.stringify(this.game.toJSON()));\n\t\tthis.saveNeeded = false;\n\t}\n\tdelete() {\n\t\tthis.connections.clear = 0;\n\t\t\n\t\tif (this.game) {\n\t\t\tthis.game.delete();\n\t\t\tthis.game = null;\n\t\t}\n\t\t\n\t\tdelete idToGameServer[this.id];\n\t}\n}\n\n// Normal update\nsetInterval(() => {\n\tconsole.log('srvrs', Object.keys(idToGameServer));\n\tObject.keys(idToGameServer).map(key => idToGameServer[key]).forEach(gameServer => {\n\t\tif (new Date() - gameServer.lastUsed > 1000*10) {\n\t\t\tconsole.log('GameServer delete', gameServer.id);\n\t\t\tsetChangeOrigin('Game clear interval');\n\t\t\tgameServer.delete();\n\t\t} else if (gameServer.saveNeeded) {\n\t\t\tconsole.log('GameServer save', gameServer.id);\n\t\t\tgameServer.save();\n\t\t}\n\t});\n}, 3000);\n\n// Delete dummy games\nsetInterval(() => {\n\tremoveDummyGames();\n}, 5000);\n\nfunction createGame(gameId) {\n\tlet game = new Game(gameId);\n\tgame.initWithChildren();\n\treturn game;\n}\n\nexport function getOrCreateGameServer(gameId) {\n\tif (!gameId || typeof gameId !== 'string' || gameId.length < 10 || !gameId.startsWith('gam')) {\n\t\tsetChangeOrigin(getOrCreateGameServer);\n\t\treturn Promise.resolve(new GameServer(createGame()));\n\t}\n\t\n\tif (idToGameServer[gameId]) {\n\t\treturn Promise.resolve(idToGameServer[gameId]);\n\t}\n\t\n\treturn new Promise((resolve, reject) => {\n\t\t// We are in dist folder\n\t\tfs.readFile(`${__dirname}/../gameData/${gameIdToFilename(gameId)}`, (err, data) => {\n\t\t\tif (idToGameServer[gameId])\n\t\t\t\tresolve(idToGameServer[gameId]); // if someone else started the game at the same time\n\t\t\t\n\t\t\tsetChangeOrigin(getOrCreateGameServer);\n\t\t\t\n\t\t\tlet game;\n\t\t\tif (err) {\n\t\t\t\tgame = createGame(gameId); // gameId is valid here\n\t\t\t} else {\n\t\t\t\tif (Buffer.isBuffer(data)) {\n\t\t\t\t\tdata = data.toString('utf8');\n\t\t\t\t}\n\t\t\t\tlet json = JSON.parse(data);\n\t\t\t\tgame = Serializable.fromJSON(json);\n\t\t\t}\n\t\t\t\n\t\t\tresolve(new GameServer(game));\n\t\t});\n\t});\n}\n","import { addChangeListener, packChange, unpackChange, executeChange, executeExternal, changeType, setChangeOrigin } from '../core/serializableManager'\nimport { getOrCreateGameServer, idToGameServer } from './gameServer';\n\nlet connections = new Set();\nexport { connections };\n\nlet requiredClientTime = Date.now();\n\n\nprocess.on('message', msg => {\n\tconsole.log(msg);\n\trequiredClientTime = Date.now();\n\tfor (let connection of connections)\n\t\tconnection.refreshIfOld();\n});\n\nexport class Connection {\n\tconstructor(socket) {\n\t\tthis.socket = socket;\n\t\tthis.gameId = null;\n\n\t\tsocket.on('disconnect', () => {\n\t\t\tif (idToGameServer[this.gameId])\n\t\t\t\tidToGameServer[this.gameId].removeConnection(this);\n\t\t\tconnections.delete(this);\n\t\t\tconsole.log('socket count', connections.size);\n\t\t});\n\n\t\t// change event\n\t\tsocket.on('c', changes => {\n\t\t\tgetOrCreateGameServer(this.gameId).then(gameServer => {\n\t\t\t\tsetChangeOrigin(this);\n\t\t\t\t// console.log('changes', changes);\n\t\t\t\tchanges.map(unpackChange).forEach(change => {\n\t\t\t\t\tif (change.type === changeType.addSerializableToTree && change.value.id.startsWith('gam')) {\n\t\t\t\t\t\tconsole.log('ERROR, Client should not create a game.');\n\t\t\t\t\t\treturn; // Should not happen. Server creates all the games\n\t\t\t\t\t} else if (gameServer) {\n\t\t\t\t\t\tgameServer.applyChange(change, this);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('ERROR, No gameServer for', this.gameId);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\t});\n\t\t\n\t\tsocket.on('gameId', gameId => {\n\t\t\tthis.setGameServer(gameId);\n\t\t});\n\t\t\n\t\tsocket.on('requestGameData', gameId => {\n\t\t\tgetOrCreateGameServer(gameId).then(gameServer => {\n\t\t\t\tgameServer.addConnection(this);\n\t\t\t\tthis.setGameServer(gameServer.id);\n\t\t\t\tsocket.emit('gameData', gameServer.game.toJSON());\n\t\t\t});\n\t\t});\n\t\t\n\t\tconnections.add(this);\n\t\tconsole.log('socket count', connections.size);\n\t\t\n\t\tthis.requestGameId();\n\t\tthis.refreshIfOld();\n\t}\n\tsendChangeToOwner(change) {\n\t\tconsole.log('SENDING', change.type);\n\t\tchange = packChange(change);\n\t\tthis.socket.emit('c', [change]);\n\t}\n\tsetGameServer(gameId) {\n\t\t\n\t\tif (gameId !== this.gameId) {\n\t\t\tif (idToGameServer[this.gameId])\n\t\t\t\tidToGameServer[this.gameId].removeConnection(this);\n\t\t\tthis.gameId = gameId;\n\t\t}\n\t}\n\trequestGameId() {\n\t\tthis.socket.emit('requestGameId');\n\t}\n\trefreshIfOld() {\n\t\tthis.socket.emit('refreshIfOlderThan', requiredClientTime);\n\t}\n}\n\nsetInterval(() => {\n\tconsole.log('connections', Array.from(connections).map(conn => conn.gameId));\n}, 5000);\n\nexport function addSocket(socket) {\n\tnew Connection(socket);\n}\n\nexport function getConnectionsForGameServer(gameId) {\n\tlet set = new Set();\n\tfor (let connection of connections) {\n\t\tif (connection.gameId === gameId)\n\t\t\tset.add(connection);\n\t}\n\treturn set;\n}\n","const _ = require('lodash');\nimport fs from 'fs';\n\nfunction readFile(filename) {\n\treturn new Promise((resolve, reject) => {\n\t\tfs.readFile(`${DIR_TEMPLATE}/${filename}`, (err, data) => {\n\t\t\tif (err)\n\t\t\t\treturn reject(err);\n\t\t\tresolve(data);\n\t\t});\n\t});\n}\nfunction readFileSync(filename) {\n\treturn fs.readFileSync(`${DIR_TEMPLATE}/${filename}`);\n}\n\nexport default function(filename, data) {\n\treturn createTemplate(filename)(data);\n}\n\nexport function createTemplate(filename) {\n\treturn readFile(filename).then(fileData => {\n\t\treturn _.template(fileData);\n\t});\n}\nexport function createTemplateSync(filename) {\n\tlet fileData = readFileSync(filename);\n\treturn _.template(fileData);\n}\n","import './core'\nimport './components'\n\nimport { addSocket } from './server/connection';\nimport { cachedGameInfo } from './server/gameDataTools';\nimport { createTemplateSync } from './server/template';\n\nconst express = require('express');\nconst app = express();\nconst http = require('http').Server(app);\nconst io = require('socket.io')(http);\nconst compression = require('compression');\nconst fs = require('fs');\n\n\napp.use(compression({\n\tlevel: 1\n}));\napp.use(express.static('public'));\n\nlet frontPageTemplate = createTemplateSync('frontPage.html');\napp.get('/', (req, res) => {\n\tres.send(frontPageTemplate({\n\t\tgameInfo: cachedGameInfo\n\t}));\n\t/*\n\tgetGameIdList().then(gameIds => {\n\t\tres.send(frontPageTemplate({\n\t\t\tgameIds\n\t\t}));\n\t}).catch(err => {\n\t\tres.status(500).send('Error');\n\t});\n\t*/\n});\n\nhttp.listen(3000, function(){\n\tconsole.log('listening on *:3000');\n});\n\nio.on('connection', function(socket) {\n\taddSocket(socket);\n});\n\nprocess.on('uncaughtException', function (err) {\n\tconsole.error(\"Node.js Exception. \" + err + \" - \" + err.stack);\n});\n"],"names":["let","const","this","foundChild","getSerializable","obj","super","Serializable","i","propertyTypes","Prop","isClient","p2","game","fs"],"mappings":"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"}