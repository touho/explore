<!DOCTYPE html>
<html lang="en">
<head>

    <link rel="icon" type="image/png" href="/img/logo_graphics.png"/>
    <link rel="stylesheet" href="css/front.css">
    <link rel="stylesheet" href="/common/profile.css">
    <link rel="stylesheet" href="css/gameElement.css">
    <link rel="stylesheet" href="css/contextMenu.css">
    <script src="/js/redom.min.js"></script>
    <script src="/js/util.js"></script>
    <script src="/js/gameElement.js"></script>
    <script src="/js/contextMenu.js"></script>
    <script src="/common/profile.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable = no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="/img/logo_graphics.png">

    <title>Open Edit Play</title>
</head>
<body>

<div id="topBar">
    <div id="topBarBackground"></div>
    <a id="createGameTopBarButton" class="hideInSmallScreens" href="/edit/?gameId=?">Create Game</a>
    <a href="#games">Games</a>
    <a href="#about">About</a>
    <div id="profileButtonContainer"></div>
</div>

<div id="topArea">
    <div id="topAreaBackground"></div>
    <div id="title">Open Edit Play</div>
    <a id="createGameButton" class="hideInSmallScreens" href="/edit/?gameId=?">Create Game</a>
    <div id="tooSmallScreen" class="hideInBigScreens">Use desktop browser to create games</div>
</div>

<div id="games" class="section">
    <div class="sectionTitle">GAMES</div>
</div>

<div id="myGames" class="section" style="display: none;">
    <div class="sectionTitle">MY GAMES</div>
</div>

<div id="about" class="section">
    <div class="sectionTitle">ABOUT</div>

    <p>
        Open Edit Play is an attempt to revolutionize making and sharing games - gamifying game making itself.
        The goal is not to create a topnotch game engine that allows creation of any type of game.
        The goal is to make it easy to share little game ideas with others and to let game creators focus on creativity.
    </p>

    <div id="aboutList">
        <div id="aboutListTitle">
            Open Edit Play
        </div>
        <ul>
            <li><b>Lightweight</b> - Web pages are tiny. Game engine is optimized and doesn't waste CPU.</li>
            <li><b>It just works</b> - When you make changes to a game, changes are automatically updated in other
                editors.
            </li>
            <li><b>Open source</b> - Feel free to join the development at <a class="normalLink"
                                                                             href="https://github.com/touho/openeditplay">GitHub</a>
                and run your own server.
            </li>
            <li><b>Open</b> - Anyone can access your game at all times. If you need privacy, don't create games on this
                public server.
            </li>
            <li><b>Quick</b> - <i>"You can create new games with just a few clicks."</i> Really. You can.</li>
        </ul>
    </div>

    <div id="openEditPlayExplanation">
        <b>Open</b> this website and game editor by clicking "Create Game".<br>
        <b>Edit</b> your game in the editor.<br>
        <b>Play</b> your game instantly with your friends. Just share the link.<br>
    </div>

</div>

<div id="footer">
    <a href="mailto:marko.rintamaki@gmail.com">Marko Rintam√§ki</a><br>
    <br>
    2017
</div>

<script>
	window.IS_SMALL_SCREEN = window.screen.width < 800;
	window.IS_MOBILE_STANDALONE = window.navigator.standalone;

	if (IS_SMALL_SCREEN)
		document.body.classList.add('isSmallDevice');

	profile.setButtonContainer(document.getElementById('profileButtonContainer'));

	window.addEventListener('load', () => {
		let gamesElement = document.getElementById('games');
		getAjax('/api/gameListSample').then(gameListData => {
			let gameList = new GameList();
			gameList.update(gameListData);
			redom.mount(gamesElement, gameList);
		}).catch((e) => {
			redom.mount(gamesElement, redom.text('Could not load'));
		});
		
		profile.promise.then(profile => {
			if (!profile.id || profile.games.length === 0)
				return;
			let myGamesElement = document.getElementById('myGames');
			myGamesElement.style.display = 'block';
			let myGameList = new GameList();
			myGameList.update(profile.games);
			redom.mount(myGamesElement, myGameList);
        });

		let topBarBackground = document.getElementById('topBarBackground');

		if (IS_MOBILE_STANDALONE) {
			// In standalone mode, just show the top bar always. In iOS, scolling events can't be trusted.
			topBarBackground.style.opacity = 1;
		} else {
			// In large devices, do mooth scrolling experience

			window.onscroll = function () {
				"use strict";
				let scroll = document.documentElement.scrollTop || document.body.scrollTop;

				let point1 = 100;
				let point2 = 350;
				let fullOpacity = 1;

				if (scroll < point1) {
					topBarBackground.style.opacity = 0;
				} else if (scroll < point2) {
					topBarBackground.style.opacity = (scroll - point1) / (point2 - point1) * fullOpacity;
				} else {
					topBarBackground.style.opacity = fullOpacity;
				}
			};
			window.onscroll();
		}
	});
</script>

</body>
</html>
